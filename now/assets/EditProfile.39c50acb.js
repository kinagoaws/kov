import{_ as P,ar as U,u as w,X as r,ag as y,p as A,q as n,Z as x,j as a,v as s,$ as p,F,a4 as h,a0 as k,a1 as q,a2 as T,ae as m,a8 as $,t as f,aj as Q,al as d,a6 as v,as as z,at as C,a7 as _,au as E}from"./index.5da0f878.js";import{Q as S}from"./QToolbarTitle.56a1528c.js";import{Q as B}from"./QToolbar.b7ddade1.js";import{Q as D}from"./QHeader.6b7f1431.js";import{Q as c}from"./QImg.bfa83115.js";import{Q as I}from"./QItemLabel.6219c46e.js";import{Q as L}from"./QSelect.094db69a.js";import{Q as j}from"./QFooter.28056917.js";import{Q as N}from"./QForm.8e908865.js";import{Q as H}from"./QPage.ab42a258.js";import{A as g}from"./AppCamera.af5c46dd.js";import"./QResizeObserver.21f20b80.js";import"./QMenu.1610252a.js";import"./position-engine.78f240dd.js";import"./selection.a405500a.js";import"./rtl.276c3f1b.js";import"./format.de7e9769.js";const O={name:"EditProfile",components:{UploaderFile:U(()=>E(()=>import("./UploaderFile.e4c96ce9.js"),["assets/UploaderFile.e4c96ce9.js","assets/index.5da0f878.js","assets/index.96a3fb36.css","assets/QCircularProgress.c739f372.js","assets/format.de7e9769.js"]))},data(){return{data:[],first_name:"",last_name:"",email_address:"",phone_prefix:"",phone:"",avatar:" ",options:[],loading:!1,phone_settings:[],photo_data:[],upload_enabled:!1,featured_filename:"",featured_url:"",upload_path:"",has_photo:!1}},setup(){return{Activity:w()}},created(){this.getProfile()},computed:{hasData(){return!r.empty(this.featured_url)},hasPhoto(){return Object.keys(this.photo_data).length>0}},methods:{getProfile(){try{this.data=y.getUser(),this.first_name=this.data.first_name,this.last_name=this.data.last_name,this.email_address=this.data.email_address,this.phone_prefix=this.data.phone_prefix,this.phone=this.data.phone,this.featured_url=this.data.avatar,console.log(this.Activity.phone_settings),this.options=this.Activity.phone_settings.prefixes}catch(e){r.notify("dark",e,"error_outline",this.$q)}},takePhoto(){this.$q.capacitor?g.isCameraEnabled().then(e=>{g.isFileAccessEnabled().then(o=>{g.getPhoto(1).then(u=>{this.photo_data=u}).catch(u=>{this.photo_data=[]})}).catch(o=>{this.$q.platform.is.ios&&(this.upload_enabled=!this.upload_enabled)})}).catch(e=>{this.$q.platform.is.ios&&(this.upload_enabled=!this.upload_enabled)}):this.upload_enabled=!this.upload_enabled},afterUploadfile(e){this.featured_filename=e.filename,this.featured_url=e.url_image,this.upload_path=e.upload_path},hadData(){return Object.keys(this.photo_data).length>0},onSubmit(){r.showLoadingBox("",this.$q),this.loading=!0,r.fetchDataByToken("updateprofile",{first_name:this.first_name,last_name:this.last_name,email_address:this.email_address,phone_prefix:this.phone_prefix,phone:this.phone,featured_filename:this.featured_filename,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""}).then(e=>{y.setUser(e.details.user_data),r.notify("green-5",e.msg,"check_circle",this.$q)}).catch(e=>{r.notify("dark",e,"error_outline",this.$q)}).then(e=>{this.loading=!1,r.hideLoadingBox(this.$q)})}}},M={class:"q-pa-md q-gutter-sm"},R={class:"row items-center justify-center q-mb-md"},X={class:"col-3 relative-position text-center"};function Z(e,o,u,G,l,i){const V=A("UploaderFile");return n(),x(F,null,[a(D,{class:p({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:s(()=>[a(B,null,{default:s(()=>[a(h,{onClick:o[0]||(o[0]=t=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),a(S,{class:"text-weight-bold"},{default:s(()=>[k(q(e.$t("Edit profile")),1)]),_:1})]),_:1}),a(T)]),_:1},8,["class"]),a(H,{class:p({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:s(()=>[a(N,{onSubmit:i.onSubmit},{default:s(()=>[m("div",M,[m("div",R,[m("div",X,[a($,{size:"70px"},{default:s(()=>[i.hasPhoto?(n(),f(c,{key:0,src:l.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover"},null,8,["src"])):i.hasData?(n(),f(c,{key:1,src:l.featured_url,"spinner-color":"primary","spinner-size":"sm",fit:"cover"},null,8,["src"])):Q("",!0)]),_:1}),a(h,{round:"",color:"primary","text-color":"white",icon:"las la-camera",unelevated:"",size:"sm",class:"absolute-bottom-right",onClick:i.takePhoto},null,8,["onClick"])])]),l.upload_enabled?(n(),f(V,{key:0,ref:"uploader_file",path:"upload/avatar",onAfterUploadfile:i.afterUploadfile},null,8,["onAfterUploadfile"])):Q("",!0),a(d,{outlined:"",modelValue:l.first_name,"onUpdate:modelValue":o[1]||(o[1]=t=>l.first_name=t),label:e.$t("First name"),"stack-label":"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(d,{outlined:"",modelValue:l.last_name,"onUpdate:modelValue":o[2]||(o[2]=t=>l.last_name=t),label:e.$t("Last name"),"stack-label":"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(d,{outlined:"",modelValue:l.email_address,"onUpdate:modelValue":o[3]||(o[3]=t=>l.email_address=t),label:e.$t("Email address"),"stack-label":"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(d,{modelValue:l.phone,"onUpdate:modelValue":o[5]||(o[5]=t=>l.phone=t),mask:"##############",outlined:"",color:"grey-5","lazy-rules":"",rules:[t=>t&&t.length>0||this.$t("This field is required")],borderless:"",class:"input-borderless"},{prepend:s(()=>[a(L,{modelValue:l.phone_prefix,"onUpdate:modelValue":o[4]||(o[4]=t=>l.phone_prefix=t),options:l.options,onFilter:e.filterFn,behavior:"dialog","input-debounce":"700",style:{border:"none"},"emit-value":"",borderless:"",class:"myq-field"},{option:s(({itemProps:t,opt:b})=>[a(v,z(C(t)),{default:s(()=>[a(_,{avatar:""},{default:s(()=>[a(c,{src:b.flag,style:{height:"15px","max-width":"20px"}},null,8,["src"])]),_:2},1024),a(_,null,{default:s(()=>[a(I,{innerHTML:b.label},null,8,["innerHTML"])]),_:2},1024)]),_:2},1040)]),"no-option":s(()=>[a(v,null,{default:s(()=>[a(_,{class:"text-grey"},{default:s(()=>[k(q(e.$t("No results")),1)]),_:1})]),_:1})]),_:1},8,["modelValue","options","onFilter"])]),_:1},8,["modelValue","rules"])]),a(j,{class:p(["q-pa-md",{"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},{default:s(()=>[a(h,{type:"submit",color:"primary","text-color":"white",label:e.$t("Update"),unelevated:"",class:"full-width",size:"lg","no-caps":"",loading:l.loading},null,8,["label","loading"])]),_:1},8,["class"])]),_:1},8,["onSubmit"])]),_:1},8,["class"])],64)}var me=P(O,[["render",Z]]);export{me as default};
