import{_ as z,ad as O,O as U,bp as j,U as E,X as p,l as C,m as t,Y as n,f as r,p as s,af as g,F as c,Q,n as f,S as u,R as l,ac as m,Z as w,P as i,ah as D,as as V,a0 as _,$ as q,bd as A,ai as R}from"./index.c5b868f5.js";import{Q as M}from"./QToolbarTitle.4da9f270.js";import{Q as N}from"./QToolbar.9b15bf0e.js";import{Q as H}from"./QHeader.b374650f.js";import{Q as x}from"./QSkeleton.11b8074a.js";import{Q as F}from"./QImg.79fcc1c6.js";import{a as k,Q as P}from"./QStepper.2be652f3.js";import{Q as Y}from"./QSpace.24950ca6.js";import{Q as h}from"./QItemLabel.4665782c.js";import{Q as T}from"./QList.9b7158f1.js";import{Q as X}from"./QRating.300c19c5.js";import{Q as Z}from"./QPage.528ab8a8.js";import{Q as G}from"./QPullToRefresh.85618661.js";import"./QResizeObserver.3ed5059f.js";import"./QSlideTransition.1f937a0a.js";import"./use-render-cache.3aae9b27.js";import"./touch.9135741d.js";import"./selection.65959ca5.js";import"./format.8ac60962.js";import"./TouchPan.5486290b.js";const J={name:"OrderDetails",components:{CancelOrder:O(()=>R(()=>import("./CancelOrder.b8d3af5a.js"),["assets/CancelOrder.b8d3af5a.js","assets/QSkeleton.11b8074a.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QSpace.24950ca6.js","assets/ClosePopup.32eeb9ff.js"])),AddReview:O(()=>R(()=>import("./AddReview.d4c232b2.js"),["assets/AddReview.d4c232b2.js","assets/AddReview.5955c334.css","assets/QSpace.24950ca6.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QRating.300c19c5.js","assets/format.8ac60962.js","assets/QUploaderAddTrigger.57c0cfeb.js","assets/QUploader.c56a2d76.js","assets/QCircularProgress.1d7da185.js","assets/QFooter.51024c6d.js","assets/QResizeObserver.3ed5059f.js","assets/QForm.997d74f6.js","assets/ClosePopup.32eeb9ff.js"]))},setup(){const o=U(),d=j(),S=E();return{DataStorePersisted:o,UserStore:d,SettingStore:S}},data(){return{step:1,order_uuid:"",loading:!0,order_info:[],merchant:[],items_data:[],payment_list:[],summary:[],isDone:void 0,services:[],order_status:[],progress:[],refund_transaction:[],is_reviewed:!1,data_review:[],allowed_cancelled:!1,allowed_review:!1,rate_value:[]}},mounted(){this.order_uuid=this.$route.query.order_uuid,this.orderDetails(null)},computed:{hasData(){return Object.keys(this.order_info).length>0},hasRefund(){return Object.keys(this.refund_transaction).length>0}},methods:{refresh(o){this.orderDetails(o)},orderDetails(o){this.loading=!o,p.fetchDataByTokenPost("orderDetails","order_uuid="+this.order_uuid+"&track_progress=1&get_review=1").then(d=>{this.merchant=d.details.data.merchant,this.items_data=d.details.data.items,this.summary=d.details.data.summary,this.refund_transaction=d.details.data.refund_transaction,this.order_info=d.details.data.order.order_info,this.payment_list=d.details.data.order.payment_list,this.services=d.details.data.order.services,this.order_status=d.details.data.order.status,this.progress=d.details.progress,this.is_reviewed=d.details.is_reviewed,this.data_review=d.details.data_review,this.allowed_cancelled=d.details.allowed_cancelled,this.allowed_review=d.details.allowed_review}).catch(d=>{}).then(d=>{this.loading=!1,p.empty(o)||o()})},orderAgain(){p.showLoadingBox("",this.$q),p.fetchDataByTokenPost("orderBuyAgain",{cart_uuid:p.getStorage("cart_uuid"),order_uuid:this.order_info.order_uuid}).then(o=>{p.setStorage("cart_uuid",o.details.cart_uuid),this.$router.push("/cart")}).catch(o=>{p.notify("dark",o,"error_outline",this.$q)}).then(o=>{p.hideLoadingBox(this.$q)})},cancelOrder(o){console.log("cancelOrder",o),this.$refs.cancel_order.showModal(o)},afterCancelorder(){this.orderDetails(null)},setRateValue(o,d){this.$refs.review.order_uuid=d,this.$refs.review.rating_value=o,this.$refs.review.modal=!0},afterAddreview(){this.orderDetails(null)}}},K={key:0,class:"q-gutter-y-sm"},W={class:"row items-center q-mb-md"},$={class:"col-2 q-mr-sm"},ee={class:"col"},re={class:"text-weight-medium"},oe={class:"text-grey text-caption line-normal ellipsis-2-lines"},se={key:0,class:"col-3"},te={class:"flex items-center"},le={class:"q-mr-sm text-body2 text-weight-light"},de={class:"radius20 bg-yellow-2 flex flex-center",style:{width:"20px",height:"20px"}},ie={class:"flex justify-between items-center q-pl-md"},ae={class:"text-caption text-weight-bold"},ne={class:"flex items-center"},ce={class:"q-mr-sm text-body2 text-weight-light"},ue={class:"radius20 bg-yellow-2 flex flex-center",style:{width:"20px",height:"20px"}},_e=["innerHTML"],me={key:1,class:"q-pa-sm flex flex-center text-caption text-grey"},pe={class:"text-weight-bold"},ge={key:3,class:"q-mb-sm text-right"},fe={class:"flex items-center"},he={class:"q-mr-sm text-body2 text-weight-light"},ye={class:"radius20 bg-yellow-2 flex flex-center",style:{width:"20px",height:"20px"}},ve={class:"q-pl-md q-pr-md"},we={class:"text-weight-bold"},ke={key:0,class:"q-pl-md q-pr-md"},be={class:"text-weight-bold"},qe={class:"q-pl-md q-pr-md"},xe={class:"text-weight-bold"};function Qe(o,d,S,De,e,y){const B=C("CancelOrder"),L=C("AddReview");return t(),n(c,null,[r(H,{class:g(["bg-whitex",{"bg-mydark text-white":o.$q.dark.mode,"bg-white text-black":!o.$q.dark.mode}]),reveal:""},{default:s(()=>[r(N,null,{default:s(()=>[r(Q,{onClick:d[0]||(d[0]=a=>o.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:o.$q.dark.mode?"grey":"mygrey","text-color":o.$q.dark.mode?"grey-9":"dark"},null,8,["color","text-color"]),e.loading?m("",!0):(t(),f(M,{key:0,class:"text-weight-bold"},{default:s(()=>[u("#"+l(e.order_info.order_id),1)]),_:1}))]),_:1})]),_:1},8,["class"]),r(G,{onRefresh:y.refresh},{default:s(()=>[r(Z,{class:"q-pl-md q-pr-md q-pt-xs q-pb-md"},{default:s(()=>[e.loading?(t(),n("div",K,[(t(),n(c,null,w(2,a=>(t(),n(c,{key:a},[r(x,{height:"60px",class:g({"bg-grey600":o.$q.dark.mode,"bg-mygrey":!o.$q.dark.mode})},null,8,["class"]),r(x,{height:"150px",class:g({"bg-grey600":o.$q.dark.mode,"bg-mygrey":!o.$q.dark.mode})},null,8,["class"]),r(x,{height:"60px",class:g({"bg-grey600":o.$q.dark.mode,"bg-mygrey":!o.$q.dark.mode})},null,8,["class"]),r(x,{height:"150px",class:g({"bg-grey600":o.$q.dark.mode,"bg-mygrey":!o.$q.dark.mode})},null,8,["class"]),r(x,{height:"60px",class:g({"bg-grey600":o.$q.dark.mode,"bg-mygrey":!o.$q.dark.mode})},null,8,["class"])],64))),64))])):(t(),n(c,{key:1},[y.hasData?(t(),n(c,{key:0},[i("div",W,[i("div",$,[r(F,{src:e.merchant.url_logo,style:{width:"50px",height:"50px"},fit:"cover","spinner-color":"primary","spinner-size":"xs",class:"rounded-borders","placeholder-src":"placeholder.png"},null,8,["src"])]),i("div",ee,[i("div",re,l(e.merchant.restaurant_name),1),i("div",oe,l(e.merchant.address),1)]),e.allowed_review?m("",!0):(t(),n("div",se,[r(Q,{flat:"",unelevated:"","no-caps":"",class:"q-pl-none q-pr-sm",to:{path:"/order/track",query:{order_uuid:e.order_info.order_uuid,redirect:"back"}}},{default:s(()=>[i("div",te,[i("div",le,l(o.$t("Track")),1),i("div",de,[r(D,{name:"arrow_forward",class:"text-yellow-9",size:"16px"})])])]),_:1},8,["to"])]))]),e.loading?m("",!0):(t(),n("div",{key:0,class:g(["q-pa-sm bg-mygreyx radius10",{"bg-grey600 ":o.$q.dark.mode,"bg-mygrey ":!o.$q.dark.mode}])},[e.order_info.order_type=="delivery"?(t(),f(P,{key:0,modelValue:e.progress.order_progress,"onUpdate:modelValue":d[1]||(d[1]=a=>e.progress.order_progress=a),ref:"stepper",contracted:"",animated:"",flat:"",class:"bg-transparent","done-color":"primary","active-color":"primary","inactive-color":o.$q.dark.mode?"grey300":"white"},{default:s(()=>[r(k,{name:1,icon:"check","active-icon":"done_all","done-icon":"done_all","done-color":e.progress.order_progress>1?"primary":"red",done:e.progress.order_progress>1||e.progress.order_progress<=0},null,8,["done-color","done"]),r(k,{name:2,icon:"restaurant","active-icon":"restaurant","done-icon":"restaurant","done-color":e.progress.order_progress>2?"primary":"red",done:e.progress.order_progress>2||e.progress.order_progress<=0},null,8,["done-color","done"]),r(k,{name:3,icon:"directions_run","active-icon":"directions_run","done-icon":"directions_run","done-color":e.progress.order_progress>3?"primary":"red",done:e.progress.order_progress>3||e.progress.order_progress<=0},null,8,["done-color","done"]),r(k,{name:4,icon:"flag","active-icon":"flag","done-icon":"flag","done-color":e.progress.order_progress>4?"primary":"red",done:e.progress.order_progress>4||e.progress.order_progress<=0},null,8,["done-color","done"])]),_:1},8,["modelValue","inactive-color"])):(t(),f(P,{key:1,modelValue:e.progress.order_progress,"onUpdate:modelValue":d[2]||(d[2]=a=>e.progress.order_progress=a),ref:"stepper",contracted:"",animated:"",flat:"",class:"bg-transparent","done-color":"primary","active-color":"primary","inactive-color":"white"},{default:s(()=>[r(k,{name:1,icon:"check","active-icon":"done_all","done-icon":"done_all","done-color":e.progress.order_progress>1?"primary":"red",done:e.progress.order_progress>1||e.progress.order_progress<=0},null,8,["done-color","done"]),r(k,{name:2,icon:"restaurant","active-icon":"restaurant","done-icon":"restaurant","done-color":e.progress.order_progress>2?"primary":"red",done:e.progress.order_progress>2||e.progress.order_progress<=0},null,8,["done-color","done"]),r(k,{name:3,icon:"flag","active-icon":"flag","done-icon":"flag","done-color":e.progress.order_progress>3?"primary":"red",done:e.progress.order_progress>3||e.progress.order_progress<=0},null,8,["done-color","done"])]),_:1},8,["modelValue"]))],2)),r(Y,{class:"q-pa-xs"}),r(T,{bordered:"",dense:"",class:"radius10 q-pt-xs q-pb-xs q-mb-sm"},{default:s(()=>[i("div",ie,[i("div",ae,l(o.$t("Order Summary")),1),i("div",null,[r(Q,{flat:"",unelevated:"","no-caps":"",class:"q-pl-none q-pr-sm",onClick:d[3]||(d[3]=V(a=>y.orderAgain(e.order_info.order_uuid),["stop"]))},{default:s(()=>[i("div",ne,[i("div",ce,l(o.$t("Reorder")),1),i("div",ue,[r(D,{name:"arrow_forward",class:"text-yellow-9",size:"16px"})])])]),_:1})])]),(t(!0),n(c,null,w(e.items_data,a=>(t(),n(c,{key:a},[r(q,{class:"item-normal-height"},{default:s(()=>[r(_,{avatar:"",class:"item-column-less",top:""},{default:s(()=>[r(h,{class:"text-caption text-weight-medium"},{default:s(()=>[u(l(a.qty)+"x",1)]),_:2},1024)]),_:2},1024),r(_,{top:""},{default:s(()=>[r(h,{class:"text-caption text-weight-bold"},{default:s(()=>[i("span",{innerHTML:a.item_name},null,8,_e)]),_:2},1024),a.special_instructions?(t(),f(h,{key:0,caption:""},{default:s(()=>[u(l(a.special_instructions),1)]),_:2},1024)):m("",!0),Object.keys(a.attributes).length>0?(t(),f(h,{key:1,caption:""},{default:s(()=>[(t(!0),n(c,null,w(a.attributes,b=>(t(),n("div",{key:b},[(t(!0),n(c,null,w(b,(v,I)=>(t(),n(c,{key:v},[u(l(v)+" ",1),I<b.length-1?(t(),n(c,{key:0},[u(", ")],64)):m("",!0)],64))),128))]))),128))]),_:2},1024)):m("",!0)]),_:2},1024),r(_,{side:"",top:""},{default:s(()=>[r(h,{class:"text-caption text-weight-medium"},{default:s(()=>[u(l(a.price.pretty_total_after_discount),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),Object.keys(a.addons).length>0?(t(!0),n(c,{key:0},w(a.addons,b=>(t(),n(c,{key:b},[(t(!0),n(c,null,w(b.addon_items,v=>(t(),f(q,{key:v,class:"item-normal-height"},{default:s(()=>[r(_,null,{default:s(()=>[r(h,{caption:""},{default:s(()=>[u(l(v.qty)+"x "+l(v.sub_item_name),1)]),_:2},1024)]),_:2},1024),r(_,{side:""},{default:s(()=>[r(h,{caption:""},{default:s(()=>[u(l(v.pretty_addons_total),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))],64))),128)):m("",!0)],64))),128))]),_:1}),e.is_reviewed?(t(),n("div",me,[u(l(o.$t("You have rated this"))+" ",1),r(D,{name:"star",size:"2em",color:"yellow-9"}),i("span",pe,l(e.data_review.rating),1)])):(t(),n(c,{key:2},[e.allowed_review?(t(),f(q,{key:0},{default:s(()=>[r(_,{avatar:""},{default:s(()=>[r(h,{class:"text-body2"},{default:s(()=>[u(l(o.$t("Tap to rate")),1)]),_:1})]),_:1}),r(_,null,{default:s(()=>[r(X,{"model-value":e.rate_value[e.order_info.order_uuid],size:"2em",max:5,color:"grey-5","color-selected":"yellow-2",class:"q-mb-xs","onUpdate:modelValue":d[4]||(d[4]=a=>y.setRateValue(a,e.order_info.order_uuid))},null,8,["model-value"])]),_:1}),r(_,{side:""})]),_:1})):m("",!0)],64)),e.allowed_cancelled?(t(),n("div",ge,[r(Q,{flat:"",unelevated:"","no-caps":"",class:"q-pl-none q-pr-sm",onClick:d[5]||(d[5]=V(a=>y.cancelOrder(e.order_info.order_uuid),["stop"]))},{default:s(()=>[i("div",fe,[i("div",he,l(o.$t("Cancel this order")),1),i("div",ye,[r(D,{name:"arrow_forward",class:"text-yellow-9",size:"16px"})])])]),_:1})])):m("",!0),i("div",{class:g(["radius10 bg-mygreyx q-pt-xs q-pb-xs q-mb-sm text-caption",{"bg-grey600":o.$q.dark.mode,"bg-mygrey":!o.$q.dark.mode}])},[i("div",ve,[i("div",we,l(o.$t("Orders Details")),1),i("div",null,l(o.$t("Order #"))+l(e.order_info.order_id),1),i("div",null,l(e.order_info.place_on),1)]),r(A,{class:"q-mb-sm"}),e.order_info.order_type=="delivery"?(t(),n("div",ke,[i("div",be,l(o.$t("Delivery Details")),1),i("div",null,l(e.order_info.customer_name)+" "+l(e.order_info.contact_number),1),i("div",null,l(e.order_info.address1)+" "+l(e.order_info.delivery_address),1),i("div",null,[e.order_info.whento_deliver=="now"?(t(),n(c,{key:0},[u(l(o.$t("ASAP")),1)],64)):(t(),n(c,{key:1},[u(l(e.order_info.schedule_at),1)],64))])])):m("",!0),r(A,{class:"q-mb-sm"}),i("div",qe,[i("div",xe,l(o.$t("Payment Details")),1),i("div",null,l(e.order_info.payment_name),1),i("div",null,l(e.order_info.paid_on),1)])],2),r(T,{bordered:"",dense:"",class:"radius10 q-pt-xs q-pb-xs"},{default:s(()=>[(t(!0),n(c,null,w(e.summary,a=>(t(),n(c,{key:a},[a.type!="total"?(t(),f(q,{key:0,class:"item-normal-height"},{default:s(()=>[r(_,{class:"text-caption"},{default:s(()=>[u(l(a.name),1)]),_:2},1024),r(_,{side:"",class:"text-caption"},{default:s(()=>[u(l(a.value),1)]),_:2},1024)]),_:2},1024)):(t(),n(c,{key:1},[r(A,{class:"q-mb-sm"}),r(q,{class:"item-normal-height"},{default:s(()=>[r(_,null,{default:s(()=>[u(l(a.name),1)]),_:2},1024),r(_,{side:"",class:"text-weight-bold"},{default:s(()=>[u(l(a.value),1)]),_:2},1024)]),_:2},1024)],64))],64))),128))]),_:1})],64)):m("",!0)],64)),r(B,{ref:"cancel_order",onAfterCancelorder:y.afterCancelorder},null,8,["onAfterCancelorder"]),r(L,{ref:"review",onAfterAddreview:y.afterAddreview},null,8,["onAfterAddreview"])]),_:1})]),_:1},8,["onRefresh"])],64)}var Xe=z(J,[["render",Qe]]);export{Xe as default};
