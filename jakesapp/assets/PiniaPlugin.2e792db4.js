import{j as h,k as y}from"./index.c5b868f5.js";function v(r){return typeof r=="object"&&r!==null}function d(r,t){return r=v(r)?r:Object.create(null),new Proxy(r,{get(n,i,e){return i==="key"?Reflect.get(n,i,e):Reflect.get(n,i,e)||Reflect.get(t,i,e)}})}function _(r,t){return t.reduce((n,i)=>n==null?void 0:n[i],r)}function $(r,t,n){return t.slice(0,-1).reduce((i,e)=>/^(__proto__)$/.test(e)?{}:i[e]=i[e]||{},r)[t[t.length-1]]=n,r}function m(r,t){return t.reduce((n,i)=>{const e=i.split(".");return $(n,e,_(r,e))},{})}function b(r,t){return n=>{var i;try{const{storage:e=localStorage,beforeRestore:o=void 0,afterRestore:a=void 0,serializer:s={serialize:JSON.stringify,deserialize:JSON.parse},key:u=t.$id,paths:l=null,debug:c=!1}=n;return{storage:e,beforeRestore:o,afterRestore:a,serializer:s,key:((i=r.key)!=null?i:f=>f)(typeof u=="string"?u:u(t.$id)),paths:l,debug:c}}catch(e){return n.debug&&console.error("[pinia-plugin-persistedstate]",e),null}}}function p(r,{storage:t,serializer:n,key:i,debug:e}){try{const o=t==null?void 0:t.getItem(i);o&&r.$patch(n==null?void 0:n.deserialize(o))}catch(o){e&&console.error("[pinia-plugin-persistedstate]",o)}}function g(r,{storage:t,serializer:n,key:i,paths:e,debug:o}){try{const a=Array.isArray(e)?m(r,e):r;t.setItem(i,n.serialize(a))}catch(a){o&&console.error("[pinia-plugin-persistedstate]",a)}}function R(r={}){return t=>{const{auto:n=!1}=r,{options:{persist:i=n},store:e,pinia:o}=t;if(!i)return;if(!(e.$id in o.state.value)){const s=o._s.get(e.$id.replace("__hot:",""));s&&Promise.resolve().then(()=>s.$persist());return}const a=(Array.isArray(i)?i.map(s=>d(s,r)):[d(i,r)]).map(b(r,e)).filter(Boolean);e.$persist=()=>{a.forEach(s=>{g(e.$state,s)})},e.$hydrate=({runHooks:s=!0}={})=>{a.forEach(u=>{const{beforeRestore:l,afterRestore:c}=u;s&&(l==null||l(t)),p(e,u),s&&(c==null||c(t))})},a.forEach(s=>{const{beforeRestore:u,afterRestore:l}=s;u==null||u(t),p(e,s),l==null||l(t),e.$subscribe((c,f)=>{g(f,s)},{detached:!0})})}}var S=R(),z=h(({app:r})=>{const t=y();t.use(S),r.use(t)});export{z as default};
