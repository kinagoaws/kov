import{_ as Q,ad as C,U as P,ae as y,X as f,l as R,m as s,Y as n,f as a,p as d,af as v,F as m,Q as u,S as b,R as l,ag as k,Z as q,ac as g,P as r,n as V,ai as U}from"./index.c5b868f5.js";import{Q as z}from"./QToolbarTitle.4da9f270.js";import{Q as E}from"./QToolbar.9b15bf0e.js";import{Q as F}from"./QHeader.b374650f.js";import{Q as B}from"./QSelect.65ab904e.js";import{Q as _}from"./QSpace.24950ca6.js";import{Q as w}from"./QFooter.51024c6d.js";import{Q as D}from"./QForm.997d74f6.js";import{Q as L}from"./QInnerLoading.ff23f6a9.js";import{Q as N}from"./QPage.528ab8a8.js";import{u as G}from"./BookingStore.4fe3817f.js";import"./QResizeObserver.3ed5059f.js";import"./QItemLabel.4665782c.js";import"./QMenu.b5349f2e.js";import"./selection.65959ca5.js";import"./rtl.276c3f1b.js";import"./format.8ac60962.js";const I={name:"BookingPage",components:{componentsRecaptcha:C(()=>U(()=>import("./componentsRecaptcha.2f09d1e7.js"),["assets/componentsRecaptcha.2f09d1e7.js","assets/index.c5b868f5.js","assets/index.7897e990.css"]))},data(){return{loading:!1,recaptcha_response:"",success_data:[]}},setup(){const e=G(),i=P();return{BookingStore:e,SettingStore:i}},mounted(){if(this.BookingStore.steps=1,this.reservation_uuid=this.$route.query.id,y.authenticated()){let e=y.getUser();this.BookingStore.first_name=e.first_name,this.BookingStore.last_name=e.last_name,this.BookingStore.email_address=e.email_address,this.BookingStore.mobile_number=e.contact_number}Object.keys(this.SettingStore.settings_data).length>0?this.Getbookingattributes():this.$watch(()=>this.SettingStore.$state.settings_data,(e,i)=>{this.Getbookingattributes()})},methods:{Getbookingattributes(){this.BookingStore.Getbookingattributes(this.SettingStore.merchant_uuid,"")},SetBooking(){this.BookingStore.SetBooking(this.SettingStore.merchant_uuid)},recaptchaExpired(){f.empty(this.$refs.recapcha)&&this.$refs.recapcha.reset()},recaptchaFailed(){},recaptchaVerified(e){this.recaptcha_response=e},onSubmit(){this.loading=!0;let e="merchant_uuid="+this.SettingStore.merchant_uuid;e+="&reservation_date="+this.BookingStore.reservation_date,e+="&reservation_time="+this.BookingStore.reservation_time,e+="&guest="+this.BookingStore.guest,e+="&first_name="+this.BookingStore.first_name,e+="&last_name="+this.BookingStore.last_name,e+="&email_address="+this.BookingStore.email_address,e+="&mobile_prefix="+this.SettingStore.settings_data.phone_data.phonecode,e+="&mobile_number="+this.BookingStore.mobile_number,e+="&room_uuid="+this.BookingStore.room_uuid,e+="&table_uuid="+this.BookingStore.table_uuid,e+="&special_request="+this.BookingStore.special_request,e+="&recaptcha_response="+this.recaptcha_response,e+="&id="+this.BookingStore.reservation_uuid,e+="&request_from=single_app",f.fetchDataPostTableToken("ReserveTable",e).then(i=>{this.success_data=i.details,this.BookingStore.steps=3,this.BookingStore.room_uuid="",this.BookingStore.table_uuid=""}).catch(i=>{this.success_data=[],f.notify("dark",i,"error_outline",this.$q),this.recaptchaExpired()}).then(i=>{this.loading=!1})}}},x={key:0,class:"row q-gutter-sm"},M={class:"text-weight-bold font15 q-mt-md"},A=["innerHTML"],H={class:"q-mt-sm text-weight-bold text-body1"},O={class:"text-caption"},j={class:"q-mt-sm text-weight-bold text-body1"},X={class:"q-mt-sm text-weight-medium font15"},Y={class:"text-grey q-mt-md q-mb-md"},Z={class:"row items-center q-gutter-sm"},J={key:2,class:"flex flex-center text-center",style:{height:"calc(85vh)"}},K={class:"text-body2 line-normal q-mb-none"},W={class:"text-grey text-body2"},$={class:"text-success"},ee={class:"q-gutter-y-sm"};function oe(e,i,te,o,c,S){const T=R("componentsRecaptcha");return s(),n(m,null,[a(F,{reveal:"",class:v({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:d(()=>[a(E,null,{default:d(()=>[a(u,{onClick:i[0]||(i[0]=t=>e.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:e.$q.dark.mode?"grey":"mygrey","text-color":e.$q.dark.mode?"grey-9":"dark"},null,8,["color","text-color"]),a(z,{class:"text-weight-bold"},{default:d(()=>[b(l(e.$t("Table reservations")),1)]),_:1})]),_:1})]),_:1},8,["class"]),a(N,{class:"q-pl-md q-pr-md q-pb-md q-pt-sm"},{default:d(()=>[o.BookingStore.hasData?(s(),n(m,{key:0},[o.BookingStore.getSteps==1?(s(),n(m,{key:0},[a(B,{modelValue:o.BookingStore.guest,"onUpdate:modelValue":[i[1]||(i[1]=t=>o.BookingStore.guest=t),i[2]||(i[2]=t=>o.BookingStore.getTimeslot(o.SettingStore.merchant_uuid))],options:o.BookingStore.guest_list,label:e.$t("Guest"),dense:"",color:"primary",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":""},null,8,["modelValue","options","label"]),a(B,{modelValue:o.BookingStore.reservation_date,"onUpdate:modelValue":[i[3]||(i[3]=t=>o.BookingStore.reservation_date=t),i[4]||(i[4]=t=>o.BookingStore.getTimeslot(o.SettingStore.merchant_uuid))],options:o.BookingStore.date_list,label:e.$t("Date"),dense:"",color:"primary",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":""},null,8,["modelValue","options","label"]),a(_,{class:"q-pa-sm"}),a(k,{filled:"",modelValue:o.BookingStore.reservation_time,"onUpdate:modelValue":i[5]||(i[5]=t=>o.BookingStore.reservation_time=t),label:e.$t("Time"),disable:""},null,8,["modelValue","label"]),a(_,{class:"q-pa-sm"}),o.BookingStore.hasTimeSlot?(s(),n("div",x,[(s(!0),n(m,null,q(o.BookingStore.getTimeList,t=>(s(),n(m,{key:t},[(s(!0),n(m,null,q(t,(p,h)=>(s(),n("div",{key:p,class:"col-2 text-center"},[a(u,{unelevated:"",label:p,class:"full-width",outline:!o.BookingStore.isSelected(h),color:o.BookingStore.isSelected(h)?e.$q.dark.mode?"grey300":"primary":o.BookingStore.isNotavailable(h)?"grey":e.$q.dark.mode?"grey300":"black",onClick:ie=>o.BookingStore.reservation_time=h,disabled:o.BookingStore.isNotavailable(h)},null,8,["label","outline","color","onClick","disabled"])]))),128))],64))),128))])):g("",!0),o.SettingStore.settings_data.booking_reservation_terms?(s(),n(m,{key:1},[r("div",M,l(e.$t("Restaurant Terms & Conditions")),1),r("div",{class:"text-grey",innerHTML:o.SettingStore.settings_data.booking_reservation_terms},null,8,A)],64)):g("",!0),a(_,{class:"q-pa-md"}),a(w,{class:v(["q-pl-md q-pr-md q-pt-sm q-pb-sm bg-whitex border-top",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode}])},{default:d(()=>[a(u,{color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",disabled:!o.BookingStore.bookingValid,loading:o.BookingStore.loading,onClick:S.SetBooking},{default:d(()=>[b(l(e.$t("Continue")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1},8,["class"])],64)):g("",!0),o.BookingStore.getSteps==2?(s(),V(D,{key:1,onSubmit:S.onSubmit},{default:d(()=>[r("div",H,l(e.$t("Reservation details")),1),r("div",O,[r("div",null,l(o.BookingStore.reservation_info.full_time),1),r("div",null,l(o.BookingStore.reservation_info.guest),1)]),r("div",j,l(e.$t("Personal details")),1),a(k,{modelValue:o.BookingStore.first_name,"onUpdate:modelValue":i[6]||(i[6]=t=>o.BookingStore.first_name=t),label:e.$t("First name"),"lazy-rules":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(k,{modelValue:o.BookingStore.last_name,"onUpdate:modelValue":i[7]||(i[7]=t=>o.BookingStore.last_name=t),label:e.$t("Last name"),"lazy-rules":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(k,{modelValue:o.BookingStore.email_address,"onUpdate:modelValue":i[8]||(i[8]=t=>o.BookingStore.email_address=t),label:e.$t("Email address"),"lazy-rules":"",rules:[(t,p)=>p.email(t)||e.$t("Please enter a valid email address")]},null,8,["modelValue","label","rules"]),a(k,{modelValue:o.BookingStore.mobile_number,"onUpdate:modelValue":i[9]||(i[9]=t=>o.BookingStore.mobile_number=t),label:e.$t("Mobile number"),mask:"##################",prefix:o.SettingStore.settings_data.phone_data.phonecode,rules:[t=>t&&t.length>0||e.$t("This field is required"),t=>t.length<=15||e.$t("Please use maximum 15 characters")]},null,8,["modelValue","label","prefix","rules"]),o.SettingStore.settings_data.allowed_choose_table?(s(),n(m,{key:0},[a(B,{modelValue:o.BookingStore.room_uuid,"onUpdate:modelValue":[i[10]||(i[10]=t=>o.BookingStore.room_uuid=t),i[11]||(i[11]=t=>o.BookingStore.table_uuid="")],options:o.BookingStore.room_list,label:e.$t("Room name"),"transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","options","label","rules"]),a(B,{modelValue:o.BookingStore.table_uuid,"onUpdate:modelValue":i[12]||(i[12]=t=>o.BookingStore.table_uuid=t),options:o.BookingStore.table_list[o.BookingStore.room_uuid],label:e.$t("Table name"),"transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","options","label","rules"])],64)):g("",!0),r("div",X,l(e.$t("Special requests")),1),a(k,{modelValue:o.BookingStore.special_request,"onUpdate:modelValue":i[13]||(i[13]=t=>o.BookingStore.special_request=t),autogrow:"",color:"warning"},null,8,["modelValue"]),o.SettingStore.settings_data.booking_enabled_capcha?(s(),n(m,{key:1},[a(_,{class:"q-pa-sm"}),a(T,{ref:"recapcha",sitekey:o.SettingStore.settings_data.captcha_site_key,is_enabled:"1",language_code:o.SettingStore.settings_data.captcha_lang,size:"normal",theme:"light",tabindex:0,onVerify:S.recaptchaVerified,onExpire:S.recaptchaExpired,onFail:S.recaptchaFailed},null,8,["sitekey","language_code","onVerify","onExpire","onFail"])],64)):g("",!0),r("p",Y,l(e.$t("By continuing, you agree to Terms of Service and Privacy Policy"))+". ",1),a(w,{class:v(["q-pl-md q-pr-md q-pt-sm q-pb-sm bg-whitex border-top",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode}])},{default:d(()=>[r("div",Z,[a(u,{color:"dark","text-color":"white",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"col",onClick:i[14]||(i[14]=t=>this.BookingStore.steps=1)},{default:d(()=>[b(l(e.$t("Cancel")),1)]),_:1}),a(u,{type:"submit",color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"col",loading:c.loading},{default:d(()=>[b(l(e.$t("Reserve")),1)]),_:1},8,["loading"])])]),_:1},8,["class"])]),_:1},8,["onSubmit"])):g("",!0),o.BookingStore.getSteps==3?(s(),n("div",J,[r("div",null,[i[16]||(i[16]=r("svg",{class:"checkmark",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 52 52"},[r("circle",{class:"checkmark__circle",cx:"26",cy:"26",r:"25",fill:"none"}),r("path",{class:"checkmark__check",fill:"none",d:"M14.1 27.2l7.1 7.2 16.7-16.8"})],-1)),r("h5",K,l(c.success_data.full_time),1),r("div",W,[r("div",null,l(c.success_data.guest),1),r("div",null,[b(l(e.$t("Reservation ID"))+"# ",1),r("span",$,l(c.success_data.reservation_id),1)])]),a(_,{class:"q-pa-md"}),r("div",ee,[a(u,{type:"submit",color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",label:e.$t("Track your reservation"),to:{path:"/reservation/track",query:{id:c.success_data.reservation_uuid}},replace:"true"},null,8,["label","to"]),a(u,{type:"submit",color:e.$q.dark.mode?"grey600":"dark",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",label:e.$t("Reserved table again"),onClick:i[15]||(i[15]=t=>o.BookingStore.resetReservation(o.SettingStore.merchant_uuid))},null,8,["color","label"])])])])):g("",!0)],64)):g("",!0),o.BookingStore.isLoading?(s(),V(L,{key:1,showing:!0,color:e.$q.dark.mode?"grey300":"primary"},null,8,["color"])):g("",!0)]),_:1})],64)}var fe=Q(I,[["render",oe]]);export{fe as default};
