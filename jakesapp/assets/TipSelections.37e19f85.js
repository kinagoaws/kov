import{_,O as k,X as i,m as o,n as p,p as s,f as t,$ as c,a0 as r,a1 as b,S as q,R as m,P as d,af as f,Y as h,F as v,Q as g,ag as T,ac as A}from"./index.c5b868f5.js";import{Q as y}from"./QItemLabel.4665782c.js";import{Q}from"./QSkeleton.11b8074a.js";import{Q as S}from"./QBtnToggle.f3167bc9.js";import{Q as V}from"./QList.9b7158f1.js";const $={name:"TipSelections",props:["settings","transaction_type"],data(){return{tips:0,amount:0,data:[],loading:!1,refresh:!1,loading_apply:!1}},setup(){return{DataStorePersisted:k()}},computed:{isEnabled(){return(this.settings?this.settings.enabled_tip==1:!1)&&this.settings.tips_in_transactions.includes(this.transaction_type)===!0}},mounted(){(this.settings?this.settings.enabled_tip==1:!1)&&this.loadTips()},methods:{loadTips(){this.loading=!0,i.fetchDataPost("loadTips","cart_uuid="+i.getStorage("cart_uuid")+"&currency_code="+this.DataStorePersisted.getUseCurrency()).then(e=>{this.data=e.details.data,this.tips=e.details.tips}).catch(e=>{this.data=[]}).then(e=>{this.loading=!1})},updateTips(e){e!="fixed"&&this.checkoutAddTips(e)},checkoutAddTips(e){this.refresh=!0,this.$emit("onApplytips"),i.fetchDataByToken("checkoutAddTips",{cart_uuid:i.getStorage("cart_uuid"),value:e,is_manual:!1}).then(a=>{this.$emit("afterApplytips")}).catch(a=>{i.notify("dark",a,"error_outline",this.$q)}).then(a=>{this.refresh=!1})},ApplyAmount(){this.loading_apply=!0,i.fetchDataByToken("checkoutAddTips",{cart_uuid:i.getStorage("cart_uuid"),value:this.amount,is_manual:!0}).then(e=>{this.$emit("afterApplytips")}).catch(e=>{i.notify("dark",e,"error_outline",this.$q)}).then(e=>{this.loading_apply=!1})}}},B={class:"text-caption line-normal q-mb-sm"},D={key:0,class:"q-pa-md"},w={class:"absolute-top-right"};function C(e,a,P,I,l,u){return u.isEnabled?(o(),p(V,{key:0,bordered:"",dense:"",class:"rounded-borders q-pt-xs q-pb-xs q-mb-sm shadow-1"},{default:s(()=>[t(c,null,{default:s(()=>[t(r,{avatar:"",class:"item-column-less"},{default:s(()=>[t(b,{color:"primary","text-color":"white",icon:"las la-coins",size:"md"})]),_:1}),t(r,null,{default:s(()=>[t(y,null,{default:s(()=>[q(m(e.$t("Tip your rider")),1)]),_:1})]),_:1})]),_:1}),t(c,{class:"item-normal-height"},{default:s(()=>[t(r,null,{default:s(()=>[t(y,null,{default:s(()=>[d("div",B,m(e.$t("Your rider receives the entire amount of your tip.")),1),d("div",null,[l.loading?(o(),p(Q,{key:0,recttype:"type",animation:"pulse",class:f({"bg-grey600":e.$q.dark.mode,"bg-mygrey":!e.$q.dark.mode})},null,8,["class"])):(o(),h(v,{key:1},[l.tips=="fixed"?(o(),h("div",D,[d("div",{class:f(["radius10",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}])},[t(c,{class:"q-pt-lg relative-position"},{default:s(()=>[d("div",w,[t(g,{flat:"",icon:"close",size:"sm",color:"negative",rounded:"",onClick:a[0]||(a[0]=n=>l.tips=0)})]),t(r,null,{default:s(()=>[t(T,{modelValue:l.amount,"onUpdate:modelValue":a[1]||(a[1]=n=>l.amount=n),label:e.$t("Enter amount"),"stack-label":""},null,8,["modelValue","label"])]),_:1}),t(r,{side:""},{default:s(()=>[t(g,{type:"submit",unelevated:"",rounded:"",color:"primary","text-color":"white","no-caps":"",class:"full-width",label:e.$t("Apply"),size:"14px",loading:l.loading_apply,onClick:u.ApplyAmount},null,8,["label","loading","onClick"])]),_:1})]),_:1})],2)])):(o(),p(S,{key:1,modelValue:l.tips,"onUpdate:modelValue":[a[2]||(a[2]=n=>l.tips=n),u.updateTips],"toggle-color":"yellow-9",color:e.$q.dark.mode?"grey600":"white","text-color":e.$q.dark.mode?"grey300":"dark","no-caps":"",rounded:"",unelevated:"",class:"rounded-group2 small q-pa-none",options:l.data,dense:e.$q.screen.lt.sm,disable:l.refresh},null,8,["modelValue","color","text-color","options","onUpdate:modelValue","dense","disable"]))],64))])]),_:1})]),_:1})]),_:1})]),_:1})):A("",!0)}var F=_($,[["render",C]]);export{F as default};
