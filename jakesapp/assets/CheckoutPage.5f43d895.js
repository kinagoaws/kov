import{_ as N,ad as i,O as z,U as M,X as k,l as n,m as o,Y as l,f as e,p as r,af as y,n as D,ac as A,F as p,Q as v,S as u,R as c,Z as C,P,$ as b,a0 as g,a1 as W,ah as j,bd as H,b8 as X,ai as d}from"./index.c5b868f5.js";import{Q as Y}from"./QToolbarTitle.4da9f270.js";import{Q as Z}from"./QToolbar.9b15bf0e.js";import{Q as G}from"./QHeader.b374650f.js";import{Q as w}from"./QSkeleton.11b8074a.js";import{Q as S}from"./QItemLabel.4665782c.js";import{Q as J}from"./QPage.528ab8a8.js";import{Q as K}from"./QFooter.51024c6d.js";import{C as tt}from"./ClosePopup.32eeb9ff.js";import{u as et}from"./CartData.5b90ca7b.js";import"./QResizeObserver.3ed5059f.js";const at={name:"CheckoutPage",components:{CartAddress:i(()=>d(()=>import("./CartAddress.04baf552.js"),["assets/CartAddress.04baf552.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QItemLabel.4665782c.js","assets/QSkeleton.11b8074a.js","assets/QList.9b7158f1.js"])),AddressQuickList:i(()=>d(()=>import("./AddressQuickList.5f1f03da.js"),["assets/AddressQuickList.5f1f03da.js","assets/QSpace.24950ca6.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QSkeleton.11b8074a.js","assets/QList.9b7158f1.js","assets/QItemLabel.4665782c.js","assets/ClosePopup.32eeb9ff.js"])),OrderDetailsinfo:i(()=>d(()=>import("./OrderDetailsinfo.918e570a.js"),["assets/OrderDetailsinfo.918e570a.js","assets/QSpace.24950ca6.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QBtnToggle.f3167bc9.js","assets/QInnerLoading.ff23f6a9.js","assets/QSelect.65ab904e.js","assets/QItemLabel.4665782c.js","assets/QMenu.b5349f2e.js","assets/selection.65959ca5.js","assets/rtl.276c3f1b.js","assets/format.8ac60962.js","assets/ClosePopup.32eeb9ff.js"])),PromoDiscount:i(()=>d(()=>import("./PromoDiscount.f009e887.js"),["assets/PromoDiscount.f009e887.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QItemLabel.4665782c.js","assets/QSkeleton.11b8074a.js","assets/QSpace.24950ca6.js","assets/QList.9b7158f1.js","assets/QForm.997d74f6.js","assets/ClosePopup.32eeb9ff.js","assets/CartData.5b90ca7b.js"])),CartItemSummary:i(()=>d(()=>import("./CartItemSummary.0e565e5f.js"),["assets/CartItemSummary.0e565e5f.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QItemLabel.4665782c.js","assets/QList.9b7158f1.js"])),PaymentMethod:i(()=>d(()=>import("./PaymentMethod.5680e9ff.js"),["assets/PaymentMethod.5680e9ff.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QItemLabel.4665782c.js","assets/QSkeleton.11b8074a.js","assets/QList.9b7158f1.js","assets/CartData.5b90ca7b.js"])),TipSelections:i(()=>d(()=>import("./TipSelections.37e19f85.js"),["assets/TipSelections.37e19f85.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QItemLabel.4665782c.js","assets/QSkeleton.11b8074a.js","assets/QBtnToggle.f3167bc9.js","assets/QList.9b7158f1.js"])),PointsDiscount:i(()=>d(()=>import("./PointsDiscount.399c2e02.js"),["assets/PointsDiscount.399c2e02.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QItemLabel.4665782c.js","assets/QSkeleton.11b8074a.js","assets/QList.9b7158f1.js","assets/QSpace.24950ca6.js","assets/QLinearProgress.05dc3008.js","assets/QTab.efd359a5.js","assets/QTabs.54389c7c.js","assets/QResizeObserver.3ed5059f.js","assets/rtl.276c3f1b.js","assets/QForm.997d74f6.js","assets/ClosePopup.32eeb9ff.js"])),AddressDetails:i(()=>d(()=>import("./AddressDetails.3eff9d33.js"),["assets/AddressDetails.3eff9d33.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QToolbarTitle.4da9f270.js","assets/QToolbar.9b15bf0e.js","assets/QSelect.65ab904e.js","assets/QItemLabel.4665782c.js","assets/QMenu.b5349f2e.js","assets/selection.65959ca5.js","assets/rtl.276c3f1b.js","assets/format.8ac60962.js","assets/QSpace.24950ca6.js","assets/QBtnToggle.f3167bc9.js","assets/QFooter.51024c6d.js","assets/QResizeObserver.3ed5059f.js","assets/QForm.997d74f6.js","assets/ClosePopup.32eeb9ff.js"])),LoaderDialog:i(()=>d(()=>import("./LoaderDialog.6a26f95e.js"),["assets/LoaderDialog.6a26f95e.js","assets/QInnerLoading.ff23f6a9.js","assets/index.c5b868f5.js","assets/index.7897e990.css"])),EmptyCart:i(()=>d(()=>import("./EmptyCart.f6c15225.js"),["assets/EmptyCart.f6c15225.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QSpace.24950ca6.js"])),PaymentComponents:i(()=>d(()=>import("./PaymentComponents.fed87934.js"),["assets/PaymentComponents.fed87934.js","assets/index.c5b868f5.js","assets/index.7897e990.css"])),WalletComponents:i(()=>d(()=>import("./WalletComponents.85c13e6b.js"),["assets/WalletComponents.85c13e6b.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QSkeleton.11b8074a.js","assets/QItemLabel.4665782c.js","assets/QList.9b7158f1.js","assets/QInnerLoading.ff23f6a9.js","assets/CartData.5b90ca7b.js"])),BookingCheckout:i(()=>d(()=>import("./BookingCheckout.10d5e8ab.js"),["assets/BookingCheckout.10d5e8ab.js","assets/QSelect.65ab904e.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QItemLabel.4665782c.js","assets/QMenu.b5349f2e.js","assets/selection.65959ca5.js","assets/rtl.276c3f1b.js","assets/format.8ac60962.js"]))},data(){return{loading:!0,refresh:!1,payload:["items","merchant_info","service_fee","delivery_fee","packaging","tax","tips","checkout","discount","distance_local","summary","total","items_count","points","points_discount"],params:{},payment_uuid:"",payment_code:"",payment_credentials:[],wallet_data:[],loading_place:!1}},setup(){const t=et(),_=z(),m=M();return{CartData:t,DataStorePersisted:_,SettingStore:m}},mounted(){this.params={cart_uuid:k.getStorage("cart_uuid"),local_id:this.DataStorePersisted.location_data.id,payload:this.payload,currency_code:this.DataStorePersisted.getUseCurrency()},this.Cart(),Object.keys(this.SettingStore.settings_data).length>0?Object.keys(this.SettingStore.format_transaction_data).length<=0&&this.SettingStore.formatTransaction():this.$watch(()=>this.SettingStore.$state.settings_data,(t,_)=>{this.SettingStore.formatTransaction()}),this.storeOpen()},methods:{storeOpen(){this.CartData.checkStoreOpen({whento_deliver:this.DataStorePersisted.whento_deliver,delivery_date:this.DataStorePersisted.delivery_date,delivery_time:this.DataStorePersisted.delivery_time_data})},async Cart(){this.loading=!0,this.params.local_id=this.DataStorePersisted.location_data.id,await this.CartData.getCartCheckout(this.params),this.loading=!1},async afterUpdatecart(){this.refresh=!0,this.$refs.loader_dialog.modal=!0,this.params.local_id=this.DataStorePersisted.location_data.id,await this.CartData.getCartCheckout(this.params),this.refresh=!1,this.$refs.loader_dialog.modal=!1},changeAddress(){this.$refs.address_list.modal=!0},afterSelectaddress(t){console.log("afterSelectaddress"),this.DataStorePersisted.location_data=t,this.SettingStore.formatTransaction(),this.afterUpdatecart()},showOrderdetails(){this.$refs.order_details_info.modal=!0},afterSavetrans(){console.log("afterSavetrans"),this.afterUpdatecart(),this.storeOpen()},addInstructions(t){this.$refs.address_details.location_data=t,this.$refs.address_details.modal=!0},afterSaveaddress(t){console.log("afterSaveaddress",t),this.DataStorePersisted.location_data=t,this.afterUpdatecart()},afterApplytips(){console.log("afterApplytips"),this.afterUpdatecart()},showPaymentmethod(){this.$refs.payment_list.modal=!0},setPaymentmethod(t){this.payment_uuid=t.data.payment_uuid,this.payment_code=t.data.payment_code,this.payment_credentials=t.payment_credentials},PlaceOrder(){const t={whento_deliver:this.DataStorePersisted.whento_deliver,delivery_date:this.DataStorePersisted.delivery_date,delivery_time:this.DataStorePersisted.delivery_time_data},_={cart_uuid:k.getStorage("cart_uuid"),local_id:this.DataStorePersisted.location_data.id,include_utensils:this.DataStorePersisted.include_utensil,payment_uuid:this.payment_uuid,payment_change:parseFloat(this.$refs.payment_method.payment_change),use_digital_wallet:this.$refs.digital_wallet?this.$refs.digital_wallet.use_wallet:"",guest_number:this.$refs.booking?this.$refs.booking.guest_number:0,room_uuid:this.$refs.booking?this.$refs.booking.room_uuid:"",table_uuid:this.$refs.booking?this.$refs.booking.table_uuid:"",currency_code:this.DataStorePersisted.getUseCurrency(),attributes_data:t,transaction_type:this.DataStorePersisted.transaction_type};this.loading_place=!0,this.$refs.loader_dialog.modal=!0,k.fetchDataByTokenPost("PlaceOrder",_).then(m=>{m.details.payment_instructions.method==="offline"?(this.resetCart(),this.$router.replace({path:"/checkout/successful",query:{order_uuid:m.details.order_uuid}})):this.doPayment(m.details)}).catch(m=>{k.notify("dark",m,"error_outline",this.$q)}).then(m=>{this.loading_place=!1,this.$refs.loader_dialog.modal=!1})},doPayment(t){this.$refs.payment_components.doPayment(t)},afterSuccessfulpayment(t){this.resetCart(),this.$router.replace({path:"/checkout/successful",query:{order_uuid:t.order_uuid}})},resetCart(){this.DataStorePersisted.delivery_date="",this.DataStorePersisted.delivery_time_data=""},setError(t){this.CartData.error.push(t)},afterApplywallet(t){this.wallet_data=t}}},rt={key:0,class:"q-pa-md"},st={key:0,class:"q-pl-md q-pr-md q-pb-md"},ot={key:2,class:"bg-red-2 q-pa-sm radius8 text-dark q-mt-sm q-mb-sm radius10x rounded-borders line-one"},it={class:"text-caption q-mt-sm"},nt={class:"text-yellow-9 text-weight-medium"};function dt(t,_,m,a,h,s){const E=n("BookingCheckout"),O=n("CartAddress"),T=n("PromoDiscount"),q=n("WalletComponents"),I=n("PaymentMethod"),Q=n("PointsDiscount"),L=n("TipSelections"),V=n("CartItemSummary"),R=n("EmptyCart"),U=n("AddressQuickList"),B=n("OrderDetailsinfo"),x=n("AddressDetails"),$=n("PaymentComponents"),F=n("LoaderDialog");return o(),l(p,null,[e(G,{class:y(["bg-whitex",{"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode}]),reveal:""},{default:r(()=>[e(Z,null,{default:r(()=>[e(v,{onClick:_[0]||(_[0]=f=>t.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:t.$q.dark.mode?"grey":"mygrey","text-color":t.$q.dark.mode?"grey-9":"dark"},null,8,["color","text-color"]),e(Y,{class:"text-weight-bold text-darkx"},{default:r(()=>[u(c(t.$t("Order Confirmation")),1)]),_:1})]),_:1})]),_:1},8,["class"]),e(J,null,{default:r(()=>[h.loading?(o(),l("div",rt,[(o(),l(p,null,C(3,f=>e(w,{key:f,height:"50px",square:"",class:y(["radius10 q-mb-sm",{"bg-grey600":t.$q.dark.mode,"bg-mygrey":!t.$q.dark.mode}])},null,8,["class"])),64)),(o(),l(p,null,C(3,f=>e(w,{key:f,height:"180px",square:"",class:y(["radius10 q-mb-sm",{"bg-grey600":t.$q.dark.mode,"bg-mygrey":!t.$q.dark.mode}])},null,8,["class"])),64))])):(o(),l(p,{key:1},[a.CartData.hasCart?(o(),l("div",st,[P("div",{class:y(["radius10 q-mb-sm",{"bg-grey600 ":t.$q.dark.mode,"bg-mygrey ":!t.$q.dark.mode}])},[e(b,{clickable:"",onClick:s.showOrderdetails},{default:r(()=>[e(g,{avatar:"",class:"item-column-less"},{default:r(()=>[e(W,{color:"primary","text-color":"white",icon:"schedule",size:"md"})]),_:1}),e(g,null,{default:r(()=>[e(S,{caption:""},{default:r(()=>[u(c(t.$t("Order & Time")),1)]),_:1}),e(S,null,{default:r(()=>[u(c(a.SettingStore.getTransactionData.transaction),1)]),_:1}),e(S,{class:"text-caption"},{default:r(()=>[a.SettingStore.getTransactionData.time?(o(),l(p,{key:0},[u(c(a.SettingStore.getTransactionData.time),1)],64)):(o(),l(p,{key:1},[u(c(a.SettingStore.getTransactionData.date),1)],64))]),_:1})]),_:1}),e(g,{side:""},{default:r(()=>[e(j,{name:"chevron_right",color:"grey"})]),_:1})]),_:1},8,["onClick"])],2),a.SettingStore.settings_data.booking_enabled&&a.SettingStore.getTransactionData.transaction_type=="dinein"?(o(),D(E,{key:0,ref:"booking"},null,512)):A("",!0),a.SettingStore.getTransactionData.transaction_type=="delivery"?(o(),D(O,{key:1,onChangeAddress:s.changeAddress,onAddInstructions:s.addInstructions,onSetError:s.setError},null,8,["onChangeAddress","onAddInstructions","onSetError"])):A("",!0),a.CartData.isCartError?(o(),l("div",ot,[(o(!0),l(p,null,C(a.CartData.getCartErrors,f=>(o(),l(p,{key:f},[u(c(f),1),_[1]||(_[1]=P("br",null,null,-1))],64))),128))])):A("",!0),e(T,{ref:"promo",onAfterApplypromo:s.afterUpdatecart,onAfterRemovepromo:s.afterUpdatecart},null,8,["onAfterApplypromo","onAfterRemovepromo"]),e(q,{ref:"digital_wallet",onAfterApplywallet:s.afterApplywallet,cart_updated:h.refresh},null,8,["onAfterApplywallet","cart_updated"]),e(I,{ref:"payment_method",cart_total:a.CartData.cart_total,onShowPaymentmethod:s.showPaymentmethod,onSetPaymentmethod:s.setPaymentmethod,redirect:"/checkout",wallet_data:h.wallet_data},null,8,["cart_total","onShowPaymentmethod","onSetPaymentmethod","wallet_data"]),e(Q,{settings:a.SettingStore.settings_data,onAfterApplypoints:s.afterUpdatecart},null,8,["settings","onAfterApplypoints"]),e(L,{settings:a.SettingStore.settings_data,transaction_type:a.DataStorePersisted.transaction_type,onOnApplytips:t.onApplytips,onAfterApplytips:s.afterApplytips},null,8,["settings","transaction_type","onOnApplytips","onAfterApplytips"]),e(V,{cart_loading:a.CartData.cart_loading,cart_uuid:a.CartData.cart_uuid,cart_items:a.CartData.cart_items,cart_summary:a.CartData.cart_summary},null,8,["cart_loading","cart_uuid","cart_items","cart_summary"]),P("div",it,[u(c(t.$t("By completing this order, i agree to all"))+" ",1),P("span",nt,c(t.$t("terms & condition")),1)])])):(o(),D(R,{key:1}))],64))]),_:1}),!h.loading&&a.CartData.hasCart?(o(),D(K,{key:0,class:y({"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode})},{default:r(()=>[e(H),e(b,null,{default:r(()=>[e(g,null,{default:r(()=>[e(S,{class:"text-weight-medium"},{default:r(()=>[u(c(t.$t("Total Price")),1)]),_:1}),e(S,{class:y(["text-weight-bold",{"text-grey300 ":t.$q.dark.mode,"text-negative":!t.$q.dark.mode}])},{default:r(()=>[u(c(a.CartData.getCartTotal),1)]),_:1},8,["class"])]),_:1}),e(g,null,{default:r(()=>[X(e(v,{unelevated:"",rounded:"",color:"primary","text-color":"white","no-caps":"",class:"full-width",label:t.$t("Place Order"),size:"17px",disable:a.CartData.isCartError||h.refresh,onClick:s.PlaceOrder,loading:h.loading_place},null,8,["label","disable","onClick","loading"]),[[tt]])]),_:1})]),_:1})]),_:1},8,["class"])):A("",!0),e(U,{ref:"address_list",redirect:"/checkout",onAfterSelectaddress:s.afterSelectaddress},null,8,["onAfterSelectaddress"]),e(B,{ref:"order_details_info",onAfterSavetrans:s.afterSavetrans},null,8,["onAfterSavetrans"]),e(x,{ref:"address_details",onAfterSaveaddress:s.afterSaveaddress},null,8,["onAfterSaveaddress"]),e($,{ref:"payment_components",payment_credentials:h.payment_credentials,onAfterAddpayment:t.afterAddpayment,onAfterSuccessfulpayment:s.afterSuccessfulpayment},null,8,["payment_credentials","onAfterAddpayment","onAfterSuccessfulpayment"]),e(F,{ref:"loader_dialog"},null,512)],64)}var kt=N(at,[["render",dt]]);export{kt as default};
