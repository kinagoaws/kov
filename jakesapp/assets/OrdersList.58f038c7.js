import{_ as O,ad as P,U as L,O as V,X as f,l as S,m as o,Y as n,f as t,p as r,F as u,af as h,Q as b,S as m,R as i,P as a,Z as q,n as _,ac as y,ai as A,$ as Q,as as $,a0 as g,ah as x}from"./index.c5b868f5.js";import{Q as R}from"./QToolbarTitle.4da9f270.js";import{Q as B}from"./QToolbar.9b15bf0e.js";import{Q as I}from"./QHeader.b374650f.js";import{Q as z}from"./QTab.efd359a5.js";import{Q as E}from"./QTabs.54389c7c.js";import{Q as N}from"./QBadge.f1da1480.js";import{Q as v}from"./QItemLabel.4665782c.js";import{Q as U}from"./QRating.300c19c5.js";import{Q as H}from"./QList.9b7158f1.js";import{Q as j}from"./QInnerLoading.ff23f6a9.js";import{Q as F}from"./QCircularProgress.1d7da185.js";import{Q as M}from"./QInfiniteScroll.e5ee4582.js";import{Q as X}from"./QPageScroller.9f5fda23.js";import{Q as Y}from"./QPage.528ab8a8.js";import{Q as Z}from"./QPullToRefresh.85618661.js";import"./QResizeObserver.3ed5059f.js";import"./rtl.276c3f1b.js";import"./format.8ac60962.js";import"./use-page-sticky.ec3ca395.js";import"./TouchPan.5486290b.js";import"./touch.9135741d.js";import"./selection.65959ca5.js";const G={name:"OrdersList",components:{CancelOrder:P(()=>A(()=>import("./CancelOrder.b8d3af5a.js"),["assets/CancelOrder.b8d3af5a.js","assets/QSkeleton.11b8074a.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QSpace.24950ca6.js","assets/ClosePopup.32eeb9ff.js"])),AddReview:P(()=>A(()=>import("./AddReview.d4c232b2.js"),["assets/AddReview.d4c232b2.js","assets/AddReview.5955c334.css","assets/QSpace.24950ca6.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QRating.300c19c5.js","assets/format.8ac60962.js","assets/QUploaderAddTrigger.57c0cfeb.js","assets/QUploader.c56a2d76.js","assets/QCircularProgress.1d7da185.js","assets/QFooter.51024c6d.js","assets/QResizeObserver.3ed5059f.js","assets/QForm.997d74f6.js","assets/ClosePopup.32eeb9ff.js"]))},setup(){const e=L(),l=V();return{SettingStore:e,DataStorePersisted:l}},data(){return{data:[],loading:!1,tabList:[{value:"active",label:this.$t("Active")},{value:"history",label:this.$t("History")},{value:"cancel",label:this.$t("Cancel")}],page:0,is_refresh:void 0,balance:0,loading_balance:!0,status_allowed_cancelled:[],status_allowed_review:[],rate_value:[]}},mounted(){},computed:{hasData(){return this.data.length>0},getData(){return this.data},getColors(){return this.DataStorePersisted.tab=="active"?"cyan-1":this.DataStorePersisted.tab=="history"?"green-1":this.DataStorePersisted.tab=="cancel"?"red-1":!1},getTextColors(){return this.DataStorePersisted.tab=="active"?"cyan-9":this.DataStorePersisted.tab=="history"?"green-9":this.DataStorePersisted.tab=="cancel"?"red-9":!1}},methods:{async refresh(e){this.resetPagination(),e()},getTransactions(e,l){this.loading=!0,this.page=e,f.fetchDataByTokenPost("orderHistory2","page="+e+"&group="+this.DataStorePersisted.tab).then(p=>{p.code==1?(this.data.push(p.details.data),p.details.end_results&&this.$refs.nscroll&&this.$refs.nscroll.stop()):this.$refs.nscroll&&this.$refs.nscroll.stop()}).catch(p=>{this.$refs.nscroll&&this.$refs.nscroll.stop()}).then(p=>{this.loading=!1,l(),f.empty(this.is_refresh)||this.is_refresh()})},tabChange(){this.resetPagination()},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()},setRateValue(e,l){console.log("data",e),console.log("order_uuid",l),this.$refs.review.order_uuid=l,this.$refs.review.rating_value=e,this.$refs.review.modal=!0},afterAddreview(){console.log("afterAddreview"),this.resetPagination()},viewOrder(e){console.log("viewOrder",e),this.$router.push({path:"/order/view",query:{order_uuid:e.order_uuid}})},cancelOrder(e){console.log("cancelOrder",e),this.$refs.cancel_order.showModal(e)},orderAgain(e){f.showLoadingBox("",this.$q),f.fetchDataByTokenPost("orderBuyAgain",{cart_uuid:f.getStorage("cart_uuid"),order_uuid:e}).then(l=>{f.setStorage("cart_uuid",l.details.cart_uuid),this.$router.push("/cart")}).catch(l=>{f.notify("dark",l,"error_outline",this.$q)}).then(l=>{f.hideLoadingBox(this.$q)})},afterCancelorder(){this.resetPagination()}}},J={class:"q-pl-md q-pr-md q-pt-sm"},K={class:"q-pl-md q-pr-md q-pb-xl"},W={class:"flex items-center"},ee={class:"q-mr-sm text-body2 text-weight-light"},te={class:"radius20 bg-yellow-2 flex flex-center",style:{width:"20px",height:"20px"}},re={class:"flex items-center"},ae={class:"q-mr-sm text-body2 text-weight-light"},se={class:"radius20 bg-yellow-2 flex flex-center",style:{width:"20px",height:"20px"}},oe={class:"flex items-center"},le={class:"q-mr-sm text-body2 text-weight-light"},de={class:"radius20 bg-yellow-2 flex flex-center",style:{width:"20px",height:"20px"}},ie={class:"flex items-center"},ne={class:"text-caption"},ce={key:0,class:"card-small-medium flex flex-center text-body2 text-grey"},ue={key:1,class:"row justify-center absolute-bottom"},fe={class:"q-pa-md flex flex-center"},he={class:"flex items-center q-gutter-x-sm"},me={class:"text-body2 text-grey"};function _e(e,l,p,C,w,d){const D=S("CancelOrder"),T=S("AddReview");return o(),n(u,null,[t(Z,{onRefresh:d.refresh},{default:r(()=>[t(I,{reveal:"",class:h({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:r(()=>[t(B,null,{default:r(()=>[t(b,{onClick:l[0]||(l[0]=c=>e.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:e.$q.dark.mode?"grey":"mygrey","text-color":e.$q.dark.mode?"grey-9":"dark"},null,8,["color","text-color"]),t(R,{class:"text-weight-bold"},{default:r(()=>[m(i(e.$t("Orders")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(Y,null,{default:r(()=>[a("div",J,[a("div",{class:h(["border-dark-greyx q-pa-xs radius20 q-mb-md",{"border-none bg-grey600":e.$q.dark.mode,"border-dark-grey":!e.$q.dark.mode}])},[t(E,{modelValue:C.DataStorePersisted.tab,"onUpdate:modelValue":[l[1]||(l[1]=c=>C.DataStorePersisted.tab=c),d.tabChange],dense:"",class:"text-grey","indicator-color":"transparent","active-color":"primary",align:"justify","narrow-indicator":"","no-caps":""},{default:r(()=>[(o(!0),n(u,null,q(w.tabList,c=>(o(),_(z,{key:c,name:c.value,label:c.label,"no-caps":"","content-class":"text-weight-500 "},null,8,["name","label"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])],2)]),a("div",K,[t(M,{ref:"nscroll",onLoad:d.getTransactions,offset:250},{default:r(()=>[d.hasData?(o(),_(H,{key:0,separator:""},{default:r(()=>[(o(!0),n(u,null,q(d.getData,c=>(o(),n(u,{key:c},[(o(!0),n(u,null,q(c,s=>(o(),n(u,{key:s.transaction_date},[t(Q,{clickable:"",onClick:$(k=>d.viewOrder(s),["stop"])},{default:r(()=>[t(g,null,{default:r(()=>[t(v,{class:h({"text-grey300 ":e.$q.dark.mode})},{default:r(()=>[m(i(s.order_id)+" ",1),t(N,{rounded:"",color:d.getColors,"text-color":d.getTextColors},{default:r(()=>[m(i(s.status),1)]),_:2},1032,["color","text-color"])]),_:2},1032,["class"]),t(v,{caption:"",class:h({"text-grey300 ":e.$q.dark.mode})},{default:r(()=>[m(i(s.date_created),1)]),_:2},1032,["class"]),t(v,{class:h({"text-yellow-9":!e.$q.dark.mode,"text-grey300":e.$q.dark.mode})},{default:r(()=>[m(i(s.transaction_type),1)]),_:2},1032,["class"])]),_:2},1024),t(g,{side:"",top:""},{default:r(()=>[t(v,{class:h(["text-weight-bold",{"text-grey300 ":e.$q.dark.mode}])},{default:r(()=>[m(i(s.total),1)]),_:2},1032,["class"])]),_:2},1024)]),_:2},1032,["onClick"]),t(Q,{class:h(["item-normal-height q-mb-xs",{"list-line-separator ":!e.$q.dark.mode}])},{default:r(()=>[t(g,null,{default:r(()=>[t(v,null,{default:r(()=>[s.allowed_cancelled?(o(),_(b,{key:0,onClick:$(k=>d.cancelOrder(s.order_uuid),["stop"]),flat:"",unelevated:"","no-caps":"",class:"q-pl-none q-pr-sm"},{default:r(()=>[a("div",W,[a("div",ee,i(e.$t("Cancel")),1),a("div",te,[t(x,{name:"arrow_forward",class:"text-yellow-9",size:"16px"})])])]),_:2},1032,["onClick"])):y("",!0),t(b,{onClick:$(k=>d.orderAgain(s.order_uuid),["stop"]),flat:"",unelevated:"","no-caps":"",class:"q-pl-none q-pr-sm"},{default:r(()=>[a("div",re,[a("div",ae,i(e.$t("Reorder")),1),a("div",se,[t(x,{name:"arrow_forward",class:"text-yellow-9",size:"16px"})])])]),_:2},1032,["onClick"]),s.allowed_track?(o(),_(b,{key:1,flat:"",unelevated:"","no-caps":"",class:"q-pl-none q-pr-sm",to:{path:"/order/track",query:{order_uuid:s.order_uuid,redirect:"back"}}},{default:r(()=>[a("div",oe,[a("div",le,i(e.$t("Track")),1),a("div",de,[t(x,{name:"arrow_forward",class:"text-yellow-9",size:"16px"})])])]),_:2},1032,["to"])):y("",!0)]),_:2},1024)]),_:2},1024),s.is_reviews?(o(),_(g,{key:0,side:""},{default:r(()=>[a("div",ie,[a("div",null,[t(x,{name:"star",size:"1.5em",color:"yellow-9"})]),a("div",ne,i(s.ratings),1)])]),_:2},1024)):y("",!0)]),_:2},1032,["class"]),s.is_reviews?(o(),n(u,{key:0},[],64)):(o(),n(u,{key:1},[s.allowed_review?(o(),_(Q,{key:0},{default:r(()=>[t(g,{avatar:""},{default:r(()=>[t(v,{class:"text-body2"},{default:r(()=>[m(i(e.$t("Tap to rate")),1)]),_:1})]),_:1}),t(g,null,{default:r(()=>[t(U,{"model-value":w.rate_value[s.order_uuid],size:"2em",max:5,color:"grey-5","color-selected":"yellow-2",class:"q-mb-xs","onUpdate:modelValue":k=>d.setRateValue(k,s.order_uuid)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024),t(g,{side:""})]),_:2},1024)):y("",!0)],64))],64))),128))],64))),128))]),_:1})):(o(),n(u,{key:1},[w.loading?y("",!0):(o(),n("div",ce,[a("div",null,i(e.$t("No available data")),1)]))],64))]),loading:r(()=>[w.page<=1?(o(),_(j,{key:0,showing:!0,color:"primary",size:"md"})):w.page>1?(o(),n("div",ue,[a("div",fe,[a("div",he,[a("div",null,[t(F,{indeterminate:"",rounded:"",size:"30px",color:"primary"})]),a("div",me,i(e.$t("loading")),1)])])])):y("",!0)]),_:1},8,["onLoad"])]),t(X,{position:"bottom-right","scroll-offset":150,offset:[18,18]},{default:r(()=>[t(b,{fab:"",icon:"keyboard_arrow_up",color:e.$q.dark.mode?"grey":"grey-2","text-color":e.$q.dark.mode?"grey-9":"grey",padding:"xs"},null,8,["color","text-color"])]),_:1})]),_:1})]),_:1},8,["onRefresh"]),t(D,{ref:"cancel_order",onAfterCancelorder:d.afterCancelorder},null,8,["onAfterCancelorder"]),t(T,{ref:"review",onAfterAddreview:d.afterAddreview},null,8,["onAfterAddreview"])],64)}var ze=O(G,[["render",_e]]);export{ze as default};
