import{_ as $,ad as S,O as T,U as I,bp as B,X as u,l as P,m as n,n as i,p as a,f as e,Q as E,S as d,R as m,af as h,Y as c,F as f,Z as g,$ as k,a0 as l,bd as R,ai as D,ah as b,ac as z}from"./index.c5b868f5.js";import{Q as N}from"./QToolbarTitle.4da9f270.js";import{Q as O}from"./QToolbar.9b15bf0e.js";import{Q as V}from"./QHeader.b374650f.js";import{Q as x}from"./QSkeleton.11b8074a.js";import{Q as M}from"./QSpace.24950ca6.js";import{Q as y}from"./QItemLabel.4665782c.js";import{Q as v}from"./QImg.79fcc1c6.js";import{Q as U}from"./QBadge.f1da1480.js";import{Q as w}from"./QList.9b7158f1.js";import{Q as j}from"./QPage.528ab8a8.js";import{Q as F}from"./QPullToRefresh.85618661.js";import"./QResizeObserver.3ed5059f.js";import"./TouchPan.5486290b.js";import"./touch.9135741d.js";import"./selection.65959ca5.js";import"./format.8ac60962.js";const Y={name:"PaymentMethods",components:{LoaderDialog:S(()=>D(()=>import("./LoaderDialog.6a26f95e.js"),["assets/LoaderDialog.6a26f95e.js","assets/QInnerLoading.ff23f6a9.js","assets/index.c5b868f5.js","assets/index.7897e990.css"])),PaymentComponents:S(()=>D(()=>import("./PaymentComponents.fed87934.js"),["assets/PaymentComponents.fed87934.js","assets/index.c5b868f5.js","assets/index.7897e990.css"])),PaymentDetails:S(()=>D(()=>import("./PaymentDetails.837785df.js"),["assets/PaymentDetails.837785df.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QInnerLoading.ff23f6a9.js","assets/QSpace.24950ca6.js","assets/QItemLabel.4665782c.js","assets/ClosePopup.32eeb9ff.js"]))},data(){return{modal:!1,loading:!1,data:[],payment_list:[],payment_credentials:[],default_payment_uuid:"",redirect:"",payment_details:[]}},setup(){const t=T(),o=I(),Q=B();return{DataStorePersisted:t,SettingStore:o,UserStore:Q}},mounted(){this.redirect=this.$route.query.redirect,this.paymentListnew()},computed:{hasData(){return Object.keys(this.data).length>0},hasPaymentList(){return Object.keys(this.payment_list).length>0}},methods:{async paymentListnew(){this.loading=!0,u.fetchDataByTokenPost("MyPaymentsNew","currency_code="+this.DataStorePersisted.getUseCurrency()).then(t=>{this.data=t.details.data,this.default_payment_uuid=t.details.default_payment_uuid,this.payment_list=t.details.payment_list,this.payment_credentials=t.details.credentials}).catch(t=>{this.data=[]}).then(t=>{this.loading=!1})},async refresh(t){this.$refs.loader_dialog.modal=!0,u.fetchDataByTokenPost("MyPaymentsNew","currency_code="+this.DataStorePersisted.getUseCurrency()).then(o=>{this.data=o.details.data,this.default_payment_uuid=o.details.default_payment_uuid,this.payment_list=o.details.payment_list,this.payment_credentials=o.details.credentials}).catch(o=>{this.data=[]}).then(o=>{this.$refs.loader_dialog.modal=!1,u.empty(t)||t()})},setDefaultPayment(t){this.$refs.loader_dialog.modal=!0,u.fetchDataByTokenPost("setDefaultPayment","payment_uuid="+t.payment_uuid).then(o=>{u.empty(this.redirect)?this.refresh(null):this.$router.replace(this.redirect)}).catch(o=>{u.notify("dark",o,"error_outline",this.$q)}).then(o=>{this.$refs.loader_dialog.modal=!1})},onSelectPayment(t){console.log(this.$refs.payment_components),this.$refs.payment_components.onSelectPayment(t.payment_code)},afterAddpayment(){u.empty(this.redirect)?this.refresh(null):this.$router.replace(this.redirect)},showDetails(t){console.log("showDetails",t),this.payment_details=t,this.$refs.payment_details.modal=!0},afterDelete(){console.log("afterDelete"),this.refresh(null)}}};function H(t,o,Q,s,_,p){const q=P("LoaderDialog"),C=P("PaymentComponents"),L=P("PaymentDetails");return n(),i(F,{onRefresh:p.refresh},{default:a(()=>[e(V,{class:h(["bg-whitex",{"bg-mydark text-white":t.$q.dark.mode,"bg-white text-dark":!t.$q.dark.mode}]),reveal:""},{default:a(()=>[e(O,null,{default:a(()=>[e(E,{onClick:o[0]||(o[0]=r=>t.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:t.$q.dark.mode?"grey":"mygrey","text-color":t.$q.dark.mode?"grey-9":"dark"},null,8,["color","text-color"]),e(N,{class:"text-weight-bold text-darkx"},{default:a(()=>[d(m(t.$t("Pament Methods")),1)]),_:1})]),_:1})]),_:1},8,["class"]),e(j,{class:"q-pa-md"},{default:a(()=>[_.loading?(n(),c(f,{key:0},[(n(),c(f,null,g(5,r=>e(x,{key:r,height:"40px",class:h(["q-mb-sm",{"bg-grey600":t.$q.dark.mode,"bg-mygrey":!t.$q.dark.mode}])},null,8,["class"])),64)),e(M,{class:"q-pa-md"}),(n(),c(f,null,g(5,r=>e(x,{key:r,height:"40px",class:h(["q-mb-sm",{"bg-grey600":t.$q.dark.mode,"bg-mygrey":!t.$q.dark.mode}])},null,8,["class"])),64))],64)):(n(),c(f,{key:1},[e(w,{separator:""},{default:a(()=>[e(y,{header:"",class:"text-weight-bold text-caption item-normal-height",style:{padding:"5px 16px"}},{default:a(()=>[d(m(t.$t("Currently Linked")),1)]),_:1}),p.hasData?(n(!0),c(f,{key:1},g(_.data,r=>(n(),i(k,{key:r,clickable:"",tag:"label",onClick:A=>p.showDetails(r)},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[r.logo_type=="icon"?(n(),c("div",{key:0,class:h(["rounded-borders",s.SettingStore.payment_icons[r.payment_code]?s.SettingStore.payment_icons[r.payment_code].bg:"bg-blue"]),style:{padding:"1px 2px"}},[e(b,{name:s.SettingStore.payment_icons[r.payment_code]?s.SettingStore.payment_icons[r.payment_code].icon:"credit_card",size:"sm",color:"white"},null,8,["name"])],2)):(n(),i(v,{key:1,src:r.logo_image,fit:"contain",style:{"max-height":"40px","max-width":"40px"},"spinner-size":"sm","spinner-color":"primary"},null,8,["src"]))]),_:2},1024),e(l,null,{default:a(()=>[e(y,null,{default:a(()=>[d(m(r.attr1),1)]),_:2},1024),e(y,{caption:""},{default:a(()=>[d(m(r.attr2),1)]),_:2},1024)]),_:2},1024),_.default_payment_uuid==r.payment_uuid?(n(),i(l,{key:0},{default:a(()=>[e(y,null,{default:a(()=>[e(U,{color:"grey-2","text-color":"dark",label:t.$t("Default")},null,8,["label"])]),_:1})]),_:1})):z("",!0),e(l,{side:""},{default:a(()=>[e(b,{name:"chevron_right",size:"sm",color:"grey"})]),_:1})]),_:2},1032,["onClick"]))),128)):(n(),i(k,{key:0},{default:a(()=>[e(l,null,{default:a(()=>[e(y,{caption:""},{default:a(()=>[d(m(t.$t("You don't have link payment")),1)]),_:1})]),_:1})]),_:1}))]),_:1}),e(R,{class:"q-mt-md q-mb-md"}),e(w,{separator:""},{default:a(()=>[e(y,{header:"",class:"text-weight-bold text-caption item-normal-height",style:{padding:"5px 16px"}},{default:a(()=>[d(m(t.$t("Add Methods")),1)]),_:1}),p.hasPaymentList?(n(!0),c(f,{key:1},g(_.payment_list,r=>(n(),i(k,{key:r,clickable:"",onClick:A=>p.onSelectPayment(r)},{default:a(()=>[e(l,{avatar:""},{default:a(()=>[r.logo_type=="icon"?(n(),c("div",{key:0,class:h(["rounded-borders",s.SettingStore.payment_icons[r.payment_code]?s.SettingStore.payment_icons[r.payment_code].bg:"bg-blue"]),style:{padding:"1px 2px"}},[e(b,{name:s.SettingStore.payment_icons[r.payment_code]?s.SettingStore.payment_icons[r.payment_code].icon:"credit_card",size:"sm",color:"white"},null,8,["name"])],2)):(n(),i(v,{key:1,src:r.logo_image,fit:"contain",style:{"max-height":"40px","max-width":"40px"},"spinner-size":"sm","spinner-color":"primary"},null,8,["src"]))]),_:2},1024),e(l,null,{default:a(()=>[e(y,null,{default:a(()=>[d(m(r.payment_name),1)]),_:2},1024)]),_:2},1024),e(l,{side:""},{default:a(()=>[e(b,{name:"chevron_right",color:"grey"})]),_:1})]),_:2},1032,["onClick"]))),128)):(n(),i(k,{key:0},{default:a(()=>[e(l,null,{default:a(()=>[e(y,{caption:""},{default:a(()=>[d(m(t.$t("No payment available")),1)]),_:1})]),_:1})]),_:1}))]),_:1})],64)),e(q,{ref:"loader_dialog"},null,512),e(C,{ref:"payment_components",payment_credentials:_.payment_credentials,onAfterAddpayment:p.afterAddpayment},null,8,["payment_credentials","onAfterAddpayment"]),e(L,{ref:"payment_details",data:_.payment_details,onAfterDelete:p.afterDelete},null,8,["data","onAfterDelete"])]),_:1})]),_:1},8,["onRefresh"])}var ce=$(Y,[["render",H]]);export{ce as default};
