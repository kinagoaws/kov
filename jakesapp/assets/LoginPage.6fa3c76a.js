import{_ as q,ad as y,U as x,O as P,ae as h,X as m,l as S,m as g,Y as _,f as t,p as r,af as E,F as b,Q as i,S as c,R as l,ag as k,ah as D,P as p,ac as w,ai as v}from"./index.c5b868f5.js";import{Q as L}from"./QToolbarTitle.4da9f270.js";import{Q as C}from"./QToolbar.9b15bf0e.js";import{Q as F}from"./QHeader.b374650f.js";import{Q as u}from"./QSpace.24950ca6.js";import{Q as T}from"./QForm.997d74f6.js";import{Q as I}from"./QPage.528ab8a8.js";import"./QResizeObserver.3ed5059f.js";const R={name:"LoginPage",components:{SocialLogin:y(()=>v(()=>import("./SocialLogin.648d605d.js"),["assets/SocialLogin.648d605d.js","assets/index.c5b868f5.js","assets/index.7897e990.css"])),componentsRecaptcha:y(()=>v(()=>import("./componentsRecaptcha.2f09d1e7.js"),["assets/componentsRecaptcha.2f09d1e7.js","assets/index.c5b868f5.js","assets/index.7897e990.css"]))},data(){return{loading:!1,email_address:"",password:"",field_type:"password",password_icon:"las la-low-vision",recaptcha_response:"",redirect:"",page_ready:!1}},setup(e){const a=x(),f=P();return{SettingStore:a,DataStorePersisted:f}},mounted(){this.redirect=this.$route.query.redirect,h.authenticated()&&this.$router.push("/home"),Object.keys(this.SettingStore.settings_data).length>0?this.page_ready=!0:this.$watch(()=>this.SettingStore.$state.settings_data,(e,a)=>{this.page_ready=!0})},methods:{refresh(){},recaptchaVerified(e){this.recaptcha_response=e},recaptchaExpired(){this.SettingStore.settings_data.captcha_enabled&&this.$refs.recapcha.reset()},recaptchaFailed(){},onSubmit(){this.loading=!0,m.fetchDataPost("userLogin",{username:this.email_address,password:this.password,recaptcha_response:this.recaptcha_response}).then(e=>{h.setUser(e.details.user_data),h.setToken(e.details.user_token),this.DataStorePersisted.user_settings=e.details.user_settings,m.empty(this.redirect)?this.$router.push("/home"):this.$router.push(this.redirect)}).catch(e=>{this.recaptchaExpired(),m.notify("dark",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})}}},z={key:0,class:"full-width q-pa-md"},A={class:"scroll"},B={class:"text-center"},N={class:"flex flex-center"};function O(e,a,f,n,o,d){const Q=S("componentsRecaptcha"),V=S("SocialLogin");return g(),_(b,null,[t(F,{class:E(["bg-whitex",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode}]),reveal:""},{default:r(()=>[t(C,null,{default:r(()=>[t(i,{onClick:a[0]||(a[0]=s=>e.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:e.$q.dark.mode?"grey":"mygrey","text-color":e.$q.dark.mode?"grey-9":"dark"},null,8,["color","text-color"]),t(L,{class:"text-weight-bold text-darkx"},{default:r(()=>[c(l(e.$t("Let's Sign You In")),1)]),_:1})]),_:1})]),_:1},8,["class"]),t(I,{padding:"",class:"text-dark flex flex-center"},{default:r(()=>[o.page_ready?(g(),_("div",z,[t(T,{onSubmit:d.onSubmit},{default:r(()=>[t(k,{modelValue:o.email_address,"onUpdate:modelValue":a[1]||(a[1]=s=>o.email_address=s),label:e.$t("Email address"),"stack-label":"",rules:[(s,$)=>$.email(s)||this.$t("Please enter a valid email address")]},null,8,["modelValue","label","rules"]),t(k,{modelValue:o.password,"onUpdate:modelValue":a[3]||(a[3]=s=>o.password=s),type:o.field_type,label:e.$t("Password"),"stack-label":"",color:"grey-5",rules:[s=>s&&s.length>0||this.$t("This field is required")]},{append:r(()=>[t(D,{onClick:a[2]||(a[2]=s=>this.field_type=this.field_type=="password"?"text":"password"),name:this.field_type=="password"?"las la-low-vision":"las la-eye",color:"grey",class:"cursor-pointer"},null,8,["name"])]),_:1},8,["modelValue","type","label","rules"]),p("div",A,[t(Q,{ref:"recapcha",sitekey:n.SettingStore.settings_data.captcha_site_key,is_enabled:n.SettingStore.settings_data.captcha_enabled,language_code:n.SettingStore.settings_data.captcha_lang,size:"normal",theme:"light",tabindex:0,onVerify:d.recaptchaVerified,onExpire:d.recaptchaExpired,onFail:d.recaptchaFailed},null,8,["sitekey","is_enabled","language_code","onVerify","onExpire","onFail"])]),p("div",B,[t(i,{flat:"","no-caps":"",color:"primary",to:"/user/forgotpassword"},{default:r(()=>[c(l(e.$t("Forgot Password"))+"?",1)]),_:1})]),t(u,{class:"q-pa-sm"}),t(i,{type:"submit",color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",loading:o.loading},{default:r(()=>[c(l(e.$t("Login")),1)]),_:1},8,["loading"]),t(u,{class:"q-pa-sm"}),p("div",N,[p("div",null,l(e.$t("Don't have an account"))+"?",1),t(i,{flat:"","no-caps":"",color:"primary",to:"/user/signup"},{default:r(()=>[c(l(e.$t("Sign up")),1)]),_:1})]),n.SettingStore.settings_data.enabled_guest?(g(),_(b,{key:0},[t(u,{class:"q-pa-xs"}),t(i,{color:e.$q.dark.mode?"grey":"grey-2","text-color":e.$q.dark.mode?"grey-9":"grey-6",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",label:e.$t("Continue as guest"),to:{path:"/user/guest",query:{redirect:this.redirect}}},null,8,["color","text-color","label","to"])],64)):w("",!0),t(u,{class:"q-pa-xs"}),t(V)]),_:1},8,["onSubmit"])])):w("",!0)]),_:1})],64)}var M=q(R,[["render",O]]);export{M as default};
