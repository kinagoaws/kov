import{ao as k,ai as c,_ as $,d as P,O as b,U as C,ad as u,X as s,ae as _,ap as y,l as d,m as l,n as m,p as r,f as a,P as Q,ah as V,aq as q,Q as h,Y as I,F as w,af as B,ac as A,q as M}from"./index.c5b868f5.js";import{Q as T}from"./QSpace.24950ca6.js";import{Q as E}from"./QToolbar.9b15bf0e.js";import{Q as R}from"./QHeader.b374650f.js";import{Q as F}from"./QFooter.51024c6d.js";import{Q as L,a as O}from"./QLayout.49caf9a6.js";import{u as N}from"./CartData.5b90ca7b.js";import"./QResizeObserver.3ed5059f.js";import"./QScrollObserver.1bd16026.js";const p=k("Device",{web:()=>c(()=>import("./web.e2b7b700.js"),["assets/web.e2b7b700.js","assets/index.c5b868f5.js","assets/index.7897e990.css"]).then(e=>new e.DeviceWeb)}),z=P({name:"MainLayout",data(){return{direction:"",path:"",loading:!1}},setup(){const e=N(),t=b(),o=C();return{CartData:e,DataStorePersisted:t,SettingStore:o}},components:{FooterMenu:u(()=>c(()=>import("./FooterMenu.2bc8dabf.js"),["assets/FooterMenu.2bc8dabf.js","assets/index.c5b868f5.js","assets/index.7897e990.css","assets/QTabs.54389c7c.js","assets/QResizeObserver.3ed5059f.js","assets/rtl.276c3f1b.js","assets/QBadge.f1da1480.js","assets/CartData.5b90ca7b.js"])),NotiButton:u(()=>c(()=>import("./NotiButton.e2196a0f.js"),["assets/NotiButton.e2196a0f.js","assets/QBadge.f1da1480.js","assets/index.c5b868f5.js","assets/index.7897e990.css"])),ComponentsRealtime:u(()=>c(()=>import("./ComponentsRealtime.a3fe8e7f.js"),["assets/ComponentsRealtime.a3fe8e7f.js","assets/index.c5b868f5.js","assets/index.7897e990.css"]))},computed:{getDarkMode(){return this.DataStorePersisted.dark_mode?"las la-adjust":"las la-moon"}},mounted(){this.path=this.$route.path,this.$q.capacitor&&(this.DeviceInit(),Object.keys(this.SettingStore.settings_data).length>0?this.checkAppVersion():this.$watch(()=>this.SettingStore.$state.settings_data,(e,t)=>{this.checkAppVersion()}))},updated(){this.path=this.$route.path},methods:{scrollHandler(e){this.direction=e},DeviceInit(){const e=s.getSession("single_device_token"),t=s.getSession("device_registered"),o=s.getSession("device_registered_auth");_.authenticated()?o!==1&&p.getId().then(i=>{p.getInfo().then(n=>{this.updateDevice(e,i.identifier,n.platform)})}):t!==1&&p.getId().then(i=>{p.getInfo().then(n=>{this.registerDevice(e,i.identifier,n.platform)})}),this.subsribeDevice()},registerDevice(e,t,o){s.fetchDataByBearer("registerDevice",{token:e,device_uiid:t,platform:o}).then(i=>{s.setSession("device_registered",1)})},updateDevice(e,t,o){s.fetchDataByToken("updateDevice",{token:e,device_uiid:t,platform:o}).then(i=>{s.setSession("device_registered_auth",1)}).catch(i=>{s.notify("red-5",i,"error_outline",this.$q)})},setDarkMode(){console.log(this.DataStorePersisted.dark_mode),this.$q.dark.set(this.DataStorePersisted.dark_mode)},subsribeDevice(){let e=_.getUser();e&&!this.DataStorePersisted.push_off&&y.subscribeTo({topic:e.client_uuid}).then(t=>{this.DataStorePersisted.user_settings.app_push_notifications=!0}).catch(t=>{this.DataStorePersisted.user_settings.app_push_notifications=!1})},checkAppVersion(){this.$q.platform.is.android&&this.SettingStore.settings_data.app_update.mobile_app_version_android>0?this.SettingStore.settings_data.app_update.mobile_app_version_android>this.DataStorePersisted.app_version&&this.$router.replace("/update-app"):this.$q.platform.is.ios&&this.SettingStore.settings_data.app_update.mobile_app_version_ios>0&&this.SettingStore.settings_data.app_update.mobile_app_version_ios>this.DataStorePersisted.app_version&&this.$router.replace("/update-app")}}});function H(e,t,o,i,n,U){const f=d("NotiButton"),g=d("FooterMenu"),v=d("router-view"),D=d("ComponentsRealtime");return l(),m(L,{view:"lHh Lpr lFf",onScroll:e.scrollHandler},{default:r(()=>[a(R,{reveal:"",class:B({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:r(()=>[a(E,null,{default:r(()=>[Q("div",null,[a(V,{name:e.getDarkMode,size:"lg",color:"grey"},null,8,["name"]),a(q,{modelValue:e.DataStorePersisted.dark_mode,"onUpdate:modelValue":[t[0]||(t[0]=S=>e.DataStorePersisted.dark_mode=S),e.setDarkMode],color:e.$q.dark.mode?"grey":"primary",size:"lg"},null,8,["modelValue","color","onUpdate:modelValue"])]),a(T),e.path=="/cart"&&e.CartData.hasCart?(l(),m(h,{key:0,dense:"",flat:"",unelevated:"",color:"red-5",round:"",icon:"las la-trash",class:"q-ml-md",onClick:e.clearCart},null,8,["onClick"])):(l(),I(w,{key:1},[a(h,{dense:"",flat:"",unelevated:"",color:e.$q.dark.mode?"grey300":"grey",round:"",icon:"las la-globe",to:"/account/language",class:"q-ml-sm",size:"lg"},null,8,["color"]),a(f)],64))]),_:1})]),_:1},8,["class"]),e.CartData.home_view_items?A("",!0):(l(),m(F,{key:0,bordered:"",class:"bg-transparent modified-footer text-center relative-position text-dark",style:{height:"60px"}},{default:r(()=>[a(g,{direction:e.direction},null,8,["direction"])]),_:1})),a(O,null,{default:r(()=>[a(M,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",appear:"",duration:300},{default:r(()=>[a(v)]),_:1}),a(D)]),_:1})]),_:1},8,["onScroll"])}var ee=$(z,[["render",H]]);export{ee as default};
