import{Q as S}from"./QSpace.24950ca6.js";import{_ as Q,O as k,U as v,X as c,m as n,n as g,p as o,f as t,bh as w,af as f,bg as h,P as i,R as l,b8 as q,Q as y,Y as m,ac as _,F as C,$ as x,a0 as p,ah as D,S as b,ag as V,aX as B}from"./index.c5b868f5.js";import{Q as I}from"./QCircularProgress.1d7da185.js";import{Q as z}from"./QImg.79fcc1c6.js";import{Q as P}from"./QItemLabel.4665782c.js";import{Q as F}from"./QForm.997d74f6.js";import{C as A}from"./ClosePopup.32eeb9ff.js";import"./format.8ac60962.js";const T={name:"WalletTopupform",setup(){const e=k(),r=v();return{DataStorePersisted:e,SettingStore:r}},data(){return{dialog:!1,amount:2,loading:!1,default_payment:[],loading_submit:!1}},computed:{hasPayment(){return Object.keys(this.default_payment).length>0},getPayment(){return this.default_payment}},methods:{getCustomerDefaultPayment(){this.loading=!0,c.fetchDataByTokenPost("getCustomerDefaultPayment").then(e=>{this.default_payment=e.details.data,this.$emit("setPaymentcredentials",e.details.payment_credentials)}).catch(e=>{c.notify("dark",e,"error",this.$q)}).then(e=>{this.loading=!1})},onSubmit(){this.loading_submit=!0,c.fetchDataByTokenPost("prepareAddFunds","amount="+this.amount+"&payment_code="+this.default_payment.payment_code+"&payment_uuid="+this.default_payment.payment_uuid+"&currency_code="+this.DataStorePersisted.getUseCurrency()).then(e=>{this.$emit("afterPreparepayment",e.details)}).catch(e=>{c.notify("dark",e,"error",this.$q)}).then(e=>{this.loading_submit=!1})}}},N={class:"text-h6 text-weight-bold"},U={class:"text-body2 q-mb-md"},W={class:"text-body1 text-weight-medium q-mb-sm"},E={key:0,class:"q-pa-sm"},O={class:"radius20 bg-mygrey"},X={key:2,class:"q-gutter-y-sm"},Y={key:0,class:"text-body q-pa-sm bg-red-2 text-dark radius10"},j={class:"text-body2"};function L(e,r,M,u,s,a){return n(),g(B,{modelValue:s.dialog,"onUpdate:modelValue":r[1]||(r[1]=d=>s.dialog=d),position:this.$q.screen.lt.md?"bottom":"standard","transition-show":"fade","transition-hide":"fadeout",onBeforeShow:a.getCustomerDefaultPayment},{default:o(()=>[t(w,{class:f({"bg-grey600 text-white":e.$q.dark.mode})},{default:o(()=>[t(h,{class:"row items-center q-pb-none"},{default:o(()=>[i("div",N,l(e.$t("Add Funds to Your Wallet")),1),t(S),q(t(y,{icon:"close",flat:"",round:"",dense:""},null,512),[[A]])]),_:1}),t(F,{onSubmit:a.onSubmit},{default:o(()=>[t(h,null,{default:o(()=>[i("div",U,l(e.$t("topup_message")),1),i("div",W,l(e.$t("Payment Method")),1),s.loading?(n(),m("div",E,[t(I,{indeterminate:"",rounded:"",size:"25px",color:"primary"})])):_("",!0),a.hasPayment?(n(),m(C,{key:1},[i("div",O,[t(x,null,{default:o(()=>[t(p,{avatar:""},{default:o(()=>[a.getPayment.logo_type=="icon"?(n(),m("div",{key:0,class:f(["rounded-borders",u.SettingStore.payment_icons[a.getPayment.payment_code]?u.SettingStore.payment_icons[a.getPayment.payment_code].bg:"bg-blue"]),style:{padding:"1px 2px"}},[t(D,{name:u.SettingStore.payment_icons[a.getPayment.payment_code]?u.SettingStore.payment_icons[a.getPayment.payment_code].icon:"credit_card",size:"sm",color:"white"},null,8,["name"])],2)):(n(),g(z,{key:1,src:a.getPayment.logo_image,fit:"contain",style:{"max-height":"40px","max-width":"40px"},"spinner-size":"sm","spinner-color":"primary"},null,8,["src"]))]),_:1}),t(p,null,{default:o(()=>[t(P,null,{default:o(()=>[b(l(a.getPayment.attr1),1)]),_:1}),t(P,{caption:""},{default:o(()=>[b(l(a.getPayment.attr2),1)]),_:1})]),_:1}),t(p,{side:""},{default:o(()=>[t(y,{flat:"",label:e.$t("Change"),color:"primary","no-caps":"",to:{path:"/account/payments",query:{redirect:"/account/wallet"}}},null,8,["label"])]),_:1})]),_:1})]),t(V,{modelValue:s.amount,"onUpdate:modelValue":r[0]||(r[0]=d=>s.amount=d),label:e.$t("Enter amount"),type:"number",rules:[d=>d>0||this.$t("Please enter valid amount")]},null,8,["modelValue","label","rules"]),t(y,{type:"submit",label:e.$t("Add Funds"),loading:s.loading_submit,unelevated:"",color:e.$q.dark.mode?"grey300":"primary","text-color":"white","no-caps":"",class:"full-width",size:"17px",rounded:""},null,8,["label","loading","color"])],64)):(n(),m("div",X,[s.loading?_("",!0):(n(),m("div",Y,l(e.$t("We noticed you haven't added a default payment method yet"))+". ",1)),i("div",j,l(e.$t("topup_message1")),1),t(y,{color:"primary",rounded:"",label:e.$t("Add online payment"),class:"fit",size:"lg","no-caps":"",unelevated:"",to:{path:"/account/payments",query:{redirect:"/account/wallet"}}},null,8,["label"])]))]),_:1})]),_:1},8,["onSubmit"])]),_:1},8,["class"])]),_:1},8,["modelValue","position","onBeforeShow"])}var te=Q(T,[["render",L]]);export{te as default};
