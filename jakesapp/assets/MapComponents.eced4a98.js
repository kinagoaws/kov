import{_ as d,m as h,Y as k,P as i,af as l,f as m,Q as p,F as u}from"./index.c5b868f5.js";import{l as g}from"./index.4f152a18.js";const t=[];let n=[];const b={name:"MapComponents",props:["keys","lat","lng","provider","zoom","marker","detect_location","class_map"],data(){return{cmaps:void 0,data:[],loading:!1}},mounted(){this.loadMap()},watch:{marker(a,e){this.renderMap()},provider(a,e){this.loadMap()}},methods:{loadMap(){try{switch(this.provider){case"google.maps":g("https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&key="+this.keys).then(()=>{this.renderMap()}).catch(()=>{console.debug("failed loading map script")});break;case"mapbox":g("https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.js").then(()=>{this.renderMap()}).catch(()=>{console.debug("failed loading map script")});break;default:console.debug("no provider");break}}catch(a){console.error(a)}},renderMap(){try{switch(this.provider){case"google.maps":n=new window.google.maps.LatLngBounds,typeof this.cmaps!="undefined"&&this.cmaps!==null?Object.entries(this.marker).forEach(([a,e])=>{this.removeMarker(e.id)}):this.cmaps=new window.google.maps.Map(this.$refs.cmaps,{center:{lat:parseFloat(this.lat),lng:parseFloat(this.lng)},zoom:parseInt(this.zoom),disableDefaultUI:!0}),Object.entries(this.marker).forEach(([a,e])=>{this.addMarker({position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},map:this.cmaps,animation:window.google.maps.Animation.DROP,draggable:e.draggable},e.id,e.draggable)}),Object.keys(this.marker).length>1?this.FitBounds():this.setCenter(this.marker[0].lat,this.marker[0].lng);break;case"mapbox":mapboxgl.accessToken=this.keys,n=new mapboxgl.LngLatBounds,this.cmaps=new mapboxgl.Map({container:this.$refs.cmaps,style:"mapbox://styles/mapbox/streets-v12",center:[parseFloat(this.lng),parseFloat(this.lat)],zoom:14}),Object.entries(this.marker).forEach(([a,e])=>{this.addMarker({position:{lat:parseFloat(e.lat),lng:parseFloat(e.lng)},map:this.cmaps,animation:null,draggable:e.draggable},e.id,e.draggable)}),Object.keys(this.marker).length>1?this.FitBounds():this.setCenter(this.marker[0].lat,this.marker[0].lng);break}}catch{}},addMarker(a,e,r){try{switch(this.provider){case"google.maps":t[e]=new window.google.maps.Marker(a),this.cmaps.panTo(new window.google.maps.LatLng(a.position.lat,a.position.lng)),n.extend(t[e].position),r===!0&&(window.google.maps.event.addListener(t[e],"drag",s=>{}),window.google.maps.event.addListener(t[e],"dragend",s=>{const o=s.latLng;this.$emit("afterSelectmap",o.lat(),o.lng())}),window.google.maps.event.addListener(this.cmaps,"drag",s=>{let o=new google.maps.LatLng(this.cmaps.getCenter().lat(),this.cmaps.getCenter().lng());t[e].setPosition(o)}),google.maps.event.addListener(this.cmaps,"dragend",s=>{let o=new google.maps.LatLng(this.cmaps.getCenter().lat(),this.cmaps.getCenter().lng());this.$emit("afterSelectmap",o.lat(),o.lng())}));break;case"mapbox":t[e]=new mapboxgl.Marker(a).setLngLat([a.position.lng,a.position.lat]).addTo(this.cmaps),n.extend(new mapboxgl.LngLat(a.position.lng,a.position.lat)),r===!0&&(t[e].on("dragend",s=>{const o=t[e].getLngLat();this.$emit("afterSelectmap",o.lat,o.lng)}),this.cmaps.on("drag",()=>{this.$emit("onDrag",!0),t[e].setLngLat([this.cmaps.getCenter().lng.toFixed(4),this.cmaps.getCenter().lat.toFixed(4)])}),this.cmaps.on("dragend",()=>{t[e].setLngLat([this.cmaps.getCenter().lng.toFixed(4),this.cmaps.getCenter().lat.toFixed(4)]),this.$emit("afterSelectmap",this.cmaps.getCenter().lat.toFixed(4),this.cmaps.getCenter().lng.toFixed(4))})),this.mapBoxResize();break}}catch(s){console.error(s)}},mapBoxResize(){this.provider=="mapbox"&&setTimeout(()=>{this.cmaps.resize()},800)},updateMarker(a,e,r){try{setTimeout(()=>{const s=new window.google.maps.LatLng(e,r);typeof t[a]!="undefined"&&t[a]!==null&&(t[a].setPosition(s),this.cmaps.panTo(s))},10)}catch(s){console.error(s)}},removeMarker(a){try{switch(this.provider){case"google.maps":typeof t[a]!="undefined"&&t[a]!==null&&(t[a].setMap(null),t.splice(a,1));break}}catch(e){console.error(e)}},setCenter(a,e){try{switch(this.provider){case"google.maps":this.cmaps.setCenter(new window.google.maps.LatLng(a,e));break;case"mapbox":this.cmaps.flyTo({center:[e,a],essential:!0});break}}catch(r){console.error(r)}},FitBounds(){try{switch(this.provider){case"google.maps":this.cmaps.fitBounds(n);break;case"mapbox":this.cmaps.fitBounds(n,{duration:0,padding:50});break}}catch(a){console.error(a)}},setPlusZoom(){this.cmaps.setZoom(this.cmaps.getZoom()+2)},setLessZoom(){this.cmaps.setZoom(this.cmaps.getZoom()-2)}}},w={class:"col"},f={class:"col"};function v(a,e,r,s,o,c){return h(),k(u,null,[i("div",{ref:"cmaps",class:l(["bg-grey-1",r.class_map])},null,2),i("div",{class:l(["absolute-bottom-right",{"q-ma-md":!this.$q.screen.lt.md,"q-ma-sm":this.$q.screen.lt.md}]),style:{"z-index":"99"}},[i("div",{class:l(["column",{"q-gutter-y-md":!this.$q.screen.lt.md,"q-gutter-y-sm":this.$q.screen.lt.md}])},[i("div",w,[m(p,{unelevated:"",color:"warning",icon:"add",dense:"",onClick:c.setPlusZoom},null,8,["onClick"])]),i("div",f,[m(p,{unelevated:"",color:"warning",icon:"remove",dense:"",onClick:c.setLessZoom},null,8,["onClick"])])],2)],2)],64)}var C=d(b,[["render",v]]);export{C as default};
