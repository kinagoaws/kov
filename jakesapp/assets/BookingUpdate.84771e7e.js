import{_ as Q,ad as T,U,X as _,l as C,m as s,Y as n,f as a,p as d,af as B,F as m,Q as g,S as c,ag as h,Z as y,ac as u,R as l,n as q,P as r,ai as R}from"./index.c5b868f5.js";import{Q as E}from"./QToolbarTitle.4da9f270.js";import{Q as P}from"./QToolbar.9b15bf0e.js";import{Q as z}from"./QHeader.b374650f.js";import{Q as f}from"./QSelect.65ab904e.js";import{Q as v}from"./QSpace.24950ca6.js";import{Q as V}from"./QFooter.51024c6d.js";import{Q as x}from"./QForm.997d74f6.js";import{Q as F}from"./QInnerLoading.ff23f6a9.js";import{Q as D}from"./QPage.528ab8a8.js";import{u as L}from"./BookingStore.4fe3817f.js";import"./QResizeObserver.3ed5059f.js";import"./QItemLabel.4665782c.js";import"./QMenu.b5349f2e.js";import"./selection.65959ca5.js";import"./rtl.276c3f1b.js";import"./format.8ac60962.js";const N={name:"BookingUpdate",components:{componentsRecaptcha:T(()=>R(()=>import("./componentsRecaptcha.2f09d1e7.js"),["assets/componentsRecaptcha.2f09d1e7.js","assets/index.c5b868f5.js","assets/index.7897e990.css"]))},data(){return{loading:!1,recaptcha_response:"",success_data:[],reservation_uuid:""}},setup(){const e=L(),i=U();return{BookingStore:e,SettingStore:i}},mounted(){this.BookingStore.steps=1,this.reservation_uuid=this.$route.query.id,Object.keys(this.SettingStore.settings_data).length>0?this.Getbookingattributes():this.$watch(()=>this.SettingStore.$state.settings_data,(e,i)=>{this.Getbookingattributes()})},computed:{isEdit(){return!_.empty(this.reservation_uuid)}},methods:{Getbookingattributes(){this.reservation_uuid=this.$route.query.id,this.BookingStore.Getbookingattributes(this.SettingStore.merchant_uuid,this.reservation_uuid)},SetBooking(){this.BookingStore.SetBooking(this.SettingStore.merchant_uuid,this.reservation_uuid)},recaptchaExpired(){_.empty(this.$refs.recapcha)&&this.$refs.recapcha.reset()},recaptchaFailed(){},recaptchaVerified(e){this.recaptcha_response=e},onSubmit(){this.loading=!0;let e="merchant_uuid="+this.SettingStore.merchant_uuid;e+="&reservation_date="+this.BookingStore.reservation_date,e+="&reservation_time="+this.BookingStore.reservation_time,e+="&guest="+this.BookingStore.guest,e+="&first_name="+this.BookingStore.first_name,e+="&last_name="+this.BookingStore.last_name,e+="&email_address="+this.BookingStore.email_address,e+="&mobile_prefix="+this.SettingStore.settings_data.phone_data.phonecode,e+="&mobile_number="+this.BookingStore.mobile_number,e+="&room_uuid="+this.BookingStore.room_uuid,e+="&table_uuid="+this.BookingStore.table_uuid,e+="&special_request="+this.BookingStore.special_request,e+="&recaptcha_response="+this.recaptcha_response,e+="&id="+this.reservation_uuid,e+="&request_from=single_app",_.fetchDataPostTableToken("ReserveTable",e).then(i=>{this.success_data=i.details,this.BookingStore.steps=3,this.BookingStore.room_uuid="",this.BookingStore.table_uuid=""}).catch(i=>{this.recaptchaExpired(),this.success_data=[],_.notify("dark",i,"error_outline",this.$q)}).then(i=>{this.loading=!1})}}},G={key:0,class:"row q-gutter-sm"},I={class:"q-mt-sm text-weight-bold text-body1"},Y={class:"text-caption text-body2"},A={class:"q-mt-sm text-weight-bold text-body1"},M={class:"q-mt-sm text-weight-medium font15"},O={class:"text-grey q-mt-md q-mb-md"},j={class:"row items-center q-gutter-sm"},H={key:2,class:"flex flex-center text-center",style:{height:"calc(85vh)"}},X={class:"text-center"},Z={class:"text-body2 q-mb-none"},J={class:"text-grey text-body2"},K={class:"text-body2 line-normal q-mb-none"},W={class:"text-grey text-body2"},$={class:"text-success"},ee={class:"q-gutter-sm"};function oe(e,i,te,o,S,k){const w=C("componentsRecaptcha");return s(),n(m,null,[a(z,{class:B(["bg-whitex",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-black":!e.$q.dark.mode}]),reveal:""},{default:d(()=>[a(P,null,{default:d(()=>[a(g,{onClick:i[0]||(i[0]=t=>e.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:e.$q.dark.mode?"grey":"mygrey","text-color":e.$q.dark.mode?"grey-9":"dark"},null,8,["color","text-color"]),a(E,{class:"text-weight-bold text-darkx"},{default:d(()=>i[16]||(i[16]=[c("Update Reservation")])),_:1})]),_:1})]),_:1},8,["class"]),a(D,{class:"q-pl-md q-pr-md q-pb-md q-pt-sm"},{default:d(()=>[o.BookingStore.hasData?(s(),n(m,{key:0},[o.BookingStore.getSteps==1?(s(),n(m,{key:0},[a(f,{modelValue:o.BookingStore.guest,"onUpdate:modelValue":[i[1]||(i[1]=t=>o.BookingStore.guest=t),i[2]||(i[2]=t=>o.BookingStore.getTimeslot(o.SettingStore.merchant_uuid,this.reservation_uuid))],options:o.BookingStore.guest_list,label:e.$t("Guest"),dense:"",color:"primary",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":""},null,8,["modelValue","options","label"]),a(f,{modelValue:o.BookingStore.reservation_date,"onUpdate:modelValue":[i[3]||(i[3]=t=>o.BookingStore.reservation_date=t),i[4]||(i[4]=t=>o.BookingStore.getTimeslot(o.SettingStore.merchant_uuid,this.reservation_uuid))],options:o.BookingStore.date_list,label:e.$t("Date"),dense:"",color:"primary",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":""},null,8,["modelValue","options","label"]),a(v,{class:"q-pa-sm"}),a(h,{filled:"",modelValue:o.BookingStore.reservation_time,"onUpdate:modelValue":i[5]||(i[5]=t=>o.BookingStore.reservation_time=t),label:e.$t("Time"),disable:""},null,8,["modelValue","label"]),a(v,{class:"q-pa-sm"}),o.BookingStore.hasTimeSlot?(s(),n("div",G,[(s(!0),n(m,null,y(o.BookingStore.getTimeList,t=>(s(),n(m,{key:t},[(s(!0),n(m,null,y(t,(p,b)=>(s(),n("div",{key:p,class:"col-2 text-center"},[a(g,{unelevated:"",label:p,class:"full-width",outline:!o.BookingStore.isSelected(b),color:o.BookingStore.isSelected(b)?e.$q.dark.mode?"grey300":"primary":o.BookingStore.isNotavailable(b)?"grey":e.$q.dark.mode?"grey300":"black",onClick:ie=>o.BookingStore.reservation_time=b,disabled:o.BookingStore.isNotavailable(b)},null,8,["label","outline","color","onClick","disabled"])]))),128))],64))),128))])):u("",!0),a(V,{class:B(["q-pl-md q-pr-md q-pt-sm q-pb-sm bg-whitex border-top",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode}])},{default:d(()=>[a(g,{color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",disabled:!o.BookingStore.bookingValid,loading:o.BookingStore.loading,onClick:k.SetBooking},{default:d(()=>[c(l(e.$t("Continue")),1)]),_:1},8,["disabled","loading","onClick"])]),_:1},8,["class"])],64)):u("",!0),o.BookingStore.getSteps==2?(s(),q(x,{key:1,onSubmit:k.onSubmit},{default:d(()=>[r("div",I,l(e.$t("Reservation details")),1),r("div",Y,[r("div",null,l(o.BookingStore.reservation_info.full_time),1),r("div",null,l(o.BookingStore.reservation_info.guest),1)]),r("div",A,l(e.$t("Personal details")),1),a(h,{modelValue:o.BookingStore.first_name,"onUpdate:modelValue":i[6]||(i[6]=t=>o.BookingStore.first_name=t),label:e.$t("First name"),"lazy-rules":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(h,{modelValue:o.BookingStore.last_name,"onUpdate:modelValue":i[7]||(i[7]=t=>o.BookingStore.last_name=t),label:e.$t("Last name"),"lazy-rules":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(h,{modelValue:o.BookingStore.email_address,"onUpdate:modelValue":i[8]||(i[8]=t=>o.BookingStore.email_address=t),label:e.$t("Email address"),"lazy-rules":"",rules:[(t,p)=>p.email(t)||e.$t("Please enter a valid email address")]},null,8,["modelValue","label","rules"]),a(h,{modelValue:o.BookingStore.mobile_number,"onUpdate:modelValue":i[9]||(i[9]=t=>o.BookingStore.mobile_number=t),label:e.$t("Mobile number"),mask:"##################",prefix:o.SettingStore.settings_data.phone_data.phonecode,rules:[t=>t&&t.length>0||e.$t("This field is required"),t=>t.length<=15||e.$t("Please use maximum 15 characters")]},null,8,["modelValue","label","prefix","rules"]),o.SettingStore.settings_data.allowed_choose_table?(s(),n(m,{key:0},[a(f,{modelValue:o.BookingStore.room_uuid,"onUpdate:modelValue":[i[10]||(i[10]=t=>o.BookingStore.room_uuid=t),i[11]||(i[11]=t=>o.BookingStore.table_uuid="")],options:o.BookingStore.room_list,label:e.$t("Room name"),"transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","options","label","rules"]),a(f,{modelValue:o.BookingStore.table_uuid,"onUpdate:modelValue":i[12]||(i[12]=t=>o.BookingStore.table_uuid=t),options:o.BookingStore.table_list[o.BookingStore.room_uuid],label:e.$t("Table name"),"transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":"",rules:[t=>t&&t.length>0||e.$t("This field is required")]},null,8,["modelValue","options","label","rules"])],64)):u("",!0),r("div",M,l(e.$t("Special requests")),1),a(h,{modelValue:o.BookingStore.special_request,"onUpdate:modelValue":i[13]||(i[13]=t=>o.BookingStore.special_request=t),autogrow:"",color:"warning"},null,8,["modelValue"]),o.SettingStore.settings_data.booking_enabled_capcha?(s(),n(m,{key:1},[a(v,{class:"q-pa-sm"}),a(w,{ref:"recapcha",sitekey:o.SettingStore.settings_data.captcha_site_key,is_enabled:"1",language_code:o.SettingStore.settings_data.captcha_lang,size:"normal",theme:"light",tabindex:0,onVerify:k.recaptchaVerified,onExpire:k.recaptchaExpired,onFail:k.recaptchaFailed},null,8,["sitekey","language_code","onVerify","onExpire","onFail"])],64)):u("",!0),r("p",O,l(e.$t("By continuing, you agree to Terms of Service and Privacy Policy"))+". ",1),a(V,{class:B(["q-pl-md q-pr-md q-pt-sm q-pb-sm bg-whitex border-top",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode}])},{default:d(()=>[r("div",j,[a(g,{color:e.$q.dark.mode?"grey":"dark","text-color":e.$q.dark.mode?"grey-9":"white",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"col",onClick:i[14]||(i[14]=t=>this.BookingStore.steps=1)},{default:d(()=>[c(l(e.$t("Cancel")),1)]),_:1},8,["color","text-color"]),a(g,{type:"submit",color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"col",loading:S.loading},{default:d(()=>[c(l(e.$t("Update")),1)]),_:1},8,["loading"])])]),_:1},8,["class"])]),_:1},8,["onSubmit"])):u("",!0),o.BookingStore.getSteps==3?(s(),n("div",H,[r("div",X,[i[17]||(i[17]=r("svg",{class:"checkmark",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 52 52"},[r("circle",{class:"checkmark__circle",cx:"26",cy:"26",r:"25",fill:"none"}),r("path",{class:"checkmark__check",fill:"none",d:"M14.1 27.2l7.1 7.2 16.7-16.8"})],-1)),r("h4",Z,[k.isEdit?(s(),n(m,{key:0},[c(l(e.$t("Your reservation succesfully updated"))+". ",1)],64)):(s(),n(m,{key:1},[c(l(e.$t("Your reservation successfully placed"))+". ",1)],64))]),r("p",J,l(e.$t("You will receive another email once your reservation is confirm"))+". ",1),r("h5",K,l(S.success_data.full_time),1),r("div",W,[r("div",null,l(S.success_data.guest),1),r("div",null,[c(l(e.$t("Reservation ID"))+"# ",1),r("span",$,l(S.success_data.reservation_id),1)])]),a(v,{class:"q-pa-md"}),r("div",ee,[a(g,{type:"submit",color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",label:e.$t("Track your reservation"),to:{path:"/reservation/track",query:{id:S.success_data.reservation_uuid}}},null,8,["label","to"]),a(g,{type:"submit",color:"dark",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",label:e.$t("Reserved table again"),onClick:i[15]||(i[15]=t=>o.BookingStore.resetReservation(o.SettingStore.merchant_uuid))},null,8,["label"])])])])):u("",!0)],64)):u("",!0),o.BookingStore.isLoading?(s(),q(F,{key:1,showing:!0,color:e.$q.dark.mode?"grey300":"primary"},null,8,["color"])):u("",!0)]),_:1})],64)}var ve=Q(N,[["render",oe]]);export{ve as default};
