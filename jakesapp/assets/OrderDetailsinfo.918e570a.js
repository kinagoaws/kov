import{Q as p}from"./QSpace.24950ca6.js";import{_ as u,U as v,O as f,X as i,m as d,n as y,p as l,f as s,bh as c,af as S,bg as h,P as g,R as w,b8 as D,Q as m,bS as P,Y as b,ac as V,bT as Q,aX as C}from"./index.c5b868f5.js";import{Q as k}from"./QBtnToggle.f3167bc9.js";import{Q as q}from"./QInnerLoading.ff23f6a9.js";import{Q as _}from"./QSelect.65ab904e.js";import{C as B}from"./ClosePopup.32eeb9ff.js";import"./QItemLabel.4665782c.js";import"./QMenu.b5349f2e.js";import"./selection.65959ca5.js";import"./rtl.276c3f1b.js";import"./format.8ac60962.js";const U={name:"OrderDetailsinfo",data(){return{modal:!1,loading:!1,transaction_type:"",whento_deliver:"now",delivery_date:"",delivery_time:""}},setup(){const o=v(),e=f();return{SettingStore:o,DataStorePersisted:e}},methods:{beforeShow(){this.loading=!0,Object.keys(this.SettingStore.settings_data).length>0?this.setForm():this.$watch(()=>this.SettingStore.$state.settings_data,(o,e)=>{this.setForm()})},setForm(){this.loading=!1,console.log("setForm"),i.empty(this.DataStorePersisted.transaction_type)?this.transaction_type=this.SettingStore.settings_data.default_services:this.transaction_type=this.DataStorePersisted.transaction_type,i.empty(this.DataStorePersisted.whento_deliver)||(this.whento_deliver=this.DataStorePersisted.whento_deliver,this.chooseWhen(this.whento_deliver))},async chooseWhen(o){if(o==="schedule"){const e=await this.SettingStore.getDeliveryTimes();i.empty(this.DataStorePersisted.delivery_date)?this.delivery_date=e||null:this.delivery_date=this.DataStorePersisted.delivery_date,i.empty(this.DataStorePersisted.delivery_time)||(this.delivery_time=this.DataStorePersisted.delivery_time?this.DataStorePersisted.delivery_time:"")}else this.delivery_date="",this.delivery_time=""},saveTransactionInfo(){if(i.empty(this.transaction_type))return i.notify("negative",this.$t("Please select transaction type"),"error_outline",this.$q),!1;if(i.empty(this.whento_deliver))return i.notify("negative",this.$t("Please select when now or schedule for later"),"error_outline",this.$q),!1;if(this.whento_deliver==="schedule"){if(i.empty(this.delivery_date))return i.notify("negative",this.$t("Please select prefered date"),"error_outline",this.$q),!1;if(i.empty(this.delivery_time))return i.notify("negative",this.$t("Please select prefered time"),"error_outline",this.$q),!1}this.DataStorePersisted.transaction_type=this.transaction_type,this.DataStorePersisted.whento_deliver=this.whento_deliver,this.DataStorePersisted.delivery_date=this.delivery_date,i.empty(this.delivery_time.value)||(this.DataStorePersisted.delivery_time=this.delivery_time.value,this.DataStorePersisted.delivery_time_data=this.delivery_time),this.modal=!1,this.SettingStore.formatTransaction(),this.$emit("afterSavetrans")}}},T={class:"text-h6 text-weight-bold"},O={key:0,class:"q-mt-md relative-position"};function F(o,e,I,r,t,n){return d(),y(C,{modelValue:t.modal,"onUpdate:modelValue":e[4]||(e[4]=a=>t.modal=a),position:"bottom",persistent:"","transition-show":"fade","transition-hide":"fadeout","full-width":"",onBeforeShow:n.beforeShow},{default:l(()=>[s(c,{class:S({"bg-grey600 text-white":o.$q.dark.mode})},{default:l(()=>[s(h,{class:"row items-center q-pb-none"},{default:l(()=>[g("div",T,w(o.$t("Choose prefered time")),1),s(p),D(s(m,{icon:"close",flat:"",round:"",dense:""},null,512),[[B]])]),_:1}),s(h,null,{default:l(()=>[s(k,{modelValue:t.transaction_type,"onUpdate:modelValue":e[0]||(e[0]=a=>t.transaction_type=a),"toggle-color":"warning","no-caps":"",unelevated:"",class:"rounded-group",options:r.SettingStore.settings_data.services_list},null,8,["modelValue","options"]),s(P,{modelValue:t.whento_deliver,"onUpdate:modelValue":[e[1]||(e[1]=a=>t.whento_deliver=a),n.chooseWhen],options:r.SettingStore.settings_data.delivery_option,color:"warning"},null,8,["modelValue","options","onUpdate:modelValue"]),t.whento_deliver==="schedule"?(d(),b("div",O,[s(q,{showing:r.SettingStore.loading_gettimes,color:"warning"},null,8,["showing"]),s(_,{label:o.$t("Date"),"stack-label":"",modelValue:t.delivery_date,"onUpdate:modelValue":[e[2]||(e[2]=a=>t.delivery_date=a),o.chooseDate],"transition-show":"scale","transition-hide":"scale",options:r.SettingStore.delivery_date_list,"emit-value":"","map-options":""},null,8,["label","modelValue","options","onUpdate:modelValue"]),s(_,{label:o.$t("Time"),"stack-label":"",modelValue:t.delivery_time,"onUpdate:modelValue":e[3]||(e[3]=a=>t.delivery_time=a),"transition-show":"scale","transition-hide":"scale",options:r.SettingStore.delivery_time_list[t.delivery_date]?r.SettingStore.delivery_time_list[t.delivery_date]:[],"map-options":""},null,8,["label","modelValue","options"])])):V("",!0)]),_:1}),s(Q,null,{default:l(()=>[s(m,{unelevated:"",rounded:"",color:"primary","text-color":"white","no-caps":"",class:"full-width q-mb-md",label:o.$t("Save"),size:"lg",onClick:n.saveTransactionInfo,loading:t.loading},null,8,["label","onClick","loading"])]),_:1})]),_:1},8,["class"])]),_:1},8,["modelValue","onBeforeShow"])}var Y=u(U,[["render",F]]);export{Y as default};
