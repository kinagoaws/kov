import{_ as k,ad as c,U as $,O as y,X as o,ae as h,l as m,m as S,Y as q,f as t,p as n,af as v,F as C,Q as _,P as r,R as a,S as T,ai as g}from"./index.c5b868f5.js";import{Q as w}from"./QToolbar.9b15bf0e.js";import{Q as P}from"./QHeader.b374650f.js";import{Q as R}from"./QSpace.24950ca6.js";import{Q as x}from"./QPage.528ab8a8.js";import"./QResizeObserver.3ed5059f.js";const Q={name:"VerifyCode",data(){return{loading:!1,otp:"",message:"",counter:10}},components:{ResendTimer:c(()=>g(()=>import("./ResendTimer.e0a37471.js"),["assets/ResendTimer.e0a37471.js","assets/index.c5b868f5.js","assets/index.7897e990.css"])),OtpInput:c(()=>g(()=>import("./OtpInput.339baa8b.js"),["assets/OtpInput.339baa8b.js","assets/index.c5b868f5.js","assets/index.7897e990.css"]))},setup(e){const s=$(),d=y();return{SettingStore:s,DataStorePersisted:d}},mounted(){this.uuid=this.$route.query.uuid,this.message=this.$route.query.msg,Object.keys(this.SettingStore.settings_data).length>0?(this.counter=this.SettingStore.settings_data.resend_counter,setTimeout(()=>{this.$refs.resend_timer.startTimer()},500)):this.$watch(()=>this.SettingStore.$state.settings_data,(e,s)=>{this.counter=e.resend_counter,setTimeout(()=>{this.$refs.resend_timer.startTimer()},500)})},methods:{onSubmit(){console.log("otp=>"+this.otp),this.loading=!0,o.fetchDataPost("verifyCodeSignup",{client_uuid:this.uuid,verification_code:this.otp,auto_login:1}).then(e=>{o.notify(this.$q.dark.mode?"grey600":"dark",e.msg,"check_circle",this.$q),h.setUser(e.details.user_data),h.setToken(e.details.user_token),this.DataStorePersisted.user_settings=e.details.user_settings,this.$router.push("/home")}).catch(e=>{o.notify("dark",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})},onResend(){this.loading=!0,o.fetchDataPost("requestCode","client_uuid="+this.uuid).then(e=>{this.message=e.msg,o.notify(this.$q.dark.mode?"grey600":"dark",e.msg,"check_circle",this.$q),this.$refs.resend_timer.startTimer()}).catch(e=>{o.notify("dark",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})}}},b={class:"full-width q-pa-md"},D={class:"q-ma-none text-weight-bold"},O={class:"text-weight-light text-dark"},V={class:"text-dark"},E={class:"text-right q-pt-sm"};function I(e,s,d,A,i,l){const p=m("OtpInput"),f=m("ResendTimer");return S(),q(C,null,[t(P,{reveal:"",class:v({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:n(()=>[t(w,null,{default:n(()=>[t(_,{onClick:s[0]||(s[0]=u=>e.$router.back()),round:"",dense:"",icon:"arrow_back",unelevated:"",color:e.$q.dark.mode?"white":"mygrey","text-color":"dark"},null,8,["color"])]),_:1})]),_:1},8,["class"]),t(x,{padding:"",class:"text-dark flex flex-center"},{default:n(()=>[r("div",b,[r("h5",D,a(e.$t("Verification Code")),1),r("p",O,a(e.$t("Enter the code we sent you"))+"! ",1),r("p",V,a(i.message),1),t(p,{"onUpdate:modelValue":s[1]||(s[1]=u=>i.otp=u),inputLength:4}),r("div",E,[t(f,{ref:"resend_timer",loading:i.loading,data:{title:this.$t("Resend code"),counter:i.counter},onOnResend:l.onResend},null,8,["loading","data","onOnResend"])]),t(R,{class:"q-pa-xl"}),t(_,{color:"primary",size:"lg",rounded:"",unelevated:"","no-caps":"",class:"full-width",onClick:l.onSubmit,loading:i.loading},{default:n(()=>[T(a(e.$t("Confirm")),1)]),_:1},8,["onClick","loading"])])]),_:1})],64)}var j=k(Q,[["render",I]]);export{j as default};
