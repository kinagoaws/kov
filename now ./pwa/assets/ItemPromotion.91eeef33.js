import{_ as b,aA as C,u as P,A as i,n as q,p as a,a2 as s,f as o,t as l,F as f,a1 as k,a4 as h,Z as u,$ as m,a0 as v,q as p,ar as c,au as _,a3 as x,aB as Q}from"./index.c29f7992.js";import{Q as A}from"./QToolbarTitle.38b5862b.js";import{Q as S}from"./QToolbar.19752286.js";import{Q as B}from"./QHeader.8a0fa205.js";import{Q as $}from"./QInnerLoading.d034c390.js";import{Q as T}from"./QPage.1b02519d.js";import{Q as I}from"./QPullToRefresh.9f003a0c.js";import{u as L}from"./AccessStore.abc714c5.js";import"./QResizeObserver.0e413222.js";import"./TouchPan.5fac99c8.js";import"./touch.9135741d.js";import"./selection.53b1fe34.js";import"./format.de7e9769.js";const V={name:"ItemAddPrice",components:{ConfirmDialog:C(()=>Q(()=>import("./ConfirmDialog.f7360be1.js"),["assets/ConfirmDialog.f7360be1.js","assets/QToolbarTitle.38b5862b.js","assets/index.c29f7992.js","assets/index.8924bfb8.css","assets/QToolbar.19752286.js"]))},data(){return{dialog_price:!1,id:"",loading:!0,data:[],edit:!1,data_to_delete:[],title:""}},setup(e){const t=P(),g=L();return{DataStore:t,AccessStore:g}},computed:{hasData(){return Object.keys(this.data).length>0||!i.empty(this.id)},hasData2(){return Object.keys(this.data).length>0}},created(){this.id=this.$route.query.item_uuid,i.empty(this.id)?this.loading=!1:this.getSalePromotion()},methods:{refresh(e){this.getSalePromotion(e)},getSalePromotion(e){this.loading=!0,i.fetchDataByTokenPost("getSalePromotion","id="+this.id).then(t=>{this.data=t.details.data}).catch(t=>{this.data=[]}).then(t=>{this.loading=!1,i.empty(e)||e()})},confirmDelete(e,t){this.data_to_delete=e,this.data_to_delete.index=t,this.$refs.confirm_dialog.dialog=!0},afterConfirm(){this.$refs.confirm_dialog.dialog=!1,i.showLoadingBox("",this.$q),i.fetchDataByTokenPost("deletePromotion","item_uuid="+this.id+"&promo_id="+this.data_to_delete.promo_id).then(e=>{this.data.splice(this.data_to_delete.index,1)}).catch(e=>{i.notify("dark",e,"error",this.$q)}).then(e=>{i.hideLoadingBox(this.$q)})}}},z={class:"row items-center justify-between"},E={class:"text-weight-bold"},N={class:"row items-stretch items-center q-gutter-md"},O={class:"col-3"},R={key:1,class:"full-width text-center"},j={class:"text-weight-bold"};function F(e,t,g,y,r,d){const D=q("ConfirmDialog");return a(),s(f,null,[o(I,{onRefresh:d.refresh},{default:l(()=>[o(B,{class:k({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:l(()=>[o(S,null,{default:l(()=>[o(h,{onClick:t[0]||(t[0]=n=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),o(A,{class:"text-weight-bold"},{default:l(()=>[u(m(e.$t("Sales Promotion")),1)]),_:1})]),_:1}),o(v)]),_:1},8,["class"]),o(T,{class:k([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode,"flex flex-center":!r.loading&&!d.hasData},"q-pa-md"])},{default:l(()=>[r.loading?(a(),p($,{key:0,showing:!0,color:"primary",size:"md"})):(a(),s(f,{key:1},[d.hasData?(a(),s(f,{key:0},[c("div",z,[c("div",E,m(e.$t("Promo")),1),y.AccessStore.hasAccess("food.itempromo_delete")?(a(),s(f,{key:0},[d.hasData2?(a(),p(h,{key:0,label:r.edit?this.$t("Done"):this.$t("Edit"),flat:"","no-caps":"",color:"primary",onClick:t[1]||(t[1]=n=>r.edit=!r.edit)},null,8,["label"])):_("",!0)],64)):_("",!0)]),o(v,{class:"q-mb-lg"}),c("div",N,[(a(!0),s(f,null,x(r.data,(n,w)=>(a(),s("div",{class:"col-5 relative-position",key:n},[r.edit?(a(),p(h,{key:0,round:"",color:"primary",icon:"las la-trash",dense:"",unelevated:"",size:"sm",class:"absolute-top-left z-max",style:{top:"-10px"},onClick:H=>d.confirmDelete(n,w)},null,8,["onClick"])):_("",!0),o(h,{color:"mygrey","text-color":"dark",class:"line-normal radius8 font13",unelevated:"",style:{"min-height":"70px"},"no-caps":"",to:{path:"/item/promotionupdate",query:{item_uuid:r.id,promo_id:n.promo_id}}},{default:l(()=>[u(m(n.name),1)]),_:2},1032,["to"])]))),128)),c("div",O,[o(h,{color:"primary","text-color":"white",class:"line-normal radius8 font13",unelevated:"",style:{"min-height":"70px"},"no-caps":"",to:{path:"/item/promotioncreate",query:{item_uuid:r.id}}},{default:l(()=>[u(" + "+m(e.$t("Add")),1)]),_:1},8,["to"])])])],64)):(a(),s("div",R,[c("div",j,m(e.$t("ID is missing")),1),c("div",null,m(e.$t("Oops sorry we cannot find what your looking for")),1)]))],64))]),_:1},8,["class"])]),_:1},8,["onRefresh"]),o(D,{ref:"confirm_dialog",data:y.DataStore.data_dialog,onAfterConfirm:d.afterConfirm},null,8,["data","onAfterConfirm"])],64)}var re=b(V,[["render",F]]);export{re as default};
