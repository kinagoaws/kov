import{_ as D,u as w,A as s,p as i,a2 as f,f as o,t as r,a1 as h,F as p,a4 as n,Z as b,$ as g,a0 as O,q as v,av as u,ae as k,ar as _,a5 as y}from"./index.c29f7992.js";import{Q as C}from"./QToolbarTitle.38b5862b.js";import{Q as $}from"./QToolbar.19752286.js";import{Q as P}from"./QHeader.8a0fa205.js";import{Q as T}from"./QInnerLoading.d034c390.js";import{Q as V}from"./QDate.053d7758.js";import{Q}from"./QPopupProxy.612ef87b.js";import{Q as S}from"./QSelect.ae814dfc.js";import{Q as U}from"./QSpace.0d53e539.js";import{Q as B}from"./QFooter.478b051a.js";import{Q as A}from"./QForm.32515fc9.js";import{Q as F}from"./QPage.1b02519d.js";import{C as q}from"./ClosePopup.ab93d23e.js";import{u as I}from"./DriverStore.03d03fce.js";import{u as j}from"./CartStore.99e9bb86.js";import"./QResizeObserver.0e413222.js";import"./use-render-cache.3aae9b27.js";import"./date.1357beaa.js";import"./format.de7e9769.js";import"./QMenu.074d3579.js";import"./selection.53b1fe34.js";import"./QChip.5de2d333.js";import"./QItemLabel.1db45aa2.js";import"./rtl.276c3f1b.js";const z={name:"OffersManage",data(){return{id:"",data:[],loading:!1,status:"publish",offer_percentage:0,offer_price:0,valid_from:"",valid_to:"",applicable_selected:[]}},setup(e){const t=w(),c=I(),d=j();return{DataStore:t,DriverStore:c,CartStore:d}},created(){this.DriverStore.PromoAttributes()},mounted(){this.id=this.$route.query.id,s.empty(this.id)||this.getData()},computed:{isEdit(){return!s.empty(this.id)},hasData(){return Object.keys(this.data).length>0},CheckData(){return!s.empty(this.id)&&Object.keys(this.data).length<=0}},methods:{getData(){this.loading=!0,s.fetchDataByTokenPost("getOffers","id="+this.id).then(e=>{this.data=e.details,this.offer_percentage=e.details.offer_percentage,this.offer_price=e.details.offer_price,this.valid_from=e.details.valid_from,this.valid_to=e.details.valid_to,this.applicable_selected=e.details.applicable_to,this.status=e.details.status}).catch(e=>{s.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.loading=!1})},afterInput(e){this.phone=e},formSubmit(){let e={id:this.id,offer_percentage:this.offer_percentage,offer_price:this.offer_price,valid_from:this.valid_from,valid_to:this.valid_to,applicable_selected:this.applicable_selected,status:this.status};s.showLoadingBox("",this.$q),s.fetchDataByTokenPost(s.empty(this.id)?"AddOffers":"UpdateOffers",e).then(t=>{s.notify("light-green",t.msg,"check_circle",this.$q),this.$router.replace({path:"/promo/offers-list"})}).catch(t=>{s.notify("red-5",t,"error_outline",this.$q)}).then(t=>{s.hideLoadingBox(this.$q)})}}},E={class:"row items-center justify-end"},L={class:"row items-center justify-end"};function N(e,t,c,d,a,m){return i(),f(p,null,[o(P,{class:h({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:r(()=>[o($,null,{default:r(()=>[o(n,{onClick:t[0]||(t[0]=l=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),o(C,{class:"text-weight-bold"},{default:r(()=>[m.isEdit?(i(),f(p,{key:0},[b(g(e.$t("Update Offers")),1)],64)):(i(),f(p,{key:1},[b(g(e.$t("Add Offers")),1)],64))]),_:1})]),_:1}),o(O)]),_:1},8,["class"]),o(F,{class:h([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode},"q-pa-md"])},{default:r(()=>[a.loading?(i(),v(T,{key:0,showing:!0,color:"primary",size:"md"})):(i(),v(A,{key:1,onSubmit:m.formSubmit},{default:r(()=>[o(u,{modelValue:a.offer_percentage,"onUpdate:modelValue":t[1]||(t[1]=l=>a.offer_percentage=l),label:e.$t("Offer Percentage"),type:"number","stack-label":"",outlined:"",color:"grey-5",rules:[l=>l&&l>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(u,{modelValue:a.offer_price,"onUpdate:modelValue":t[2]||(t[2]=l=>a.offer_price=l),label:e.$t("Orders Over"),type:"number",step:"any","stack-label":"",outlined:"",color:"grey-5",rules:[l=>l&&l>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(u,{modelValue:a.valid_from,"onUpdate:modelValue":t[4]||(t[4]=l=>a.valid_from=l),mask:"date",rules:["date"],"stack-label":"",outlined:"",color:"grey-5",label:e.$t("Valid From"),class:"col"},{append:r(()=>[o(k,{name:"event",class:"cursor-pointer"},{default:r(()=>[o(Q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[o(V,{modelValue:a.valid_from,"onUpdate:modelValue":t[3]||(t[3]=l=>a.valid_from=l),color:"blue"},{default:r(()=>[_("div",E,[y(o(n,{label:e.$t("Close"),color:"dark",flat:"","no-caps":""},null,8,["label"]),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),o(u,{modelValue:a.valid_to,"onUpdate:modelValue":t[6]||(t[6]=l=>a.valid_to=l),mask:"date",rules:["date"],"stack-label":"",outlined:"",color:"grey-5",label:e.$t("Valid To"),class:"col"},{append:r(()=>[o(k,{name:"event",class:"cursor-pointer"},{default:r(()=>[o(Q,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:r(()=>[o(V,{modelValue:a.valid_to,"onUpdate:modelValue":t[5]||(t[5]=l=>a.valid_to=l),color:"blue"},{default:r(()=>[_("div",L,[y(o(n,{label:e.$t("Close"),color:"dark",flat:"","no-caps":""},null,8,["label"]),[[q]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","label"]),o(S,{modelValue:a.applicable_selected,"onUpdate:modelValue":t[7]||(t[7]=l=>a.applicable_selected=l),label:e.$t("Applicable to"),options:d.DriverStore.getPromoAttributes.services,"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5","emit-value":"","map-options":"",multiple:""},null,8,["modelValue","label","options"]),o(U,{class:"q-pa-sm"}),o(S,{modelValue:a.status,"onUpdate:modelValue":t[8]||(t[8]=l=>a.status=l),options:d.DataStore.status_list,label:e.$t("Status"),"stack-label":"",behavior:"dialog",outlined:"",color:"grey-5",rules:[l=>l&&l.length>0||this.$t("This field is required")],"emit-value":"","map-options":""},null,8,["modelValue","options","label","rules"]),o(B,null,{default:r(()=>[o(n,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":"",disable:m.CheckData},null,8,["label","disable"])]),_:1})]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var pe=D(z,[["render",N]]);export{pe as default};
