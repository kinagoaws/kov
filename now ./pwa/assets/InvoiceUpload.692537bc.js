import{_ as v,aA as q,A as s,n as P,p as d,q as u,t as h,f as o,a4 as c,Z as m,$ as i,a0 as Q,a1 as f,a2 as _,ar as l,ae as $,au as A,av as b,F as w,aB as V}from"./index.c29f7992.js";import{Q as U}from"./QToolbarTitle.38b5862b.js";import{Q as C}from"./QToolbar.19752286.js";import{Q as D}from"./QHeader.8a0fa205.js";import{Q as B}from"./QInnerLoading.d034c390.js";import{Q as g}from"./QImg.a00dd4e9.js";import{Q as T}from"./QSpace.0d53e539.js";import{Q as I}from"./QFooter.478b051a.js";import{Q as F}from"./QForm.32515fc9.js";import{Q as S}from"./QPage.1b02519d.js";import{Q as N}from"./QPullToRefresh.9f003a0c.js";import{A as y}from"./AppCamera.b25b6351.js";import"./QResizeObserver.0e413222.js";import"./TouchPan.5fac99c8.js";import"./touch.9135741d.js";import"./selection.53b1fe34.js";import"./format.de7e9769.js";const z={name:"InvoiceActivity",components:{UploaderFile:q(()=>V(()=>import("./UploaderFile.f34f6cc5.js"),["assets/UploaderFile.f34f6cc5.js","assets/QUploader.ee8da2fc.js","assets/index.c29f7992.js","assets/index.8924bfb8.css","assets/QCircularProgress.bcda6a33.js","assets/format.de7e9769.js"]))},data(){return{id:null,loading:!1,data:[],account_name:"",amount:0,reference_number:"",is_refresh:void 0,upload_enabled:!1,photo_data:"",photo:"",upload_path:"",avatar:""}},mounted(){this.id=this.$route.query.id,s.empty(this.id)||this.getData()},computed:{hasData(){return Object.keys(this.data).length>0},hasPhotodata(){return Object.keys(this.photo_data).length>0},hasPhoto(){return!s.empty(this.photo)}},methods:{formSubmit(){s.showLoadingBox("",this.$q),s.fetchDataByTokenPost("invoiceProofpayment",{id:this.id,account_name:this.account_name,amount:this.amount,reference_number:this.reference_number,photo:this.photo,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:""}).then(e=>{s.notify("light-green",e.msg,"check_circle",this.$q),this.$router.replace({path:"/invoice/list"})}).catch(e=>{s.notify("red-5",e,"error_outline",this.$q)}).then(e=>{s.hideLoadingBox(this.$q)})},refresh(e){this.is_refresh=e,this.getData()},getData(){s.empty(this.is_refresh)&&(this.loading=!0),s.fetchDataByTokenPost("getInvoice","id="+this.id).then(e=>{this.data=e.details,this.account_name=e.details.account_name,this.amount=e.details.amount,this.reference_number=e.details.reference_number,this.photo=e.details.photo,this.upload_path=e.details.upload_path,this.avatar=e.details.avatar}).catch(e=>{s.notify("red-5",e,"error_outline",this.$q)}).then(e=>{this.loading=!1,s.empty(this.is_refresh)||this.is_refresh()})},afterUploadfile(e){this.photo=e.filename,this.avatar=e.url_image,this.upload_path=e.upload_path},takePhoto(){this.$q.capacitor?y.isCameraEnabled().then(e=>{y.isFileAccessEnabled().then(t=>{y.getPhoto(1).then(p=>{this.photo_data=p}).catch(p=>{this.photo_data=[]})}).catch(t=>{s.notify("dark",t,"error",this.$q)})}).catch(e=>{s.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},hadData(){return Object.keys(this.photo_data).length>0}}},E={class:"text-subtitle1 q-mb-sm"},R={class:"text-caption"},j={class:"text-caption"},L={class:"q-pt-sm q-pb-sm"},O={class:"text-subtitle2"},x={class:"text-subtitle2"},G={class:"row q-gutter-sm"},M={class:"col"},H={class:"font12 line-normal"};function J(e,t,p,Z,r,n){const k=P("UploaderFile");return d(),u(N,{onRefresh:n.refresh},{default:h(()=>[o(D,{class:f({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:h(()=>[o(C,null,{default:h(()=>[o(c,{onClick:t[0]||(t[0]=a=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),o(U,{class:"text-weight-bold"},{default:h(()=>[m(i(e.$t("Upload deposit")),1)]),_:1})]),_:1}),o(Q)]),_:1},8,["class"]),o(S,{class:f([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode},"q-pa-md"])},{default:h(()=>[r.loading?(d(),u(B,{key:0,showing:!0,color:"primary",size:"md"})):(d(),_(w,{key:1},[l("div",E,i(e.$t("Upload Proof of Payment")),1),l("div",R,i(e.$t("Please enter the details of your bank deposit payment below")),1),l("div",j,i(e.$t("Failure to provide accurate information may cause delays in processing or invalidation of your payment"))+". ",1),l("div",L,[l("div",O,i(e.$t("Invoice No#"))+": "+i(r.data.invoice_number),1),l("div",x,i(e.$t("Amount"))+": "+i(r.data.total),1)]),o(F,{onSubmit:n.formSubmit},{default:h(()=>[l("div",G,[n.hasPhotodata?(d(),u(g,{key:0,src:r.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):n.hasPhoto?(d(),u(g,{key:1,src:this.avatar,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(d(),_("div",{key:2,class:f(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[o($,{name:"las la-image",class:"text-grey",size:"xl"})],2)),l("div",M,[l("div",H,[m(i(e.$t("Proof of payment"))+".",1),t[4]||(t[4]=l("br",null,null,-1)),m(" "+i(e.$t("Maximum 2 MB")),1),t[5]||(t[5]=l("br",null,null,-1)),m(" "+i(e.$t("Accepted types: PNG. JPG")),1)]),o(c,{label:n.hasPhoto?this.$t("Change Photo"):n.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:n.takePhoto},null,8,["label","onClick"])])]),r.upload_enabled?(d(),u(k,{key:0,ref:"uploader_file",onAfterUploadfile:n.afterUploadfile},null,8,["onAfterUploadfile"])):A("",!0),o(T,{class:"q-pa-sm"}),o(b,{modelValue:r.account_name,"onUpdate:modelValue":t[1]||(t[1]=a=>r.account_name=a),label:e.$t("Account name"),"stack-label":"",outlined:"",color:"grey-5",rules:[a=>a&&a.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(b,{modelValue:r.amount,"onUpdate:modelValue":t[2]||(t[2]=a=>r.amount=a),type:"number",step:"any",label:e.$t("Amount"),"stack-label":"",outlined:"",color:"grey-5",rules:[a=>a&&a>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(b,{modelValue:r.reference_number,"onUpdate:modelValue":t[3]||(t[3]=a=>r.reference_number=a),label:e.$t("Reference Number"),"stack-label":"",outlined:"",color:"grey-5",rules:[a=>a&&a.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),o(I,null,{default:h(()=>[o(c,{type:"submit",color:"primary","text-color":"white",label:e.$t("Submit"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})]),_:1},8,["onSubmit"])],64))]),_:1},8,["class"])]),_:1},8,["onRefresh"])}var pe=v(z,[["render",J]]);export{pe as default};
