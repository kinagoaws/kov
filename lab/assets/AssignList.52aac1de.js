import{_ as q,aA as Q,A as n,n as D,p as a,q as f,t,f as r,a4 as m,Z as p,$ as d,a1 as _,a2 as u,F as v,ar as c,av as S,au as k,b8 as A,a3 as C,aB as z,a6 as w,a7 as y,a8 as x}from"./index.c29f7992.js";import{Q as $}from"./QToolbarTitle.38b5862b.js";import{Q as B}from"./QToolbar.19752286.js";import{Q as T}from"./QHeader.8a0fa205.js";import{Q as I}from"./QInnerLoading.d034c390.js";import{Q as L}from"./QImg.a00dd4e9.js";import{Q as g}from"./QItemLabel.1db45aa2.js";import{Q as V}from"./QList.04c37cb8.js";import{Q as F}from"./QFooter.478b051a.js";import{Q as N}from"./QPage.1b02519d.js";import{Q as P}from"./QPullToRefresh.9f003a0c.js";import{u as R}from"./DriverStore.03d03fce.js";import"./QResizeObserver.0e413222.js";import"./TouchPan.5fac99c8.js";import"./touch.9135741d.js";import"./selection.53b1fe34.js";import"./format.de7e9769.js";const Z={name:"AssignList",components:{FilterByZone:Q(()=>z(()=>import("./FilterByZone.60fffd24.js"),["assets/FilterByZone.60fffd24.js","assets/QToolbarTitle.38b5862b.js","assets/index.c29f7992.js","assets/index.8924bfb8.css","assets/QSpace.0d53e539.js","assets/QToolbar.19752286.js","assets/QItemLabel.1db45aa2.js","assets/QList.04c37cb8.js","assets/QFooter.478b051a.js","assets/QResizeObserver.0e413222.js","assets/DriverStore.03d03fce.js"]))},data(){return{selected_driver:[],order_uuid:"",loading:!1,zone_id:"",group_selected:"",q:""}},setup(e){return{DriverStore:R()}},created(){this.order_uuid=this.$route.query.order_uuid,this.refresh(null)},computed:{hasSelected(){return Object.keys(this.selected_driver).length>0},hasFilter(){return this.zone_id>0||this.group_selected>0||!n.empty(this.q)}},methods:{refresh(e){e&&(this.q="",this.zone_id="",this.group_selected="",this.DriverStore.is_refresh=!0),this.DriverStore.getAvailableDriver("zone_id="+this.zone_id+"&group_selected="+this.group_selected+"&q="+this.q+"&order_uuid="+this.order_uuid,e)},afterApplyfilter(e,i){this.zone_id=e,this.group_selected=i,this.refresh(null)},applyfilter(){n.empty(this.q)||this.refresh(null)},setSelected(e){this.selected_driver=e.selected?[]:e,e.selected=!e.selected},Assign(){this.loading=!0,n.fetchDataByTokenPost("AssignDriver","driver_id="+this.selected_driver.driver_id+"&order_uuid="+this.order_uuid).then(e=>{n.notify(this.$q.dark.mode?"grey600":"light-green",e.msg,"check_circle",this.$q),this.$router.replace({path:"/orderview",query:{order_uuid:this.order_uuid}})}).catch(e=>{n.notify("dark",e,"error",this.$q)}).then(e=>{this.loading=!1})}}},E={key:0,class:"text-grey"},O={class:"flex flex-center q-gutter-sm q-mb-sm"},j={class:"col"},H={class:"border-grey bg-white radius8"},U={class:"col-1"},G={key:0,class:"flex flex-center",style:{"min-height":"400px"}},J={class:"text-grey"};function K(e,i,M,l,h,o){const b=D("FilterByZone");return a(),f(P,{onRefresh:o.refresh},{default:t(()=>[r(T,{class:_({"bg-mydark text-white":e.$q.dark.mode,"bg-grey-1 text-dark":!e.$q.dark.mode}),reveal:""},{default:t(()=>[r(B,null,{default:t(()=>[r(m,{onClick:i[0]||(i[0]=s=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),r($,{class:"text-weight-bold"},{default:t(()=>[p(d(e.$t("Select a driver to assign")),1)]),_:1})]),_:1})]),_:1},8,["class"]),r(N,{class:_([{"bg-mydark text-white":e.$q.dark.mode,"bg-grey-1 text-dark":!e.$q.dark.mode,"flex flex-center":!l.DriverStore.hasDrivers},"q-pl-md q-pr-md q-pb-md"])},{default:t(()=>[l.DriverStore.getLoading&&!l.DriverStore.is_refresh?(a(),f(I,{key:0,showing:!0,color:"primary",size:"md","label-class":"dark",class:"transparent"})):(a(),u(v,{key:1},[l.DriverStore.hasDrivers?(a(),u(v,{key:1},[c("div",O,[c("div",j,[c("div",H,[r(S,{modelValue:h.q,"onUpdate:modelValue":i[1]||(i[1]=s=>h.q=s),flat:"",outlined:"",dense:"",label:e.$t("Search driver by name")},{append:t(()=>[r(m,{round:"",dense:"",flat:"",icon:"search",onClick:o.applyfilter},null,8,["onClick"])]),_:1},8,["modelValue","label"])])]),c("div",U,[r(m,{round:"",icon:"filter_list",unelevated:"",color:"primary",size:"sm",onClick:i[2]||(i[2]=s=>this.$refs.filter_zone.modal=!0)})])]),l.DriverStore.hasDriverData?k("",!0):(a(),u("div",G,[c("p",J,d(e.$t("No available drivers")),1)])),r(A,{flat:""},{default:t(()=>[r(V,{separator:""},{default:t(()=>[(a(!0),u(v,null,C(l.DriverStore.getDrivers,s=>(a(),f(w,{key:s,clickable:"",active:s.selected,"active-class":"bg-teal-1 text-grey-8",onClick:W=>o.setSelected(s)},{default:t(()=>[r(y,{avatar:""},{default:t(()=>[r(x,{size:"50px;"},{default:t(()=>[r(L,{src:s.photo_url,sizes:"width:50px; height:50px;"},null,8,["src"])]),_:2},1024)]),_:2},1024),r(y,null,{default:t(()=>[r(g,null,{default:t(()=>[p(d(s.name),1)]),_:2},1024),r(g,{caption:""}),l.DriverStore.getActiveTask[s.driver_id]?(a(),f(g,{key:0,caption:""},{default:t(()=>[p(d(l.DriverStore.getActiveTask[s.driver_id])+" "+d(e.$t("active orders")),1)]),_:2},1024)):k("",!0)]),_:2},1024)]),_:2},1032,["active","onClick"]))),128))]),_:1})]),_:1}),r(F,{class:_(["q-gutter-sm q-pl-md q-pr-md q-pb-sm",{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-black":!e.$q.dark.mode}])},{default:t(()=>[r(m,{unelevated:"",color:"primary","no-caps":"",class:"radius8 fit",size:"lg",label:e.$t("Confirm"),loading:h.loading,disable:!o.hasSelected,onClick:o.Assign},null,8,["label","loading","disable","onClick"])]),_:1},8,["class"])],64)):(a(),u("p",E,d(e.$t("No available drivers")),1))],64))]),_:1},8,["class"]),r(b,{ref:"filter_zone",onAfterApplyfilter:o.afterApplyfilter},null,8,["onAfterApplyfilter"])]),_:1},8,["onRefresh"])}var pe=q(Z,[["render",K]]);export{pe as default};
