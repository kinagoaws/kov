import{_ as b,aA as w,A as r,n as q,p as s,q as n,t as i,f as a,a4 as f,Z as Q,$ as u,a0 as v,a1 as p,a2 as c,ar as m,ae as P,au as I,av as _,F as V,aB as D}from"./index.c29f7992.js";import{Q as F}from"./QToolbarTitle.38b5862b.js";import{Q as A}from"./QToolbar.19752286.js";import{Q as S}from"./QHeader.8a0fa205.js";import{Q as C}from"./QInnerLoading.d034c390.js";import{Q as y}from"./QImg.a00dd4e9.js";import{Q as $}from"./QFooter.478b051a.js";import{Q as U}from"./QForm.32515fc9.js";import{Q as B}from"./QPage.1b02519d.js";import{Q as T}from"./QPullToRefresh.9f003a0c.js";import{A as g}from"./AppCamera.b25b6351.js";import"./QResizeObserver.0e413222.js";import"./TouchPan.5fac99c8.js";import"./touch.9135741d.js";import"./selection.53b1fe34.js";import"./format.de7e9769.js";const z={name:"ItemSeo",data(){return{upload_enabled:!1,featured_filename:"",featured_url:"",upload_path:"",featured_data:"",loading:!1,meta_title:"",meta_description:"",meta_keywords:"",loading_get:!1,data:[]}},components:{UploaderFile:w(()=>D(()=>import("./UploaderFile.f34f6cc5.js"),["assets/UploaderFile.f34f6cc5.js","assets/QUploader.ee8da2fc.js","assets/index.c29f7992.js","assets/index.8924bfb8.css","assets/QCircularProgress.bcda6a33.js","assets/format.de7e9769.js"]))},created(){this.item_uuid=this.$route.query.item_uuid,r.empty(this.item_uuid)||this.getItem()},computed:{hasPhoto(){return!r.empty(this.featured_filename)},hasData(){return Object.keys(this.data).length>0},hasFeaturedData(){return Object.keys(this.featured_data).length>0}},methods:{refresh(e){r.empty(this.item_uuid)?e():this.getItem(e)},getItem(e){this.loading_get=!0,r.fetchDataByTokenPost("getItemSeo","item_uuid="+this.item_uuid).then(t=>{this.data=t.details,this.meta_title=t.details.meta_title,this.meta_description=t.details.meta_description,this.meta_keywords=t.details.meta_keywords,this.featured_filename=t.details.meta_image,this.featured_url=t.details.url_image,this.upload_path=t.details.meta_image_path}).catch(t=>{}).then(t=>{this.loading_get=!1,r.empty(e)||e()})},takePhoto(){this.$q.capacitor?g.isCameraEnabled().then(e=>{g.isFileAccessEnabled().then(t=>{g.getPhoto(1).then(h=>{this.featured_data=h}).catch(h=>{this.featured_data=[]})}).catch(t=>{r.notify("dark",t,"error",this.$q)})}).catch(e=>{r.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},onSubmit(){this.loading=!0,r.fetchDataByToken("updateItemSeo",{item_uuid:this.item_uuid,featured_filename:this.featured_filename,upload_path:this.upload_path,file_data:this.hadFeaturedData()?this.featured_data.data:"",image_type:this.hadFeaturedData()?this.featured_data.format:"",meta_title:this.meta_title,meta_description:this.meta_description,meta_keywords:this.meta_keywords}).then(e=>{r.notify("light-green",e.msg,"check_circle",this.$q)}).catch(e=>{r.notify("dark",e,"error",this.$q)}).then(e=>{this.loading=!1})},afterUploadfile(e){this.featured_filename=e.filename,this.featured_url=e.url_image,this.upload_path=e.upload_path},hadFeaturedData(){return Object.keys(this.featured_data).length>0}}},E={class:"q-pa-md q-gutter-md"},O={class:"row q-gutter-sm"},x={key:2,class:"col-3 row items-center justify-center bg-mygrey radius8",style:{height:"70px"}},N={class:"col"},R={class:"font12 line-normal"},j={key:1,class:"full-width text-center"},M={class:"text-weight-bold"};function G(e,t,h,L,l,o){const k=q("UploaderFile");return s(),n(T,{onRefresh:o.refresh},{default:i(()=>[a(S,{class:p({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:i(()=>[a(A,null,{default:i(()=>[a(f,{onClick:t[0]||(t[0]=d=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),a(F,{class:"text-weight-bold"},{default:i(()=>[Q(u(e.$t("Item SEO")),1)]),_:1})]),_:1}),a(v)]),_:1},8,["class"]),a(B,{class:p({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode,"flex flex-center":!o.hasData&&!l.loading_get})},{default:i(()=>[l.loading_get?(s(),n(C,{key:0,showing:!0,color:"primary",size:"md"})):(s(),n(U,{key:1,onSubmit:o.onSubmit},{default:i(()=>[o.hasData?(s(),c(V,{key:0},[m("div",E,[m("div",O,[o.hasFeaturedData?(s(),n(y,{key:0,src:l.featured_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):o.hasPhoto?(s(),n(y,{key:1,src:this.featured_url,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(s(),c("div",x,[a(P,{name:"las la-image",class:"text-grey",size:"xl"})])),m("div",N,[m("div",R,u(e.$t("Items with quality photos are often more popular. Maximum 2 MB"))+". "+u(e.$t("Accepted types: PNG. JPG")),1),a(f,{label:o.hasPhoto?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:o.takePhoto},null,8,["label","onClick"])]),l.upload_enabled?(s(),n(k,{key:3,ref:"uploader_file",onAfterUploadfile:o.afterUploadfile},null,8,["onAfterUploadfile"])):I("",!0)]),a(_,{outlined:"",modelValue:l.meta_title,"onUpdate:modelValue":t[1]||(t[1]=d=>l.meta_title=d),label:e.$t("Meta Title"),"stack-label":"",color:"grey-5","lazy-rules":""},null,8,["modelValue","label"]),a(_,{outlined:"",modelValue:l.meta_description,"onUpdate:modelValue":t[2]||(t[2]=d=>l.meta_description=d),label:e.$t("Meta Description"),"stack-label":"",color:"grey-5","lazy-rules":"",autogrow:""},null,8,["modelValue","label"]),a(_,{outlined:"",modelValue:l.meta_keywords,"onUpdate:modelValue":t[3]||(t[3]=d=>l.meta_keywords=d),label:e.$t("Keywords"),"stack-label":"",color:"grey-5","lazy-rules":"",autogrow:""},null,8,["modelValue","label"])]),a($,{class:p(["q-pl-md q-pr-md q-pb-xs",{"bg-mydark ":e.$q.dark.mode,"bg-white ":!e.$q.dark.mode}])},{default:i(()=>[a(f,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":"",loading:l.loading},null,8,["label","loading"])]),_:1},8,["class"])],64)):(s(),c("div",j,[m("div",M,u(e.$t("Record not found")),1),m("div",null,u(e.$t("Oops sorry we cannot find what your looking for")),1)]))]),_:1},8,["onSubmit"]))]),_:1},8,["class"])]),_:1},8,["onRefresh"])}var ne=b(z,[["render",G]]);export{ne as default};
