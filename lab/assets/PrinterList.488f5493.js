import{_ as L,u as x,b6 as U,A as g,p as i,a2 as p,f as e,t,aS as z,F as b,a1 as w,a4 as Q,Z as s,$ as l,a0 as E,q as m,ar as h,a8 as P,a3 as D,b8 as I,b9 as A,a5 as k,a7 as d,a9 as $,a6 as y,at as B,aa as v}from"./index.c29f7992.js";import{Q as T}from"./QToolbarTitle.38b5862b.js";import{Q as q}from"./QToolbar.19752286.js";import{Q as R}from"./QHeader.8a0fa205.js";import{Q as u}from"./QItemLabel.1db45aa2.js";import{Q as C}from"./QList.04c37cb8.js";import{Q as O}from"./QInnerLoading.d034c390.js";import{Q as F}from"./QSpinnerDots.f880c3c3.js";import{Q as N}from"./QInfiniteScroll.894949b1.js";import{Q as H}from"./QPageSticky.335c1979.js";import{Q as Y}from"./QPage.1b02519d.js";import{Q as Z}from"./QPullToRefresh.9f003a0c.js";import{Q as j}from"./QSpace.0d53e539.js";import{Q as G}from"./QForm.32515fc9.js";import{A as S}from"./AppBluetooth.81007bf8.js";import{u as J}from"./UserStore.28c5b9df.js";import"./QResizeObserver.0e413222.js";import"./use-page-sticky.3a081baa.js";import"./TouchPan.5fac99c8.js";import"./touch.9135741d.js";import"./selection.53b1fe34.js";import"./format.de7e9769.js";const K={name:"PrinterList",data(){return{loading:!1,data:[],page:0,is_refresh:void 0,osVersion:0,dialog:!1}},setup(){const a=J(),r=x();return{UserStore:a,DataStore:r}},created(){this.$q.capacitor&&this.getDevice()},methods:{async getDevice(){const a=await U.getInfo();this.osVersion=a.osVersion,this.initBT()},initBT(){this.osVersion>=12?this.$q.platform.is.ios?this.EnabledBT():S.CheckBTConnectPermissionOnly().then(a=>{this.EnabledBT()}).catch(a=>{this.$router.push("/settings/location-enabled")}).then(a=>{}):S.CheckLocationOnly().then(a=>{this.EnabledBT()}).catch(a=>{this.$router.push("/settings/location-enabled")}).then(a=>{})},EnabledBT(){S.Enabled().then(a=>{}).catch(a=>{g.notify("dark",a.message,"error",this.$q)}).then(a=>{})},refresh(a){this.is_refresh=a,this.resetPagination()},getPrinters(a,r){this.loading=!0,g.fetchDataByTokenPost("PrintersList","page="+a+"&device_uuid="+this.UserStore.device_uuid).then(c=>{c.code==1?(this.page=a,this.data.push(c.details.data)):c.code==3&&(this.data_done=!0,g.empty(this.$refs.nscroll)||this.$refs.nscroll.stop())}).catch(c=>{this.data_done=!0,g.empty(this.$refs.nscroll)||this.$refs.nscroll.stop()}).then(c=>{r(),this.loading=!1,g.empty(this.is_refresh)||this.is_refresh()})},resetPagination(){this.page=0,this.data=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()}}},M={key:0,class:"full-width text-center"},W={class:"text-weight-bold"},X={class:"text-grey font12"},ee={key:1,class:"fixed-bottom"},te={class:"text-center"},ae={class:"q-gutter-y-sm"};function re(a,r,c,f,n,V){return i(),p(b,null,[e(Z,{onRefresh:V.refresh},{default:t(()=>[e(R,{class:w({"bg-mydark text-white":a.$q.dark.mode,"bg-white text-dark":!a.$q.dark.mode})},{default:t(()=>[e(q,null,{default:t(()=>[e(Q,{onClick:r[0]||(r[0]=o=>a.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:a.$q.dark.mode?"white":"dark"},null,8,["color"]),e(T,{class:"text-weight-bold"},{default:t(()=>[s(l(a.$t("Printers")),1)]),_:1})]),_:1}),e(E)]),_:1},8,["class"]),e(Y,{class:w({"bg-mydark text-white":a.$q.dark.mode,"bg-white text-dark":!a.$q.dark.mode,"flex flex-center":n.data.length<=0&&!n.loading})},{default:t(()=>[e(N,{ref:"nscroll",onLoad:V.getPrinters,offset:250},{loading:t(()=>[n.page<=0?(i(),m(O,{key:0,showing:!0,color:"primary",size:"md"})):(i(),p("div",ee,[h("div",te,[e(F,{color:"primary",size:"40px"})])]))]),default:t(()=>[n.data.length<=0&&!n.loading?(i(),p("div",M,[e(P,{size:"100px","font-size":"52px",color:"mygrey","text-color":"grey",icon:"las la-print",class:"q-mb-sm"}),h("div",W,l(a.$t("You have no printers yet")),1),h("div",X,l(a.$t("To add printer, press the (+) button")),1)])):(i(),m(C,{key:1,separator:""},{default:t(()=>[(i(!0),p(b,null,D(n.data,o=>(i(),p(b,{key:o},[(i(!0),p(b,null,D(o,_=>(i(),m(y,{key:_,clickable:"",to:{path:"/settings/printer-view",query:{id:_.printer_id}}},{default:t(()=>[e(d,{avatar:""},{default:t(()=>[e(P,{color:"mygrey","text-color":"grey",icon:"las la-print"})]),_:1}),e(d,null,{default:t(()=>[e(u,null,{default:t(()=>[s(l(_.printer_name),1)]),_:2},1024),e(u,{caption:""},{default:t(()=>[s(l(_.printer_model),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["to"]))),128))],64))),128))]),_:1}))]),_:1},8,["onLoad"]),e(H,{position:"bottom-right",offset:[18,18]},{default:t(()=>[h("div",ae,[h("div",null,[e(Q,{round:"",icon:"las la-cog",size:"md",unelevated:"",color:"green","text-color":"white",padding:"sm",onClick:r[1]||(r[1]=o=>n.dialog=!n.dialog)})]),h("div",null,[e(Q,{round:"",icon:"las la-plus",size:"md",unelevated:"",color:"mygrey","text-color":"dark",to:"/settings/add-printer",padding:"sm"})])])]),_:1})]),_:1},8,["class"])]),_:1},8,["onRefresh"]),e(z,{modelValue:n.dialog,"onUpdate:modelValue":r[7]||(r[7]=o=>n.dialog=o),position:"bottom"},{default:t(()=>[e(I,null,{default:t(()=>[e(q,{class:"text-primary top-toolbar q-pl-md",dense:""},{default:t(()=>[e(T,{class:"text-dark text-weight-bold",style:{overflow:"inherit"}},{default:t(()=>[s(l(a.$t("Settings")),1)]),_:1}),e(j),e(Q,{onClick:r[2]||(r[2]=o=>n.dialog=!1),color:"white",square:"",unelevated:"","text-color":"grey",icon:"las la-times",dense:"","no-caps":"",size:"sm",class:"border-grey radius8"})]),_:1}),e(A,null,{default:t(()=>[e(G,{onSubmit:a.formSubmit},{default:t(()=>[e(C,null,{default:t(()=>[k((i(),m(y,{tag:"label",clickable:""},{default:t(()=>[e(d,null,{default:t(()=>[e(u,null,{default:t(()=>[s(l(a.$t("ESC/POS Printing")),1)]),_:1}),e(u,{caption:""},{default:t(()=>[s(l(a.$t("Use ESC/POS commands for efficient text")),1)]),_:1})]),_:1}),e(d,{avatar:""},{default:t(()=>[e($,{modelValue:f.DataStore.printer_set,"onUpdate:modelValue":r[3]||(r[3]=o=>f.DataStore.printer_set=o),val:"1"},null,8,["modelValue"])]),_:1})]),_:1})),[[v]]),k((i(),m(y,{tag:"label",clickable:""},{default:t(()=>[e(d,null,{default:t(()=>[e(u,null,{default:t(()=>[s(l(a.$t("Binary Image Printing")),1)]),_:1}),e(u,{caption:""},{default:t(()=>[s(l(a.$t("Print binary images, suitable for different language")),1)]),_:1})]),_:1}),e(d,{avatar:""},{default:t(()=>[e($,{modelValue:f.DataStore.printer_set,"onUpdate:modelValue":r[4]||(r[4]=o=>f.DataStore.printer_set=o),val:"2"},null,8,["modelValue"])]),_:1})]),_:1})),[[v]]),k((i(),m(y,{tag:"label",clickable:""},{default:t(()=>[e(d,null,{default:t(()=>[e(u,null,{default:t(()=>[s(l(a.$t("Auto close connection")),1)]),_:1}),e(u,{caption:""},{default:t(()=>[s(l(a.$t("Close bluetooth connection after printing")),1)]),_:1})]),_:1}),e(d,{avatar:""},{default:t(()=>[e(B,{color:"primary",modelValue:f.DataStore.printer_auto_close,"onUpdate:modelValue":r[5]||(r[5]=o=>f.DataStore.printer_auto_close=o),val:!0},null,8,["modelValue"])]),_:1})]),_:1})),[[v]]),k((i(),m(y,{tag:"label",clickable:""},{default:t(()=>[e(d,null,{default:t(()=>[e(u,null,{default:t(()=>[s(l(a.$t("Hide currency")),1)]),_:1}),e(u,{caption:""},{default:t(()=>[s(l(a.$t("do not display currency when printing, this is usefull when printer does not support currency symbol"))+". ",1)]),_:1})]),_:1}),e(d,{avatar:""},{default:t(()=>[e(B,{color:"primary",modelValue:f.DataStore.hide_currency,"onUpdate:modelValue":r[6]||(r[6]=o=>f.DataStore.hide_currency=o),val:"hide"},null,8,["modelValue"])]),_:1})]),_:1})),[[v]])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Pe=L(K,[["render",re]]);export{Pe as default};
