import{_ as $,aA as C,A as l,n as D,p as s,a2 as c,f as a,t as u,a1 as _,F as b,a4 as g,Z as m,$ as n,au as k,a0 as v,q as d,ar as h,ae as Q,av as A,aB as w}from"./index.c29f7992.js";import{Q as L}from"./QToolbarTitle.38b5862b.js";import{Q as x}from"./QToolbar.19752286.js";import{Q as U}from"./QHeader.8a0fa205.js";import{Q as V}from"./QInnerLoading.d034c390.js";import{Q as y}from"./QImg.a00dd4e9.js";import{Q as q}from"./QSpace.0d53e539.js";import{Q as B}from"./QFooter.478b051a.js";import{Q as F}from"./QForm.32515fc9.js";import{Q as T}from"./QPage.1b02519d.js";import{A as f}from"./AppCamera.b25b6351.js";import"./QResizeObserver.0e413222.js";const S={name:"AddLicense",data(){return{loading:!1,data:[],license_number:"",license_expiration:"",upload_enabled:!1,photo_data:"",photo:"",upload_path:"",avatar:"",upload_enabled2:!1,photo_data2:"",photo2:"",upload_path2:"",avatar2:""}},components:{UploaderFile:C(()=>w(()=>import("./UploaderFile.f34f6cc5.js"),["assets/UploaderFile.f34f6cc5.js","assets/QUploader.ee8da2fc.js","assets/index.c29f7992.js","assets/index.8924bfb8.css","assets/QCircularProgress.bcda6a33.js","assets/format.de7e9769.js"]))},computed:{hasData(){return Object.keys(this.data).length>0},hasPhotodata(){return Object.keys(this.photo_data).length>0},hasPhoto(){return!l.empty(this.photo)},hasPhotodata2(){return Object.keys(this.photo_data2).length>0},hasPhoto2(){return!l.empty(this.photo2)}},mounted(){this.id=this.$route.query.id,l.empty(this.id)||this.getLicense()},methods:{getLicense(){this.loading=!0,l.fetchDataByTokenPost("getDriverInfo","id="+this.id).then(e=>{this.data=e.details,this.license_number=this.data.license_number,this.license_expiration=this.data.license_expiration,this.avatar=e.details.license_front_photo_url,this.photo=e.details.license_front_photo,this.upload_path=e.details.path_license,this.avatar2=e.details.license_back_photo_url,this.photo2=e.details.license_back_photo,this.upload_path2=e.details.path_license}).catch(e=>{}).then(e=>{this.loading=!1})},formSubmit(){l.showLoadingBox("",this.$q);let e={id:this.id,license_number:this.license_number,license_expiration:this.license_expiration,photo:this.photo,upload_path:this.upload_path,file_data:this.hadData()?this.photo_data.data:"",image_type:this.hadData()?this.photo_data.format:"",upload_path2:this.upload_path2,photo2:this.photo2,file_data2:this.hadData2()?this.photo_data2.data:"",image_type2:this.hadData2()?this.photo_data2.format:""};l.fetchDataByTokenPost("AddLicense",e).then(t=>{l.notify("light-green",t.msg,"check_circle",this.$q)}).catch(t=>{l.notify("red-5",t,"error_outline",this.$q)}).then(t=>{l.hideLoadingBox(this.$q)})},afterUploadfile(e){this.photo=e.filename,this.avatar=e.url_image,this.upload_path=e.upload_path},afterUploadfile2(e){this.photo2=e.filename,this.avatar2=e.url_image,this.upload_path2=e.upload_path},takePhoto(){this.$q.capacitor?f.isCameraEnabled().then(e=>{f.isFileAccessEnabled().then(t=>{f.getPhoto(1).then(p=>{this.photo_data=p}).catch(p=>{this.photo_data=[]})}).catch(t=>{l.notify("dark",t,"error",this.$q)})}).catch(e=>{l.notify("dark",e,"error",this.$q)}):this.upload_enabled=!this.upload_enabled},hadData(){return Object.keys(this.photo_data).length>0},takePhoto2(){this.$q.capacitor?f.isCameraEnabled().then(e=>{f.isFileAccessEnabled().then(t=>{f.getPhoto(1).then(p=>{this.photo_data2=p}).catch(p=>{this.photo_data2=[]})}).catch(t=>{l.notify("dark",t,"error",this.$q)})}).catch(e=>{l.notify("dark",e,"error",this.$q)}):this.upload_enabled2=!this.upload_enabled2},hadData2(){return Object.keys(this.photo_data2).length>0}}},j={class:"row q-gutter-sm"},z={class:"col"},E={class:"font12 line-normal"},I={class:"q-mb-sm"},N={class:"row q-gutter-sm"},O={class:"col"},G={class:"font12 line-normal"},Y={key:1,class:"text-grey"};function J(e,t,p,H,i,o){const P=D("UploaderFile");return s(),c(b,null,[a(U,{class:_({"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode})},{default:u(()=>[a(x,null,{default:u(()=>[a(g,{onClick:t[0]||(t[0]=r=>e.$router.back()),flat:"",round:"",dense:"",icon:"las la-angle-left",color:e.$q.dark.mode?"white":"dark"},null,8,["color"]),a(L,{class:"text-weight-bold"},{default:u(()=>[m(n(e.$t("License"))+" ",1),o.hasData?(s(),c(b,{key:0},[m(" - "+n(i.data.first_name)+" "+n(i.data.last_name),1)],64)):k("",!0)]),_:1})]),_:1}),a(v)]),_:1},8,["class"]),a(T,{class:_([{"bg-mydark text-white":e.$q.dark.mode,"bg-white text-dark":!e.$q.dark.mode,"flex flex-center":!i.loading&&!o.hasData},"q-pa-md"])},{default:u(()=>[i.loading?(s(),d(V,{key:0,showing:!0,color:"primary",size:"md"})):(s(),d(F,{key:1,onSubmit:o.formSubmit},{default:u(()=>[o.hasData?(s(),c(b,{key:0},[h("div",j,[o.hasPhotodata?(s(),d(y,{key:0,src:i.photo_data.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):o.hasPhoto?(s(),d(y,{key:1,src:this.avatar,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(s(),c("div",{key:2,class:_(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[a(Q,{name:"las la-image",class:"text-grey",size:"xl"})],2)),h("div",z,[h("div",E,[m(n(e.$t("License front photo"))+".",1),t[3]||(t[3]=h("br",null,null,-1)),m(" "+n(e.$t("Accepted types: PNG. JPG")),1)]),a(g,{label:o.hasPhoto?this.$t("Change Photo"):o.hasData?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:o.takePhoto},null,8,["label","onClick"])])]),a(q,{class:"q-pa-sm"}),i.upload_enabled?(s(),d(P,{key:0,ref:"uploader_file",onAfterUploadfile:o.afterUploadfile},null,8,["onAfterUploadfile"])):k("",!0),h("div",I,[a(v)]),h("div",N,[o.hasPhotodata2?(s(),d(y,{key:0,src:i.photo_data2.path,"spinner-color":"primary","spinner-size":"sm",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):o.hasPhoto2?(s(),d(y,{key:1,src:this.avatar2,"spinner-color":"primary",fit:"cover",style:{height:"70px"},class:"col-3 radius8"},null,8,["src"])):(s(),c("div",{key:2,class:_(["col-3 row items-center justify-center radius8",{"bg-grey600 ":e.$q.dark.mode,"bg-mygrey ":!e.$q.dark.mode}]),style:{height:"70px"}},[a(Q,{name:"las la-image",class:"text-grey",size:"xl"})],2)),h("div",O,[h("div",G,[m(n(e.$t("License back photo"))+".",1),t[4]||(t[4]=h("br",null,null,-1)),m(" "+n(e.$t("Accepted types: PNG. JPG")),1)]),a(g,{label:o.hasPhoto2?this.$t("Change Photo"):e.hasData2?this.$t("Change Photo"):this.$t("Add Photo"),flat:"",color:"primary","no-caps":"",class:"q-pl-none q-pr-none",onClick:o.takePhoto2},null,8,["label","onClick"])])]),a(q,{class:"q-pa-sm"}),i.upload_enabled2?(s(),d(P,{key:1,ref:"uploader_file",onAfterUploadfile:o.afterUploadfile2},null,8,["onAfterUploadfile"])):k("",!0),a(q,{class:"q-pa-sm"}),a(A,{modelValue:i.license_number,"onUpdate:modelValue":t[1]||(t[1]=r=>i.license_number=r),label:e.$t("License number"),"stack-label":"",outlined:"",color:"grey-5",rules:[r=>r&&r.length>0||this.$t("This field is required")]},null,8,["modelValue","label","rules"]),a(A,{modelValue:i.license_expiration,"onUpdate:modelValue":t[2]||(t[2]=r=>i.license_expiration=r),label:e.$t("License expiration"),hint:e.$t("(YYYY/mm/dd)"),mask:"####/##/##","stack-label":"",outlined:"",color:"grey-5",rules:[r=>r&&r.length>0||this.$t("This field is required")]},null,8,["modelValue","label","hint","rules"]),a(B,null,{default:u(()=>[a(g,{type:"submit",color:"primary","text-color":"white",label:e.$t("Save"),unelevated:"",class:"full-width radius8",size:"lg","no-caps":""},null,8,["label"])]),_:1})],64)):(s(),c("div",Y,n(e.$t("No available data")),1))]),_:1},8,["onSubmit"]))]),_:1},8,["class"])],64)}var ie=$(S,[["render",J]]);export{ie as default};
