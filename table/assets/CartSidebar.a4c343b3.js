import{_ as D,l as R,u as P,Q as I,R as O,V as _,m as $,n as r,Z as a,F as s,ai as u,f as o,ad as C,X as n,a0 as d,aj as m,q as h,bb as z,$ as y,Y as b,bc as E,ap as L}from"./index.e99838a1.js";import{Q as v}from"./QSkeleton.d1e6632a.js";import{Q as V}from"./QInnerLoading.b001e9bf.js";import{Q as B}from"./QBadge.2c31fc9c.js";import{Q as N}from"./QImg.47660024.js";import{Q as q,a as k}from"./QItemSection.1392fb19.js";import{Q as x}from"./QItem.8eadf7d9.js";import{Q as A}from"./QList.8db9823b.js";const T={name:"CartSidebar",components:{DialogComponents:R(()=>P(()=>import("./DialogComponents.2e8a8bdd.js"),["assets/DialogComponents.2e8a8bdd.js","assets/index.e99838a1.js","assets/index.1028cef9.css","assets/ClosePopup.05834fd1.js"]))},setup(){const e=I(),l=O();return{RestaurantStore:e,DataPersisted:l}},data(){return{loading:!1,loading_rm:!1,submit_order:!1}},mounted(){this.getCart(!1)},methods:{getCart(e){this.RestaurantStore.Cart(this.RestaurantStore.payload,e)},lessCartQty(e,l){e--,e>0?this.updateCartQty(e,l):this.removeCartItem(l.cart_row)},addCartQty(e,l){e++,this.updateCartQty(e,l)},updateCartQty(e,l){this.loading=!0;let f="cart_uuid="+this.DataPersisted.cart_uuid+"&cart_row="+l.cart_row+"&item_qty="+e;_.fetchDataPost("updateCartItems",f).then(i=>{this.getCart(!0)}).catch(i=>{_.notify(this.$q,this.$t("Error"),i,"myerror","highlight_off","bottom")}).then(i=>{this.loading=!1})},removeCartItem(e){this.loading_rm=!0;let l="cart_uuid="+this.DataPersisted.cart_uuid+"&row="+e;_.fetchDataPost("removeCartItem",l).then(f=>{this.getCart(!0)}).catch(f=>{_.notify(this.$q,this.$t("Error"),f,"myerror","highlight_off","bottom")}).then(f=>{this.loading_rm=!1})},removeItem(e){this.removeCartItem(e.cart_row)},confirmOrder(){this.$refs.ref_dialog.modal=!0},sendOrder(){let e={cart_uuid:this.DataPersisted.cart_uuid,room_uuid:this.DataPersisted.room_uuid,table_number:this.DataPersisted.table_number,currency_code:this.DataPersisted.getUseCurrency(),attributes_data:{whento_deliver:"now"},transaction_type:this.DataPersisted.transaction_type};this.submit_order=!0,_.fetchDataPost("sendOrder",e).then(l=>{console.log("data",l),this.sendOrderSucess(),this.RestaurantStore.clearCart(),this.$q.screen.lt.md&&(this.RestaurantStore.right_drawer=!1)}).catch(l=>{_.notify(this.$q,this.$t("Error"),l,"myerror","highlight_off","bottom")}).then(l=>{this.submit_order=!1})},sendOrderSucess(){_.notify(this.$q,this.$t("Done"),this.$t("Your order has been successfully sent to our kitchen."),"mysuccess","done","bottom")}}},M={key:0,class:"q-pa-md"},Y={key:0,class:"fit flex flex-center q-pa-sm"},j={class:"text-body1 text-dark text-center text-weight-bold"},F={class:"q-pl-md q-pr-md text-weight-bold text-body2 bg-coffee"},H={class:"absolute-top-right index-1"},U={key:0,class:"text-caption"},X=["innerHTML"],Z={class:"quantity-input flex items-center justify-between full-width"},G={key:0},J={class:"fixed-bottom text-subtitle2 index-2 bg-coffee"},K={key:0,class:"q-pl-md q-pr-md q-pt-sm"},W={class:"q-pa-sm bg-red-1 text-caption radius10 error-border"},tt={class:"row"},et={class:"col-2"},rt={class:"col"},at={class:"q-pa-xs text-weight-bold q-gutter-y-xs"},st={key:0,class:"row items-center q-ml-sm q-mr-sm bg-maroon radius10 q-pa-sm"},ot={class:"col-5 line-normal text-white"},nt={class:"col text-right bg-white q-pr-xs"},lt={class:"row items-center q-pl-md q-pr-md q-mb-sm"};function it(e,l,f,i,w,g){const S=$("DialogComponents");return r(),a(s,null,[i.RestaurantStore.cart_loading?(r(),a("div",M,[(r(),a(s,null,u(3,t=>o(v,{key:t,height:"50px",square:"",class:C(["q-mb-sm",{"bg-grey600":e.$q.dark.mode,"bg-coffee":!e.$q.dark.mode}])},null,8,["class"])),64)),(r(),a(s,null,u(3,t=>o(v,{key:t,height:"180px",square:"",class:C(["q-mb-sm",{"bg-grey600":e.$q.dark.mode,"bg-coffee":!e.$q.dark.mode}])},null,8,["class"])),64))])):(r(),a(s,{key:1},[i.RestaurantStore.hasCart?m("",!0):(r(),a("div",Y,[n("div",j,[n("p",null,d(e.$t("Selected items will be listed here")),1)])])),o(V,{showing:i.RestaurantStore.cart_update,color:"primary",size:"2rem"},null,8,["showing"]),i.RestaurantStore.hasCart?(r(),a(s,{key:1},[n("div",F,[o(A,{class:"scroll",style:{"max-height":"calc(60vh)"}},{default:h(()=>[(r(!0),a(s,null,u(i.RestaurantStore.getCart.items,t=>(r(),a(s,{key:t},[o(x,{class:"q-pl-none q-pr-none q-pb-none q-gutter-x-sm",bordered:"",clickable:"",onClick:z(c=>t.is_edit=!t.is_edit,["stop"])},{default:h(()=>[o(q,{avatar:"",class:"relative-position"},{default:h(()=>[n("div",H,[o(B,{rounded:"",color:"dark",label:t.qty},null,8,["label"])]),o(N,{src:t.url_image,style:{height:"60px",width:"55px"},fit:"contain","spinner-color":"primary","spinner-size":"sm"},null,8,["src"])]),_:2},1024),o(q,{class:"line-normal"},{default:h(()=>[o(k,null,{default:h(()=>[n("div",null,d(t.item_name),1),t.price.size_name!=""?(r(),a("div",U,[n("span",{innerHTML:t.price.size_name},null,8,X)])):m("",!0)]),_:2},1024),o(k,{class:"text-caption text-weight-bold"},{default:h(()=>[t.price.discount<=0?(r(),a(s,{key:0},[y(d(t.price.pretty_total),1)],64)):(r(),a(s,{key:1},[y(d(t.price.pretty_total_after_discount),1)],64))]),_:2},1024)]),_:2},1024),o(q,null,{default:h(()=>[n("div",Z,[o(b,{dense:"",icon:t.qty==1?"delete_outline":"remove",color:t.qty==1?"cream":"primary","text-color":t.qty==1?"maroon":"white",unelevated:"",onClick:c=>g.lessCartQty(t.qty>1?t.qty--:1,t),disable:i.RestaurantStore.cart_loading,size:"12px"},null,8,["icon","color","text-color","onClick","disable"]),n("span",null,d(t.qty),1),o(b,{dense:"",icon:"add",color:"primary",unelevated:"",onClick:c=>g.addCartQty(t.qty++,t),disable:i.RestaurantStore.cart_loading,size:"12px"},null,8,["onClick","disable"])])]),_:2},1024)]),_:2},1032,["onClick"]),o(x,null,{default:h(()=>[o(k,{class:"text-caption"},{default:h(()=>[t.special_instructions!=""?(r(),a("div",G,d(t.special_instructions),1)):m("",!0),t.attributes!=""?(r(!0),a(s,{key:1},u(t.attributes,c=>(r(),a("p",{key:c,class:"no-margin"},[(r(!0),a(s,null,u(c,(p,Q)=>(r(),a(s,null,[y(d(p),1),Q<c.length-1?(r(),a(s,{key:0},[y(", ")],64)):m("",!0)],64))),256))]))),128)):m("",!0),(r(!0),a(s,null,u(t.addons,c=>(r(),a("div",{key:c},[(r(!0),a(s,null,u(c.addon_items,p=>(r(),a(s,{key:p},[y(d(p.sub_item_name)+" ("+d(p.pretty_addons_total)+") ",1)],64))),128))]))),128))]),_:2},1024)]),_:2},1024),o(E)],64))),128))]),_:1})]),n("div",J,[i.RestaurantStore.hasCartError?(r(),a("div",K,[n("div",W,[n("div",tt,[n("div",et,[o(L,{name:"o_cancel",size:"sm",color:"red-7"})]),n("div",rt,[(r(!0),a(s,null,u(i.RestaurantStore.getCartError,t=>(r(),a("div",{key:t,class:"text-red-7"},d(t),1))),128))])])])])):m("",!0),n("div",at,[(r(!0),a(s,null,u(i.RestaurantStore.getCart.summary,t=>(r(),a(s,{key:t},[t.type=="total"?(r(),a("div",st,[n("div",ot,d(t.name),1),n("div",nt,d(t.value),1)])):(r(),a(s,{key:1},[],64))],64))),128))]),n("div",lt,[o(b,{label:e.$t("Send Order"),"no-caps":"",unelevated:"",onClick:g.confirmOrder,loading:w.submit_order,disable:i.RestaurantStore.hasCartError,color:"cream","text-color":"maroon",class:"text-weight-bold radius6 fit border-mmaroon",size:"20px"},null,8,["label","onClick","loading","disable"])])])],64)):m("",!0)],64)),o(S,{ref:"ref_dialog",title:e.$t("Are you sure about your order?"),message:e.$t("Disclaimer: Once confirm, items are not exchangeable or refundable."),ok_label:e.$t("Yes"),cancel_label:e.$t("No"),onOnOk:g.sendOrder},null,8,["title","message","ok_label","cancel_label","onOnOk"])],64)}var yt=D(T,[["render",it]]);export{yt as default};
