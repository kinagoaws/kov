import{v as D,a1 as R,a3 as V,c as K,h as v,z as N,g as $,_ as H,l as L,u as T,Q as F,R as E,V as x,m as A,n as s,p as h,q as l,f as a,ae as M,af as Q,X as o,ad as z,a0 as n,Z as i,F as c,Y as _,aj as m,al as U,ai as g,$ as u,bc as Y,b0 as j}from"./index.e99838a1.js";import{Q as p}from"./QSpace.aa134d93.js";import{Q as G}from"./QInnerLoading.b001e9bf.js";import{Q as q}from"./QBadge.2c31fc9c.js";import{Q as b,a as k}from"./QItemSection.1392fb19.js";import{Q as P}from"./QItem.8eadf7d9.js";import{Q as B}from"./QList.8db9823b.js";import{Q as X}from"./QImg.47660024.js";import{Q as Z}from"./QPageSticky.6084301e.js";import{C as J}from"./ClosePopup.05834fd1.js";import{u as W}from"./OrderStore.41ef7af7.js";const tt=["horizontal","vertical","cell","none"];var et=D({name:"QMarkupTable",props:{...R,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:t=>tt.includes(t)}},setup(t,{slots:d}){const y=$(),r=V(t,y.proxy.$q),w=K(()=>`q-markup-table q-table__container q-table__card q-table--${t.separator}-separator`+(r.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(t.dense===!0?" q-table--dense":"")+(t.flat===!0?" q-table--flat":"")+(t.bordered===!0?" q-table--bordered":"")+(t.square===!0?" q-table--square":"")+(t.wrapCells===!1?" q-table--no-wrap":""));return()=>v("div",{class:w.value},[v("table",{class:"q-table"},N(d.default))])}});const rt={name:"OrderHistory",components:{NumberFormat:L(()=>T(()=>import("./NumberFormat.378ab695.js"),["assets/NumberFormat.378ab695.js","assets/index.e99838a1.js","assets/index.1028cef9.css"]))},data(){return{payload:["items","service_fee","packaging","tax","checkout","summary","total","items_count","send_order","kitchen_status"]}},setup(){const t=W(),d=F(),y=E();return{OrderStore:t,RestaurantStore:d,DataPersisted:y}},methods:{getOrderHistory(){this.OrderStore.Cart(this.payload)},toPagePayment(){console.log("count",this.RestaurantStore.getCartCount),this.RestaurantStore.getCartCount>0?this.$q.dialog({class:"bg-coffee text-cream text-body1",title:this.$t("Confirm"),message:"<span class='text-body2'>"+this.$t("Unable to Pay since the cart containes new item(s) that has not been sent to the kitchen")+".</span><br/><br/><span class='text-body2 text-weight-bold'>"+this.$t("Click to continue and clear new item(s)")+"</span>",html:!0,cancel:!0,persistent:!0,ok:{unelevated:!0,color:"cream",rounded:!1,"text-color":"maroon",size:"lg",label:this.$t("Continue"),"no-caps":!0,class:"text-weight-bold radius6 border-mmaroon"},cancel:{unelevated:!0,color:"lightmaroon",outline:!1,rounded:!1,size:"lg",label:this.$t("Cancel"),"no-caps":!0,class:"text-weight-bold radius6 border-lightmaroon"}}).onOk(()=>{this.clearItems()}).onCancel(()=>{}).onDismiss(()=>{}):(this.RestaurantStore.modal_order_history=!1,this.$router.push("/select-payment"))},clearItems(){x.showLoadingBox(this.$t("Clearing item(s)"),this.$q),x.fetchDataGet("clearItems","cart_uuid="+this.DataPersisted.cart_uuid).then(t=>{this.RestaurantStore.modal_order_history=!1,this.$router.push("/select-payment")}).catch(t=>{x.notify(this.$q,this.$t("Error"),t,"myerror","highlight_off","bottom")}).then(t=>{x.hideLoadingBox(this.$q)})}}},at={class:"q-pl-md q-pr-md"},ot={class:"bg-maroon text-white text-body1"},st={class:"text-left"},lt={class:"text-left"},nt={class:"text-right"},it={class:"text-right"},dt={class:"text-right"},ct={class:"text-left"},ut={class:"text-left"},ht={class:"text-left"},mt={class:"text-right"},gt={class:"text-right"},ft={class:"text-right"},_t={class:"text-right table-footer"},bt={class:"text-right table-footer"},yt={key:0,class:"text-body1 text-center q-gutter-y-md text-weight-bold text-dark"};function St(t,d,y,r,w,f){const C=A("NumberFormat");return s(),h(j,{modelValue:r.RestaurantStore.modal_order_history,"onUpdate:modelValue":d[0]||(d[0]=e=>r.RestaurantStore.modal_order_history=e),onBeforeShow:f.getOrderHistory,maximized:!!this.$q.screen.lt.md,persistentx:"","full-height":!!t.$q.screen.gt.sm,"full-width":!!t.$q.screen.gt.sm,class:"bg-dark","transition-show":"fade","transition-hide":"fade"},{default:l(()=>[a(M,{class:"radius10 relative-position bg-darkmaroon text-white"},{default:l(()=>[a(Q,{class:"row items-center q-pb-none"},{default:l(()=>[o("div",{class:z(["text-weight-bold",{"text-h6":t.$q.screen.gt.sm,"text-body1":t.$q.screen.lt.md}])},n(t.$t("Order History")),3),a(p),t.$q.screen.gt.sm?(s(),i(c,{key:0},[a(_,{icon:"eva-refresh-outline",unelevated:"",label:t.$t("Refresh"),"no-caps":"",disable:!r.OrderStore.hasCart,color:"lightmaroon","text-color":"white",class:"text-weight-bold radius6 border-lightmaroon q-mr-md",size:t.$q.screen.gt.sm?"xl":"lg",dense:"",onClick:f.getOrderHistory},null,8,["label","disable","size","onClick"]),a(_,{icon:"fa-solid fa-wallet",unelevated:"",label:t.$t("Pay Bills"),"no-caps":"",disable:!r.OrderStore.hasCart,onClick:f.toPagePayment,color:"lightmaroon","text-color":"white",class:"text-weight-bold radius6 border-lightmaroon q-mr-md",size:t.$q.screen.gt.sm?"xl":"lg",dense:""},null,8,["label","disable","onClick","size"])],64)):m("",!0),U(a(_,{icon:"close",flat:"",round:"",dense:"","text-color":"secondary"},null,512),[[J]])]),_:1}),a(p,{class:"q-pa-sm"}),o("div",at,[a(Q,{class:z(["radius10 bg-coffee q-pa-sm",{"flex flex-center":!r.OrderStore.hasCart&&!r.OrderStore.cart_loading}]),style:{"min-height":"70vh"}},{default:l(()=>[a(G,{showing:r.OrderStore.cart_loading,color:"primary",size:"2rem"},null,8,["showing"]),r.OrderStore.hasCart&&!r.OrderStore.cart_loading?(s(),i(c,{key:0},[t.$q.screen.lt.md?(s(),i(c,{key:0},[a(B,{separator:""},{default:l(()=>[(s(!0),i(c,null,g(r.OrderStore.getCart.items,e=>(s(),h(P,{key:e},{default:l(()=>[a(b,{avatar:"",top:""},{default:l(()=>[a(q,null,{default:l(()=>[u(n(e.qty),1)]),_:2},1024)]),_:2},1024),a(b,{top:""},{default:l(()=>[a(k,{class:"text-secondary"},{default:l(()=>[u(n(e.item_name),1)]),_:2},1024),r.OrderStore.getKitchenStatus[e.cart_row]?(s(),h(k,{key:0},{default:l(()=>[a(q,{color:r.OrderStore.getItemStatus(r.OrderStore.getKitchenStatus[e.cart_row].item_status_raw),"text-color":r.OrderStore.getItemStatusText(r.OrderStore.getKitchenStatus[e.cart_row].item_status_raw)},{default:l(()=>[u(n(r.OrderStore.getKitchenStatus[e.cart_row].item_status),1)]),_:2},1032,["color","text-color"])]),_:2},1024)):m("",!0)]),_:2},1024),a(b,{side:""},{default:l(()=>[a(k,{class:"text-primary text-weight-bold",top:""},{default:l(()=>[a(C,{amount:e.price.price_after_discount*e.qty},null,8,["amount"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(Y),a(B,{dense:""},{default:l(()=>[(s(!0),i(c,null,g(r.OrderStore.getCart.summary,e=>(s(),h(P,{key:e},{default:l(()=>[a(b,{class:"text-secondary"},{default:l(()=>[u(n(e.name),1)]),_:2},1024),a(b,{side:"",class:"text-secondary text-weight-bold"},{default:l(()=>[u(n(e.value),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})],64)):(s(),h(et,{key:1,flat:""},{default:l(()=>[o("thead",ot,[o("tr",null,[o("th",st,n(t.$t("Status")),1),o("th",lt,n(t.$t("Item Name")),1),d[1]||(d[1]=o("th",{class:"text-right"},null,-1)),o("th",nt,n(t.$t("Quantity")),1),o("th",it,n(t.$t("Item Price")),1),o("th",dt,n(t.$t("Total")),1)])]),o("tbody",null,[(s(!0),i(c,null,g(r.OrderStore.getCart.items,e=>(s(),i("tr",{key:e},[o("td",ct,[r.OrderStore.getKitchenStatus[e.cart_row]?(s(),h(q,{key:0,color:r.OrderStore.getItemStatus(r.OrderStore.getKitchenStatus[e.cart_row].item_status_raw),"text-color":r.OrderStore.getItemStatusText(r.OrderStore.getKitchenStatus[e.cart_row].item_status_raw)},{default:l(()=>[u(n(r.OrderStore.getKitchenStatus[e.cart_row].item_status),1)]),_:2},1032,["color","text-color"])):m("",!0)]),o("td",ut,[a(X,{src:e.url_image,fit:"scale-down",loading:"lazy",style:{height:"60px",width:"60px"},"spinner-color":"primary","spinner-size":"sm"},null,8,["src"])]),o("td",ht,[o("div",null,n(e.item_name),1),o("div",null,[(s(!0),i(c,null,g(e.addons,O=>(s(),i(c,{key:O},[(s(!0),i(c,null,g(O.addon_items,(S,I)=>(s(),i(c,{key:S},[u(n(S.sub_item_name)+" (+"+n(S.pretty_addons_total)+") ",1),I<S.length-1?(s(),i(c,{key:0},[u(",")],64)):m("",!0)],64))),128))],64))),128))])]),o("td",mt,n(e.qty),1),o("td",gt,[e.price.discount<=0?(s(),i(c,{key:0},[u(n(e.price.pretty_price),1)],64)):(s(),i(c,{key:1},[u(n(e.price.pretty_price_after_discount),1)],64))]),o("td",ft,[a(C,{amount:e.price.price_after_discount*e.qty},null,8,["amount"])])]))),128))]),o("tfoot",null,[(s(!0),i(c,null,g(r.OrderStore.getCart.summary,e=>(s(),i("tr",{key:e},[d[2]||(d[2]=o("th",{class:"text-left"},null,-1)),d[3]||(d[3]=o("th",{class:"text-left"},null,-1)),d[4]||(d[4]=o("th",{class:"text-right"},null,-1)),d[5]||(d[5]=o("th",{class:"text-right"},null,-1)),o("th",_t,n(e.name),1),o("th",bt,n(e.value),1)]))),128))])]),_:1}))],64)):(s(),i(c,{key:1},[r.OrderStore.cart_loading?m("",!0):(s(),i("div",yt,[o("p",null,n(t.$t("Your don't have orders yet")),1)]))],64))]),_:1},8,["class"]),t.$q.screen.lt.md&&r.OrderStore.hasCart&&!r.OrderStore.cart_loading?(s(),i(c,{key:0},[a(p,{class:"q-pa-xl"}),a(p,{class:"q-pa-sm"}),a(Z,{position:"bottom",offset:[0,0],class:"bg-maroon q-pa-md q-gutter-y-sm",expand:""},{default:l(()=>[a(_,{unelevated:"",label:t.$t("Pay Bills"),"no-caps":"",disable:!r.OrderStore.hasCart,onClick:f.toPagePayment,color:"lightmaroon","text-color":"white",class:"text-weight-bold radius6 border-lightmaroon fit",size:t.$q.screen.gt.sm?"xl":"lg",dense:""},null,8,["label","disable","onClick","size"]),a(_,{icon:"eva-refresh-outline",unelevated:"",label:t.$t("Refresh"),"no-caps":"",disable:!r.OrderStore.hasCart,color:"lightmaroon","text-color":"white",class:"text-weight-bold radius6 border-lightmaroon fit",size:t.$q.screen.gt.sm?"xl":"lg",dense:"",onClick:f.getOrderHistory},null,8,["label","disable","size","onClick"])]),_:1})],64)):m("",!0)])]),_:1})]),_:1},8,["modelValue","onBeforeShow","maximized","full-height","full-width"])}var Bt=H(rt,[["render",St]]);export{Bt as default};
