import{Q as D}from"./QSpace.aa134d93.js";import{_ as Q,Q as R,R as z,V as h,n as o,p as _,q as r,f as a,ae as $,Z as d,F as q,af as g,X as l,a0 as f,Y as i,al as w,ai as v,ad as C,$ as k,b0 as B}from"./index.e99838a1.js";import{Q as y}from"./QItemSection.1392fb19.js";import{Q as x}from"./QItem.8eadf7d9.js";import{Q as P}from"./QList.8db9823b.js";import{C as S}from"./ClosePopup.05834fd1.js";const V={name:"CallStaffmenu",data(){return{modal:!1,items_call:[],loading_call:!1,loading_request:!1,request_add:!1}},setup(){const e=R(),s=z();return{RestaurantStore:e,DataPersisted:s}},computed:{hasData(){return Object.keys(this.DataPersisted.request_data).length>0}},methods:{beforeShow(){this.request_add=!1},addRequest(e,s){if(Object.keys(this.DataPersisted.request_data).length>0){const b=this.DataPersisted.request_data.findIndex(u=>u.request_item===e);console.log("index",b),b!==-1?this.DataPersisted.request_data[b].qty++:this.DataPersisted.request_data.push({request_item:e,qty:1})}else this.DataPersisted.request_data.push({request_item:e,qty:1});s&&(this.request_add=!1)},lessCartQty(e,s){e--,e<=0&&(console.log("delete"),this.DataPersisted.request_data.splice(s,1))},addCartQty(e,s){},callStaff(){this.loading_call=!0;const e=this.DataPersisted.cart_uuid;h.fetchDataPost("callStaff",{table_number:this.DataPersisted.table_number,cart_uuid:this.DataPersisted.cart_uuid,transaction_type:this.DataPersisted.transaction_type}).then(s=>{h.empty(e)&&(this.DataPersisted.cart_uuid=s.details.cart_uuid),h.notify(this.$q,this.$t("Notice"),s.msg,"mysuccess","done","bottom")}).catch(s=>{h.notify(this.$q,this.$t("Error"),s,"myerror","highlight_off","bottom")}).then(s=>{this.loading_call=!1})},sendRequest(){this.loading_request=!0;const e=this.DataPersisted.cart_uuid;h.fetchDataPost("callStaffRequest",{data:this.DataPersisted.request_data,table_number:this.DataPersisted.table_number,cart_uuid:this.DataPersisted.cart_uuid,transaction_type:this.DataPersisted.transaction_type}).then(s=>{h.empty(e)&&(this.DataPersisted.cart_uuid=s.details.cart_uuid),h.notify(this.$q,this.$t("Done"),s.msg,"mysuccess","done","bottom"),this.DataPersisted.request_data=[],this.RestaurantStore.modal_callstaff=!1}).catch(s=>{h.notify(this.$q,this.$t("Error"),s,"myerror","highlight_off","bottom")}).then(s=>{this.loading_request=!1})}}},I={class:"text-h6 text-weight-bold"},j={key:0,class:"row"},M={class:"col"},N={class:"scroll",style:{"min-height":"calc(60vh)"}},E={class:"quantity-input flex items-center justify-between full-width"},U={class:"col-2"},A={class:"row q-gutter-x-sm"},F={key:1},L={class:"text-body1 q-mb-sm"},O={class:"q-gutter-x-sm"},T={key:1,class:"row fit"},X={class:"col"},Y={class:"text-h6 text-weight-bold"},Z={class:"row"},G={class:"radius10 q-pa-sm flex flex-center bg-coffee",style:{height:"10em"}},H={class:"col-4"},J={class:"bg-coffee column radius10",style:{"min-height":"calc(75vh)"}},K={key:0,class:"scroll",style:{"min-height":"calc(60vh)"}},W={class:"quantity-input flex items-center justify-between full-width"},ee={key:1,class:"text-body1"},te={class:"col-2 q-pa-sm bg-coffee"},se={key:0,class:"row items-center q-gutter-x-sm"},ae={class:"col"},le={class:"col-4"};function oe(e,s,b,u,c,n){return o(),_(B,{modelValue:u.RestaurantStore.modal_callstaff,"onUpdate:modelValue":s[5]||(s[5]=t=>u.RestaurantStore.modal_callstaff=t),onBeforeShow:n.beforeShow,maximized:!!this.$q.screen.lt.md,persistentx:"","full-height":!!e.$q.screen.gt.sm,"full-width":!!e.$q.screen.gt.sm,class:"bg-dark","transition-show":"fade","transition-hide":"fade"},{default:r(()=>[a($,{class:"radius10 relative-position bg-darkmaroon text-white"},{default:r(()=>[e.$q.screen.lt.md?(o(),d(q,{key:0},[a(g,{class:"row items-center q-pb-none"},{default:r(()=>[l("div",I,f(e.$t("Call Staff Menu")),1),a(D),c.request_add?(o(),_(i,{key:0,icon:"close",onClick:s[0]||(s[0]=t=>c.request_add=!c.request_add),flat:"",round:"",dense:""})):w((o(),_(i,{key:1,icon:"close",flat:"",round:"",dense:""},null,512)),[[S]])]),_:1}),a(g,null,{default:r(()=>[c.request_add?(o(),d("div",j,[(o(!0),d(q,null,v(u.RestaurantStore.getStaffMenu,t=>(o(),d("div",{key:t,class:"col-md-3 col-sm-6 col-xs-6 q-pa-xs"},[l("div",{class:C(["radius10 q-pa-sm flex flex-center bg-coffee",{"min-height-10":e.$q.screen.gt.sm,"min-height-6":e.$q.screen.lt.md}])},[a(i,{"no-caps":"",class:"fit text-weight-regular text-body2 text-cream",unelevated:"",onClick:m=>n.addRequest(t,!0)},{default:r(()=>[k(f(t),1)]),_:2},1032,["onClick"])],2)]))),128))])):(o(),d("div",{key:1,class:C(["bg-coffee radius10 q-pl-sm q-pr-sm",{"flex flex-center text-center":!n.hasData,column:n.hasData}]),style:{"min-height":"calc(85vh)"}},[n.hasData?(o(),d(q,{key:0},[l("div",M,[l("div",N,[a(P,{separator:""},{default:r(()=>[(o(!0),d(q,null,v(u.DataPersisted.request_data,(t,m)=>(o(),_(x,{key:t,class:"q-pa-none"},{default:r(()=>[a(y,null,{default:r(()=>[k(f(t.request_item),1)]),_:2},1024),a(y,null,{default:r(()=>[l("div",E,[a(i,{dense:"",icon:t.qty==1?"delete_outline":"remove",color:t.qty==1?"cream":"primary","text-color":t.qty==1?"maroon":"white",onClick:p=>n.lessCartQty(t.qty>1?t.qty--:1,m),unelevated:""},null,8,["icon","color","text-color","onClick"]),l("span",null,f(t.qty),1),a(i,{dense:"",icon:"add",color:"primary",onClick:p=>n.addCartQty(t.qty++,m),unelevated:""},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128)),a(x,null,{default:r(()=>[a(y,null,{default:r(()=>[a(i,{label:e.$t("Add Request"),"no-caps":"",color:"primary",onClick:s[1]||(s[1]=t=>c.request_add=!c.request_add),size:e.$q.screen.gt.sm?"lg":"md",dense:""},null,8,["label","size"])]),_:1})]),_:1})]),_:1})])]),l("div",U,[l("div",A,[a(i,{label:e.$t("Send Request"),"no-caps":"",unelevated:"",onClick:n.sendRequest,loading:c.loading_request,color:"cream","text-color":"maroon",class:"text-weight-bold radius6 border-mmaroon col",size:"20px"},null,8,["label","onClick","loading"]),a(i,{label:e.$t("Clear"),"no-caps":"",unelevated:"",onClick:s[2]||(s[2]=t=>u.DataPersisted.request_data=[]),color:"lightmaroon","text-color":"white",class:"text-weight-bold radius6 border-lightmaroon col-4",size:"20px"},null,8,["label"])])])],64)):(o(),d("div",F,[l("div",L,f(e.$t("If you need to call staff, please press the call button"))+". ",1),l("div",O,[a(i,{label:e.$t("Request"),onClick:s[3]||(s[3]=t=>c.request_add=!c.request_add),"no-caps":"",unelevated:"",color:"cream","text-color":"maroon",class:"text-weight-bold radius6 border-mmaroon",size:e.$q.screen.gt.sm?"xl":"lg",dense:""},null,8,["label","size"]),a(i,{label:e.$t("Call staff"),"no-caps":"",unelevated:"",loading:c.loading_call,onClick:n.callStaff,color:"cream","text-color":"maroon",class:"text-weight-bold radius6 border-mmaroon",size:e.$q.screen.gt.sm?"xl":"lg",dense:""},null,8,["label","loading","onClick","size"])])]))],2))]),_:1})],64)):(o(),d("div",T,[l("div",X,[a(g,{class:"row items-center q-pb-none"},{default:r(()=>[l("div",Y,f(e.$t("Call Staff Menu")),1)]),_:1}),a(g,null,{default:r(()=>[l("div",Z,[(o(!0),d(q,null,v(u.RestaurantStore.getStaffMenu,t=>(o(),d("div",{key:t,class:"col-3 q-pa-sm"},[l("div",G,[a(i,{"no-caps":"",class:"fit text-weight-bold text-body1 text-cream",unelevated:"",onClick:m=>n.addRequest(t,!1)},{default:r(()=>[k(f(t),1)]),_:2},1032,["onClick"])])]))),128))])]),_:1})]),l("div",H,[a(g,{class:"row items-center q-pb-none"},{default:r(()=>[a(D),w(a(i,{icon:"close",flat:"",round:"",dense:""},null,512),[[S]])]),_:1}),a(g,null,{default:r(()=>[l("div",J,[l("div",{class:C(["col q-pa-sm",{"flex flex-center text-center":!n.hasData}])},[n.hasData?(o(),d("div",K,[a(P,{separator:""},{default:r(()=>[(o(!0),d(q,null,v(u.DataPersisted.request_data,(t,m)=>(o(),_(x,{key:t,class:"q-pa-none"},{default:r(()=>[a(y,null,{default:r(()=>[k(f(t.request_item),1)]),_:2},1024),a(y,null,{default:r(()=>[l("div",W,[a(i,{dense:"",icon:t.qty==1?"delete_outline":"remove",color:t.qty==1?"cream":"primary","text-color":t.qty==1?"maroon":"white",onClick:p=>n.lessCartQty(t.qty>1?t.qty--:1,m),unelevated:""},null,8,["icon","color","text-color","onClick"]),l("span",null,f(t.qty),1),a(i,{dense:"",icon:"add",color:"primary",onClick:p=>n.addCartQty(t.qty++,m),unelevated:""},null,8,["onClick"])])]),_:2},1024)]),_:2},1024))),128))]),_:1})])):(o(),d("div",ee,f(e.$t("If you need to call staff, please press the call button"))+". ",1))],2),l("div",te,[n.hasData?(o(),d("div",se,[l("div",ae,[a(i,{label:e.$t("Send Request"),"no-caps":"",unelevated:"",onClick:n.sendRequest,loading:c.loading_request,color:"cream","text-color":"maroon",class:"text-weight-bold radius6 fit border-mmaroon",size:e.$q.screen.gt.sm?"xl":"lg",dense:""},null,8,["label","onClick","loading","size"])]),l("div",le,[a(i,{label:e.$t("Clear"),"no-caps":"",unelevated:"",onClick:s[4]||(s[4]=t=>u.DataPersisted.request_data=[]),color:"lightmaroon","text-color":"white",class:"text-weight-bold radius6 border-lightmaroon",size:e.$q.screen.gt.sm?"xl":"lg",dense:""},null,8,["label","size"])])])):(o(),_(i,{key:1,label:e.$t("Call"),"no-caps":"",unelevated:"",loading:c.loading_call,onClick:n.callStaff,color:"cream","text-color":"maroon",class:"text-weight-bold radius6 fit border-mmaroon",size:e.$q.screen.gt.sm?"xl":"lg",dense:""},null,8,["label","loading","onClick","size"]))])])]),_:1})])]))]),_:1})]),_:1},8,["modelValue","onBeforeShow","maximized","full-height","full-width"])}var fe=Q(V,[["render",oe]]);export{fe as default};
