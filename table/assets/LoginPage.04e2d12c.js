import{v as B,r as D,y as E,a8 as R,a9 as z,o as A,h as I,z as L,g as T,a7 as _,aa as k,O,ab as j,ac as M,_ as N,R as U,V,n as H,Z as K,f as r,q as c,F as X,Y as C,X as h,ad as Q,a0 as Y,ae as Z,af as G,ag as F}from"./index.e99838a1.js";import{Q as J}from"./QToolbar.cd1cebda.js";import{Q as W}from"./QHeader.64134c48.js";import{Q as ee}from"./QPage.b16eab69.js";import"./QResizeObserver.09466951.js";var te=B({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:u,emit:f}){const p=T(),o=D(null);let l=0;const a=[];function b(t){const d=typeof t=="boolean"?t:e.noErrorFocus!==!0,g=++l,S=(s,n)=>{f(`validation${s===!0?"Success":"Error"}`,n)},w=s=>{const n=s.validate();return typeof n.then=="function"?n.then(i=>({valid:i,comp:s}),i=>({valid:!1,comp:s,err:i})):Promise.resolve({valid:n,comp:s})};return(e.greedy===!0?Promise.all(a.map(w)).then(s=>s.filter(n=>n.valid!==!0)):a.reduce((s,n)=>s.then(()=>w(n).then(i=>{if(i.valid===!1)return Promise.reject(i)})),Promise.resolve()).catch(s=>[s])).then(s=>{if(s===void 0||s.length===0)return g===l&&S(!0),!0;if(g===l){const{comp:n,err:i}=s[0];if(i!==void 0&&console.error(i),S(!1,n),d===!0){const P=s.find(({comp:x})=>typeof x.focus=="function"&&_(x.$)===!1);P!==void 0&&P.comp.focus()}}return!1})}function v(){l++,a.forEach(t=>{typeof t.resetValidation=="function"&&t.resetValidation()})}function y(t){t!==void 0&&k(t);const d=l+1;b().then(g=>{d===l&&g===!0&&(e.onSubmit!==void 0?f("submit",t):t!==void 0&&t.target!==void 0&&typeof t.target.submit=="function"&&t.target.submit())})}function q(t){t!==void 0&&k(t),f("reset"),O(()=>{v(),e.autofocus===!0&&e.noResetFocus!==!0&&m()})}function m(){j(()=>{if(o.value===null)return;const t=o.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(o.value.querySelectorAll("[tabindex]"),d=>d.tabIndex!==-1);t!=null&&t.focus({preventScroll:!0})})}E(M,{bindComponent(t){a.push(t)},unbindComponent(t){const d=a.indexOf(t);d!==-1&&a.splice(d,1)}});let $=!1;return R(()=>{$=!0}),z(()=>{$===!0&&e.autofocus===!0&&m()}),A(()=>{e.autofocus===!0&&m()}),Object.assign(p.proxy,{validate:b,resetValidation:v,submit:y,reset:q,focus:m,getValidationComponents:()=>a}),()=>I("form",{class:"q-form",ref:o,onSubmit:y,onReset:q},L(u.default))}});const ae={name:"LoginPage",data(){return{username:"",password:"",loading:!1}},setup(){return{DataPersisted:U()}},methods:{onReset(){this.username="",this.password=""},onSubmit(){this.loading=!0,V.fetchData("Login","username="+this.username+"&password="+this.password).then(e=>{this.DataPersisted.auth_token=e.details.user_token,this.DataPersisted.user_data=e.details.user_data,this.$router.replace("/settings")}).catch(e=>{V.notify(this.$q,this.$t("Error"),e,"myerror","highlight_off","bottom")}).then(e=>{this.loading=!1})}}},se={class:"text-center"},oe={class:"row"};function ne(e,u,f,p,o,l){return H(),K(X,null,[r(W,{class:"bg-darkmaroon text-white"},{default:c(()=>[r(J,null,{default:c(()=>[r(C,{onClick:u[0]||(u[0]=a=>e.$router.back()),dense:"",icon:"eva-arrow-ios-back-outline",unelevated:"",label:e.$t("Back"),"no-caps":"",size:e.$q.screen.gt.sm?"lg":"15px",flat:""},null,8,["label","size"])]),_:1})]),_:1}),r(ee,{padding:"",class:"flex flex-center bg-darkmaroon text-white"},{default:c(()=>[h("div",se,[h("div",{class:Q(["q-pa-md text-weight-bold",{"text-h5":e.$q.screen.gt.sm,"text-h6":e.$q.screen.lt.sm}])},Y(e.$t("Merchant Login")),3),h("div",{class:Q({"min-width-400":e.$q.screen.gt.sm,"full-width q-pa-md q-pr-md":e.$q.screen.lt.md})},[r(Z,{flat:"",class:"bg-lightmaroon"},{default:c(()=>[r(G,null,{default:c(()=>[r(te,{onSubmit:l.onSubmit,onReset:l.onReset,class:"q-gutter-md"},{default:c(()=>[r(F,{modelValue:o.username,"onUpdate:modelValue":u[1]||(u[1]=a=>o.username=a),label:e.$t("username"),"lazy-rules":"",rules:[a=>a&&a.length>0||this.$t("This is required")],color:"secondary","label-color":"secondary","no-error-icon":"","input-class":"myinput",dense:e.$q.screen.lt.md,class:"large-input","stack-label":""},null,8,["modelValue","label","rules","dense"]),r(F,{modelValue:o.password,"onUpdate:modelValue":u[2]||(u[2]=a=>o.password=a),label:e.$t("password"),type:"password","lazy-rules":"",rules:[a=>a&&a.length>0||this.$t("This is required")],color:"secondary","label-color":"secondary","no-error-icon":"",dense:e.$q.screen.lt.md,class:"large-input","stack-label":""},null,8,["modelValue","label","rules","dense"]),h("div",oe,[r(C,{label:e.$t("Submit"),type:"submit",color:"secondary","text-color":"primary",unelevated:"","no-caps":"",class:"col radius6 text-weight-bold",size:e.$q.screen.gt.sm?"xl":"lg",loading:o.loading,dense:""},null,8,["label","size","loading"])])]),_:1},8,["onSubmit","onReset"])]),_:1})]),_:1})],2)])]),_:1})],64)}var fe=N(ae,[["render",ne]]);export{fe as default};
