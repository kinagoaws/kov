"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[9546],{9546:(e,t,i)=>{i.r(t),i.d(t,{default:()=>M});var s=i(1758),a=i(8790);const l={class:"row justify-center q-pa-md"},o={class:"col-md-9 col-12"},n={class:"text-left"},r={class:"no-margin text-weight-bold q-pb-sm"},d={key:1,class:"no-margin text-weight-bold q-pb-sm"},u={class:"row q-col-gutter-md"},_={class:"q-mt-sm q-mb-sm"},c={key:0,class:"row q-gutter-sm"},m={key:1,class:"bg-deep-orange-1 q-pa-md"},h={class:"text-deep-orange-4"},b={class:"q-mt-lg"},g={class:"q-mt-sm"},v={class:"text-grey"},p={class:"row q-col-gutter-md"},k={key:0,class:"row q-col-gutter-md"},f={class:"text-grey q-mb-xs"},y={class:"text-grey q-mt-md q-mb-md"},w={key:1,class:"q-mt-sm q-mb-md"},x={key:2,class:"text-center"},q={key:0},S={key:1},V={class:"text-grey"},$={class:"text-grey"},F={class:"text-success"};function L(e,t,i,L,A,E){const C=(0,s.g2)("LocationNav"),T=(0,s.g2)("q-btn"),X=(0,s.g2)("q-select"),U=(0,s.g2)("q-input"),P=(0,s.g2)("q-inner-loading"),Q=(0,s.g2)("componentsRecaptcha"),R=(0,s.g2)("q-form"),z=(0,s.g2)("q-card-section"),j=(0,s.g2)("q-card"),B=(0,s.g2)("q-page");return(0,s.uX)(),(0,s.Wv)(B,{padding:""},{default:(0,s.k6)((()=>[(0,s.bF)(C),(0,s.Lk)("div",l,[(0,s.Lk)("div",o,[(0,s.Lk)("div",n,[E.isEdit?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.bF)(T,{flat:"",color:"warning",icon:"las la-angle-left",label:e.$t("Back to reservation"),"no-caps":"",dense:"",to:{name:"track-reservation",query:{id:this.reservation_uuid}}},null,8,["label","to"]),(0,s.Lk)("h4",r,(0,a.v_)(e.$t("Update Reservation")),1)],64)):((0,s.uX)(),(0,s.CE)("h4",d,(0,a.v_)(e.$t("Table reservations")),1))]),(0,s.bF)(j,{flat:""},{default:(0,s.k6)((()=>[(0,s.bF)(z,{id:"reservation_details"},{default:(0,s.k6)((()=>[1==A.steps?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("div",u,[(0,s.bF)(X,{modelValue:A.guest,"onUpdate:modelValue":[t[0]||(t[0]=e=>A.guest=e),E.getTimeslot],options:A.guest_list,label:e.$t("Guest"),dense:"",color:"warning",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":""},null,8,["modelValue","options","onUpdate:modelValue","label"]),(0,s.bF)(X,{modelValue:A.reservation_date,"onUpdate:modelValue":[t[1]||(t[1]=e=>A.reservation_date=e),E.getTimeslot],options:A.date_list,label:e.$t("Date"),dense:"",color:"warning",class:"q-mb-md col-xs-12 col-sm-12 col-md-4","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":""},null,8,["modelValue","options","onUpdate:modelValue","label"]),(0,s.bF)(U,{filled:"",class:"col-xs-12 col-sm-12 col-md-4",modelValue:A.reservation_time,"onUpdate:modelValue":t[2]||(t[2]=e=>A.reservation_time=e),label:e.$t("Time"),dense:"",disable:""},null,8,["modelValue","label"])]),(0,s.Lk)("div",_,[(0,s.bF)(P,{showing:A.loading,color:"warning"},null,8,["showing"]),E.hasTimeSlot?((0,s.uX)(),(0,s.CE)("div",c,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(A.time_slot,(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"col-2 text-center"},[(0,s.bF)(T,{unelevated:"",outline:!E.isSelected(t),color:E.isSelected(t)?"warning":E.isNotavailable(t)?"grey":"black",label:e,class:"full-width",onClick:e=>A.reservation_time=t,disabled:E.isNotavailable(t)},null,8,["outline","color","label","onClick","disabled"])])))),128))],64)))),128))])):((0,s.uX)(),(0,s.CE)("div",m,[(0,s.Lk)("span",h,(0,a.v_)(e.$t("We do not have any slots available for given criteria, please view the next available date")),1)]))]),(0,s.Lk)("div",b,[(0,s.bF)(T,{type:"submit",unelevated:"",color:"warning","text-color":"dark","no-caps":"",class:"full-width",label:e.$t("Continue"),size:"17px",rounded:"",disabled:!E.bookingValid,loading:A.loading,onClick:E.nextStep},null,8,["label","disabled","loading","onClick"])])],64)):2==A.steps?((0,s.uX)(),(0,s.Wv)(R,{key:1,onSubmit:E.onSubmit},{default:(0,s.k6)((()=>[(0,s.bF)(T,{flat:"",color:"warning",icon:"las la-angle-left",label:e.$t("Back"),"no-caps":"",dense:"",onClick:t[3]||(t[3]=e=>this.steps=1)},null,8,["label"]),(0,s.Lk)("h5",g,(0,a.v_)(e.$t("Reservation details")),1),(0,s.Lk)("div",v,[(0,s.Lk)("div",null,(0,a.v_)(A.reservation_info.full_time),1),(0,s.Lk)("div",null,(0,a.v_)(A.reservation_info.guest),1)]),(0,s.Lk)("h5",null,(0,a.v_)(e.$t("Personal details")),1),(0,s.Lk)("div",p,[(0,s.bF)(U,{"bg-color":"mygrey",color:"warning",outlined:"",modelValue:A.first_name,"onUpdate:modelValue":t[4]||(t[4]=e=>A.first_name=e),label:e.$t("First name"),"lazy-rules":"",rules:[t=>t&&t.length>0||e.$t("This field is required")],class:"col-xs-12 col-sm-12 col-md-6"},null,8,["modelValue","label","rules"]),(0,s.bF)(U,{"bg-color":"mygrey",color:"warning",outlined:"",modelValue:A.last_name,"onUpdate:modelValue":t[5]||(t[5]=e=>A.last_name=e),label:e.$t("Last name"),"lazy-rules":"",rules:[t=>t&&t.length>0||e.$t("This field is required")],class:"col-xs-12 col-sm-12 col-md-6"},null,8,["modelValue","label","rules"])]),(0,s.bF)(U,{"bg-color":"mygrey",color:"warning",outlined:"",modelValue:A.email_address,"onUpdate:modelValue":t[6]||(t[6]=e=>A.email_address=e),label:e.$t("Email address"),"lazy-rules":"",rules:[(t,i)=>i.email(t)||e.$t("Please enter a valid email address")]},null,8,["modelValue","label","rules"]),(0,s.bF)(U,{"bg-color":"mygrey",color:"warning",outlined:"",modelValue:A.mobile_number,"onUpdate:modelValue":t[7]||(t[7]=e=>A.mobile_number=e),label:e.$t("Mobile number"),prefix:A.mobile_prefix,mask:"##################",rules:[t=>t&&t.length>0||e.$t("This field is required"),t=>t.length<=15||e.$t("Please use maximum 15 characters")]},null,8,["modelValue","label","prefix","rules"]),A.allowed_choose_table?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.bF)(X,{modelValue:A.room_uuid,"onUpdate:modelValue":[t[8]||(t[8]=e=>A.room_uuid=e),t[9]||(t[9]=e=>A.table_uuid="")],options:A.room_list,label:e.$t("Room name"),color:"warning",class:"q-mb-md col-xs-12 col-sm-12 col-md-6","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":""},null,8,["modelValue","options","label"]),(0,s.bF)(X,{modelValue:A.table_uuid,"onUpdate:modelValue":t[10]||(t[10]=e=>A.table_uuid=e),options:e.table_list[A.room_uuid],label:e.$t("Table name"),color:"warning",class:"q-mb-md col-xs-12 col-sm-12 col-md-6","transition-show":"scale","transition-hide":"scale","emit-value":"","map-options":""},null,8,["modelValue","options","label"])])):(0,s.Q3)("",!0),(0,s.Lk)("div",f,(0,a.v_)(e.$t("Special requests")),1),(0,s.bF)(U,{modelValue:A.special_request,"onUpdate:modelValue":t[11]||(t[11]=e=>A.special_request=e),filled:"",type:"textarea",color:"warning"},null,8,["modelValue"]),(0,s.Lk)("p",y,(0,a.v_)(e.$t("By continuing, you agree to Terms of Service and Privacy Policy"))+". ",1),L.SettingsStore.loading_settings?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",w,[(0,s.bF)(Q,{ref:"recapcha",sitekey:L.SettingsStore.settings_data.captcha_site_key,is_enabled:!!L.SettingsStore.settings_data.captcha_enabled&&"1",language_code:L.SettingsStore.settings_data.captcha_lang,size:"normal",theme:"light",tabindex:0,onVerify:E.recaptchaVerified,onExpire:E.recaptchaExpired,onFail:E.recaptchaFailed},null,8,["sitekey","is_enabled","language_code","onVerify","onExpire","onFail"])])),(0,s.bF)(T,{type:"submit",unelevated:"",color:"warning","text-color":"dark","no-caps":"",class:"full-width",label:e.$t("Reserve"),size:"17px",rounded:"",disabled:!E.reservationValid,loading:A.submit_loading},null,8,["label","disabled","loading"])])),_:1},8,["onSubmit"])):3==A.steps?((0,s.uX)(),(0,s.CE)("div",x,[t[13]||(t[13]=(0,s.Lk)("svg",{class:"checkmark",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 52 52"},[(0,s.Lk)("circle",{class:"checkmark__circle",cx:"26",cy:"26",r:"25",fill:"none"}),(0,s.Lk)("path",{class:"checkmark__check",fill:"none",d:"M14.1 27.2l7.1 7.2 16.7-16.8"})],-1)),E.isEdit?((0,s.uX)(),(0,s.CE)("h4",q,(0,a.v_)(e.$t("Your reservation succesfully updated"))+".",1)):((0,s.uX)(),(0,s.CE)("h4",S,(0,a.v_)(e.$t("Your reservation successfully placed"))+".",1)),(0,s.Lk)("p",V,(0,a.v_)(e.$t("You will receive another email once your reservation is confirm"))+". ",1),(0,s.Lk)("h5",null,(0,a.v_)(A.success_data.full_time),1),(0,s.Lk)("div",$,[(0,s.Lk)("div",null,(0,a.v_)(A.success_data.guest),1),(0,s.Lk)("div",null,[(0,s.eW)((0,a.v_)(e.$t("Reservation ID"))+"# ",1),(0,s.Lk)("span",F,(0,a.v_)(A.success_data.reservation_id),1)])]),(0,s.Lk)("div",{class:(0,a.C4)(["row inline q-gutter-md q-mt-lg",{column:e.$q.screen.lt.sm}])},[E.isEdit?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.Wv)(T,{key:0,unelevated:"",color:"warning","text-color":"white","no-caps":"",label:e.$t("Reserved table again"),size:"17px",rounded:"",onClick:t[12]||(t[12]=e=>E.resetReservation())},null,8,["label"])),(0,s.bF)(T,{outline:"",unelevated:"",color:"white","text-color":"grey","no-caps":"",label:e.$t("Track your reservation"),size:"17px",rounded:"",to:{name:"track-reservation",query:{id:A.success_data.reservation_uuid}}},null,8,["label","to"])],2)])):(0,s.Q3)("",!0)])),_:1})])),_:1})])])])),_:1})}i(7781),i(9526);var A=i(2911),E=i(2302),C=i(8336),T=i(9818);const{getScrollTarget:X,setVerticalScrollPosition:U,getVerticalScrollPosition:P}=C.Ay,Q={name:"TableReservation",components:{LocationNav:(0,s.$V)((()=>Promise.all([i.e(4121),i.e(996),i.e(7691)]).then(i.bind(i,5897)))),componentsRecaptcha:(0,s.$V)((()=>i.e(3281).then(i.bind(i,3281))))},data(){return{loading:!0,data:[],loaded:!0,steps:1,guest_list:[],guest:1,reservation_date:"",reservation_time:"",reservation_time_pretty:"",time_slot:[],new_time_slot:[],date_list:[],all_time_slot:[],tc:"",first_name:"",last_name:"",email_address:"",special_request:"",mobile_prefix:"",mobile_number:"",loading:!1,loading_time_slot:!1,submit_loading:!1,next_step_loading:!1,reservation_info:[],success_data:[],recaptcha_response:"",not_available_time:[],track_reservation_link:"",data_booking:[],details_link:"",allowed_choose_table:!1,room_list:[],room_uuid:"",table_uuid:"",reservation_uuid:""}},setup(){const e=(0,E.C)();return{SettingsStore:e}},async created(){if(this.reservation_uuid=A.A.empty(this.$route.query.id)?"":this.$route.query.id,T.A.authenticated()){let e=T.A.getUser();this.first_name=e.first_name,this.last_name=e.last_name,this.email_address=e.email_address,this.mobile_number=e.contact_number}},mounted(){Object.keys(this.SettingsStore.settings_data).length>0?this.getSettings():this.$watch((()=>this.SettingsStore.$state.settings_data),((e,t)=>{this.getSettings()}))},computed:{hasTimeSlot(){return Object.keys(this.all_time_slot).length>0},bookingValid(){let e=!0;return this.guest<=0&&(e=!1),A.A.empty(this.reservation_date)&&(e=!1),A.A.empty(this.reservation_time)&&(e=!1),e},reservationValid(){let e=!0;return A.A.empty(this.first_name)&&(e=!1),A.A.empty(this.last_name)&&(e=!1),A.A.empty(this.mobile_number)&&(e=!1),e},isEdit(){return!A.A.empty(this.reservation_uuid)}},methods:{async getSettings(){const e=await this.SettingsStore.getAsyncSettings();e.booking_enabled?(this.Getbookingattributes(),this.mobile_prefix=e.phone_data.phonecode):this.$router.push("/home")},isSelected(e){return this.reservation_time==e},Getbookingattributes(){this.loaded=!0,this.loading=!0,A.A.fetchDataPostTable("Getbookingattributes","merchant_uuid="+this.SettingsStore.merchant_uuid+"&id="+this.reservation_uuid).then((e=>{this.guest_list=e.details.guest_list,this.date_list=e.details.date_list,this.time_slot=e.details.time_slot,this.all_time_slot=e.details.all_time_slot,this.reservation_date=e.details.default_date,this.tc=e.details.tc,this.allowed_choose_table=e.details.allowed_choose_table,this.room_list=e.details.room_list,Object.keys(this.time_slot).length>0&&Object.entries(this.time_slot).forEach((([e,t])=>{Object.entries(t).forEach((([e,t])=>{this.new_time_slot.push({label:t,value:e})}))})),this.not_available_time=e.details.not_available_time,this.guest=e.details.default_guest,this.data_booking=e.details.data_booking,this.details_link=e.details.details_link,A.A.empty(this.reservation_uuid)||(this.guest=e.details.data_booking.guest_number_raw,this.reservation_time=e.details.data_booking.reservation_time_raw,this.first_name=e.details.data_booking.first_name,this.last_name=e.details.data_booking.last_name,this.email_address=e.details.data_booking.email_address,this.special_request=e.details.data_booking.special_request,this.mobile_prefix=e.details.data_booking.phone_prefix,this.mobile_number=e.details.data_booking.contact_phone_without_prefix)})).catch((e=>{this.guest_list=[],this.date_list=[],this.time_slot=[],this.all_time_slot=[],this.reservation_date="",this.tc="",this.not_available_time=[],this.data_booking=[],this.allowed_choose_table=[],this.room_list=[],this.room_uuid="",this.table_uuid=""})).then((e=>{this.loading=!1}))},getTimeslot(){this.loading_time_slot=!0,this.reservation_time="";let e="merchant_uuid="+this.SettingsStore.merchant_uuid;e+="&reservation_date="+this.reservation_date,e+="&guest="+this.guest,e+="&id="+this.reservation_uuid,console.log(e),A.A.fetchDataPostTable("Gettimeslot",e).then((e=>{this.time_slot=e.details.time_slot,this.all_time_slot=e.details.all_time_slot,this.not_available_time=e.details.not_available_time})).catch((e=>{this.time_slot=[],this.all_time_slot=[],this.not_available_time=[]})).then((e=>{this.loading_time_slot=!1}))},isNotavailable(e){return Object.keys(this.not_available_time).length>0&&!0===this.not_available_time.includes(e)},nextStep(){this.next_step_loading=!0;let e="merchant_uuid="+this.SettingsStore.merchant_uuid;e+="&reservation_date="+this.reservation_date,e+="&reservation_time="+this.reservation_time,e+="&guest="+this.guest,e+="&id="+this.reservation_uuid,console.log(e),A.A.fetchDataPostTableToken("SetBooking",e).then((e=>{this.steps=2,this.reservation_info=e.details,this.table_list=e.details.table_list,A.A.empty(this.reservation_uuid)?(this.room_uuid="",this.table_uuid=""):(this.room_uuid=e.details.room_uuid,this.table_uuid=e.details.table_uuid)})).catch((e=>{this.reservation_info=[],this.table_list=[],A.A.notify("negative",e,"error_outline",this.$q)})).then((e=>{this.next_step_loading=!1}))},onSubmit(){this.submit_loading=!0;let e="merchant_uuid="+this.SettingsStore.merchant_uuid;e+="&reservation_date="+this.reservation_date,e+="&reservation_time="+this.reservation_time,e+="&guest="+this.guest,e+="&first_name="+this.first_name,e+="&last_name="+this.last_name,e+="&email_address="+this.email_address,e+="&mobile_prefix="+this.mobile_prefix,e+="&mobile_number="+this.mobile_number,e+="&room_uuid="+this.room_uuid,e+="&table_uuid="+this.table_uuid,e+="&special_request="+this.special_request,e+="&recaptcha_response="+this.recaptcha_response,e+="&id="+this.reservation_uuid,e+="&request_from=single_app",A.A.fetchDataPostTableToken("ReserveTable",e).then((e=>{this.steps=3,this.success_data=e.details,this.room_uuid="",this.table_uuid="",this.scrollToElement("reservation_details")})).catch((e=>{this.success_data=[],A.A.notify("negative",e,"error_outline",this.$q)})).then((e=>{this.submit_loading=!1}))},resetReservation(){this.steps=1,this.Getbookingattributes(),this.guest=1,this.reservation_date="",this.reservation_time=""},scrollToElement(e){const t=document.getElementById(e);console.log(t);const i=X(t),s=t.offsetTop,a=500;U(i,s,a)},recaptchaVerified(e){this.recaptcha_response=e},recaptchaExpired(){"1"==this.settings.merchant_captcha_enabled&&this.$refs.recapcha.reset()},recaptchaFailed(){}}};var R=i(2807),z=i(7716),j=i(6384),B=i(3316),D=i(4189),G=i(2606),I=i(9270),O=i(9035),K=i(9200),N=i(8582),W=i.n(N);const Y=(0,R.A)(Q,[["render",L]]),M=Y;W()(Q,"components",{QPage:z.A,QBtn:j.A,QCard:B.A,QCardSection:D.A,QSelect:G.A,QInput:I.A,QInnerLoading:O.A,QForm:K.A})}}]);