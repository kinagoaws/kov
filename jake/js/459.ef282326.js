"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[459],{459:(e,t,a)=>{a.r(t),a.d(t,{default:()=>u});var s=a(1758),o=a(8790);const i={class:"col"},n={class:"col"};function r(e,t,a,r,l,c){const p=(0,s.g2)("q-btn");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",{ref:"cmaps",class:(0,o.C4)(["bg-grey-1",a.class_map])},null,2),(0,s.Lk)("div",{class:(0,o.C4)(["absolute-bottom-right",{"q-ma-md":!this.$q.screen.lt.md,"q-ma-sm":this.$q.screen.lt.md}]),style:{"z-index":"99"}},[(0,s.Lk)("div",{class:(0,o.C4)(["column",{"q-gutter-y-md":!this.$q.screen.lt.md,"q-gutter-y-sm":this.$q.screen.lt.md}])},[(0,s.Lk)("div",i,[(0,s.bF)(p,{unelevated:"",color:"warning",icon:"add",dense:"",onClick:c.setPlusZoom},null,8,["onClick"])]),(0,s.Lk)("div",n,[(0,s.bF)(p,{unelevated:"",color:"warning",icon:"remove",dense:"",onClick:c.setLessZoom},null,8,["onClick"])])],2)],2)],64)}a(7781),a(9526);var l=a(781);const c=[];let p=[];const m={name:"Maps",props:["keys","lat","lng","provider","zoom","marker","detect_location","class_map"],data(){return{cmaps:void 0,data:[],loading:!1}},mounted(){this.loadMap()},watch:{marker(e,t){this.renderMap()},provider(e,t){this.loadMap()}},methods:{loadMap(){try{switch(this.provider){case"google.maps":(0,l.k0)("https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=places&key="+this.keys).then((()=>{this.renderMap()})).catch((()=>{console.debug("failed loading map script")}));break;case"mapbox":(0,l.k0)("https://api.mapbox.com/mapbox-gl-js/v2.11.0/mapbox-gl.js").then((()=>{this.renderMap()})).catch((()=>{console.debug("failed loading map script")}));break;default:console.debug("no provider");break}}catch(e){console.error(e)}},renderMap(){try{switch(this.provider){case"google.maps":p=new window.google.maps.LatLngBounds,"undefined"!==typeof this.cmaps&&null!==this.cmaps?Object.entries(this.marker).forEach((([e,t])=>{this.removeMarker(t.id)})):this.cmaps=new window.google.maps.Map(this.$refs.cmaps,{center:{lat:parseFloat(this.lat),lng:parseFloat(this.lng)},zoom:parseInt(this.zoom),disableDefaultUI:!0}),Object.entries(this.marker).forEach((([e,t])=>{this.addMarker({position:{lat:parseFloat(t.lat),lng:parseFloat(t.lng)},map:this.cmaps,animation:window.google.maps.Animation.DROP,draggable:t.draggable,icon:t.icon},t.id,t.draggable)})),Object.keys(this.marker).length>1?this.FitBounds():this.setCenter(this.marker[0].lat,this.marker[0].lng);break;case"mapbox":mapboxgl.accessToken=this.keys,p=new mapboxgl.LngLatBounds,this.cmaps=new mapboxgl.Map({container:this.$refs.cmaps,style:"mapbox://styles/mapbox/streets-v12",center:[parseFloat(this.lng),parseFloat(this.lat)],zoom:14}),Object.entries(this.marker).forEach((([e,t])=>{this.addMarker({position:{lat:parseFloat(t.lat),lng:parseFloat(t.lng)},map:this.cmaps,animation:null,draggable:t.draggable,icon:t.icon},t.id,t.draggable)})),Object.keys(this.marker).length>1?this.FitBounds():this.setCenter(this.marker[0].lat,this.marker[0].lng);break}}catch(e){}},addMarker(e,t,a){try{switch(this.provider){case"google.maps":c[t]=new window.google.maps.Marker(e),this.cmaps.panTo(new window.google.maps.LatLng(e.position.lat,e.position.lng)),p.extend(c[t].position),!0===a&&(window.google.maps.event.addListener(c[t],"drag",(e=>{this.$emit("dragMarker",!0)})),window.google.maps.event.addListener(c[t],"dragend",(e=>{const t=e.latLng;this.$emit("afterSelectmap",t.lat(),t.lng())})),window.google.maps.event.addListener(this.cmaps,"drag",(e=>{let a=new google.maps.LatLng(this.cmaps.getCenter().lat(),this.cmaps.getCenter().lng());c[t].setPosition(a)})),google.maps.event.addListener(this.cmaps,"dragend",(e=>{let t=new google.maps.LatLng(this.cmaps.getCenter().lat(),this.cmaps.getCenter().lng());this.$emit("afterSelectmap",t.lat(),t.lng())})));break;case"mapbox":c[t]=new mapboxgl.Marker(e).setLngLat([e.position.lng,e.position.lat]).addTo(this.cmaps),p.extend(new mapboxgl.LngLat(e.position.lng,e.position.lat)),!0===a&&(c[t].on("dragend",(e=>{const a=c[t].getLngLat();this.$emit("afterSelectmap",a.lat,a.lng)})),this.cmaps.on("drag",(()=>{c[t].setLngLat([this.cmaps.getCenter().lng.toFixed(4),this.cmaps.getCenter().lat.toFixed(4)])})),this.cmaps.on("dragend",(()=>{c[t].setLngLat([this.cmaps.getCenter().lng.toFixed(4),this.cmaps.getCenter().lat.toFixed(4)]),this.$emit("afterSelectmap",this.cmaps.getCenter().lat.toFixed(4),this.cmaps.getCenter().lng.toFixed(4))}))),this.mapBoxResize();break}}catch(e){console.error(e)}},mapBoxResize(){"mapbox"==this.provider&&setTimeout((()=>{this.cmaps.resize()}),800)},updateMarker(e,t,a){try{setTimeout((()=>{const s=new window.google.maps.LatLng(t,a);"undefined"!==typeof c[e]&&null!==c[e]&&(c[e].setPosition(s),this.cmaps.panTo(s))}),10)}catch(e){console.error(e)}},removeMarker(e){try{switch(this.provider){case"google.maps":"undefined"!==typeof c[e]&&null!==c[e]&&(c[e].setMap(null),c.splice(e,1));break}}catch(e){console.error(e)}},setCenter(e,t){try{switch(this.provider){case"google.maps":this.cmaps.setCenter(new window.google.maps.LatLng(e,t));break;case"mapbox":this.cmaps.flyTo({center:[t,e],essential:!0});break}}catch(e){console.error(e)}},FitBounds(){try{switch(this.provider){case"google.maps":this.cmaps.fitBounds(p);break;case"mapbox":this.cmaps.fitBounds(p,{duration:0,padding:50});break}}catch(e){console.error(e)}},setPlusZoom(){this.cmaps.setZoom(this.cmaps.getZoom()+2)},setLessZoom(){this.cmaps.setZoom(this.cmaps.getZoom()-2)}}};var g=a(2807),d=a(6384),h=a(8582),k=a.n(h);const b=(0,g.A)(m,[["render",r]]),u=b;k()(m,"components",{QBtn:d.A})}}]);