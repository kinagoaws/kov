"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[837],{837:(e,r,t)=>{t.r(r),t.d(r,{default:()=>ie});var o=t(1758),i=t(8790);const n={class:"row justify-center q-pa-md"},s={class:"col-md-9 col-12"},a={class:"row"},d={class:"col-xs-12 col-sm-6 col-md-4 q-pr-md q-mb-xs-md"},l={class:"text-weight-bold"},c={class:"no-margin font11"},_={class:"row"},u={class:"col-3"},g={class:"col"},m={class:"no-margin text-weight-medium"},p={class:"font11 ellipsis-2-lines"},h={key:0},f={key:1},v={class:"text-weight-bold q-mt-xs"},k={class:"font11 q-mb-xs"},b={class:"text-weight-bold q-mt-xs"},w={class:"font12 q-mb-xs"},y={class:"flex justify-between items-center q-mt-xs"},q={class:"text-h5 text-weight-bold"},F={class:"font12 q-mb-xs text-weight-bold"},x={class:"font12 q-mb-xs text-weight-bold"},A={class:"font11 q-mb-xs"},C={key:5},L={class:"text-weight-bold"},Q={class:"font12 q-mb-xs text-weight-medium"},$={class:"col-xs-12 col-sm-6 col-md-8 relative-position"},E={class:"text-h5 text-weight-bold"};function X(e,r,t,X,O,S){const R=(0,o.g2)("TrackOrderSkeleton"),V=(0,o.g2)("q-linear-progress"),z=(0,o.g2)("q-step"),W=(0,o.g2)("q-stepper"),K=(0,o.g2)("q-img"),U=(0,o.g2)("q-avatar"),D=(0,o.g2)("q-badge"),P=(0,o.g2)("q-btn"),T=(0,o.g2)("q-separator"),I=(0,o.g2)("Maps"),M=(0,o.g2)("q-inner-loading"),B=(0,o.g2)("q-card"),N=(0,o.g2)("q-space"),H=(0,o.g2)("q-card-section"),j=(0,o.g2)("WriteReview"),G=(0,o.g2)("q-dialog"),J=(0,o.g2)("ComponentsRealtime"),Y=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("div",n,[(0,o.Lk)("div",s,[O.loading?((0,o.uX)(),(0,o.Wv)(R,{key:0})):((0,o.uX)(),(0,o.Wv)(B,{key:1,flat:"",class:"q-pa-md"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",a,[(0,o.Lk)("div",d,[(0,o.Lk)("h5",l,(0,i.v_)(O.order_status),1),(0,o.Lk)("p",c,(0,i.v_)(O.order_status_details),1),"delivery"==O.order_info.order_type?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[O.order_progress>0?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[O.order_progress<=3?((0,o.uX)(),(0,o.Wv)(V,{key:0,indeterminate:"",color:"warning",class:"q-mt-sm"})):(0,o.Q3)("",!0)],64)):(0,o.Q3)("",!0),(0,o.bF)(W,{modelValue:O.order_progress,"onUpdate:modelValue":r[0]||(r[0]=e=>O.order_progress=e),ref:"stepper",color:"primary",animated:"",flat:"",class:"no-padding tracking-steps"},{default:(0,o.k6)((()=>[(0,o.bF)(z,{name:1,title:"",icon:"east","active-icon":"east","done-icon":"east","active-color":"warning","done-color":O.order_progress>1?"warning":"negative",done:O.order_progress>1||O.order_progress<=0},null,8,["done-color","done"]),(0,o.bF)(z,{name:2,title:"",icon:"local_dining","active-icon":"local_dining","done-icon":"local_dining","active-color":"warning","done-color":O.order_progress>1?"warning":"negative",done:O.order_progress>2||O.order_progress<=0},null,8,["done-color","done"]),(0,o.bF)(z,{name:3,title:"",icon:"drive_eta","active-icon":"drive_eta","done-icon":"drive_eta","active-color":"warning","done-color":O.order_progress>1?"warning":"negative",done:O.order_progress>3||O.order_progress<=0},null,8,["done-color","done"]),(0,o.bF)(z,{name:4,title:"",icon:"home","active-icon":"home","done-icon":"check_circle","active-color":"warning","done-color":O.order_progress>1?"warning":"negative",done:O.order_progress>=4||O.order_progress<=0},null,8,["done-color","done"])])),_:1},8,["modelValue"])],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[O.order_progress>0?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[O.order_progress<=2?((0,o.uX)(),(0,o.Wv)(V,{key:0,indeterminate:"",color:"warning",class:"q-mt-sm"})):(0,o.Q3)("",!0)],64)):(0,o.Q3)("",!0),(0,o.bF)(W,{modelValue:O.order_progress,"onUpdate:modelValue":r[1]||(r[1]=e=>O.order_progress=e),ref:"stepper",color:"primary",animated:"",flat:"",class:"no-padding tracking-steps"},{default:(0,o.k6)((()=>[(0,o.bF)(z,{name:1,title:"",icon:"east","active-icon":"east","done-icon":"east","active-color":"warning","done-color":O.order_progress>1?"warning":"negative",done:O.order_progress>1||O.order_progress<=0},null,8,["done-color","done"]),(0,o.bF)(z,{name:2,title:"",icon:"local_dining","active-icon":"local_dining","done-icon":"local_dining","active-color":"warning","done-color":O.order_progress>1?"warning":"negative",done:O.order_progress>2||O.order_progress<=0},null,8,["done-color","done"]),(0,o.bF)(z,{name:3,title:"",icon:"shopping_basket","active-icon":"shopping_basket","done-icon":"check_circle","active-color":"warning","done-color":O.order_progress>1?"warning":"negative",done:O.order_progress>=3||O.order_progress<=0},null,8,["done-color","done"])])),_:1},8,["modelValue"])],64)),(0,o.Lk)("div",_,[(0,o.Lk)("div",u,[(0,o.bF)(U,null,{default:(0,o.k6)((()=>[(0,o.bF)(K,{src:O.merchant_info.url_logo,fit:e.contain,style:{height:"50px","max-width":"50px"},class:"no-margin",loading:"lazy"},null,8,["src","fit"])])),_:1})]),(0,o.Lk)("div",g,[(0,o.Lk)("h5",m,(0,i.v_)(O.merchant_info.restaurant_name),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(O.merchant_info.cuisine,((e,r)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:e.cuisine_name},[r<=0?((0,o.uX)(),(0,o.Wv)(D,{key:0,label:e.cuisine_name,style:(0,i.Tr)(`background-color:${e.bgcolor};color:${e.fncolor};`),class:"font11"},null,8,["label","style"])):(0,o.Q3)("",!0)],64)))),128)),(0,o.Lk)("p",p,(0,i.v_)(O.merchant_info.merchant_address),1),"pickup"==O.order_info.order_type?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(P,{href:"tel:"+O.merchant_info.contact_phone,round:"",color:"positive",icon:"call",dense:"",size:"12px",outline:"",class:"q-mr-sm"},null,8,["href"]),(0,o.bF)(P,{href:O.merchant_info.restaurant_direction,target:"_blank",round:"",color:"positive",icon:"directions",dense:"",size:"12px",outline:""},null,8,["href"])])):"dinein"==O.order_info.order_type?((0,o.uX)(),(0,o.CE)("div",f,[(0,o.bF)(P,{href:"tel:"+O.merchant_info.contact_phone,round:"",color:"positive",icon:"call",dense:"",size:"12px",outline:"",class:"q-mr-sm"},null,8,["href"]),(0,o.bF)(P,{href:O.merchant_info.restaurant_direction,target:"_blank",round:"",color:"positive",icon:"directions",dense:"",size:"12px",outline:""},null,8,["href"])])):(0,o.Q3)("",!0)])]),4===O.order_progress?((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[(0,o.Lk)("h5",v,(0,i.v_)(e.$t("HOWS WAS YOUR ORDER"))+"?",1),(0,o.Lk)("p",k,(0,i.v_)(e.$t("let us know how your delivery wen and how you liked your order"))+"! ",1),(0,o.bF)(P,{flat:"",color:"warning",label:"Rate your order",dense:"","no-caps":"",onClick:r[2]||(r[2]=e=>O.modal_review=!0)})],64)):(0,o.Q3)("",!0),e.hasInstructions?((0,o.uX)(),(0,o.CE)(o.FK,{key:3},[(0,o.Lk)("h5",b,(0,i.v_)(e.$t("UPON ARRIVAL")),1),(0,o.Lk)("p",w,(0,i.v_)(O.instructions.text),1)],64)):(0,o.Q3)("",!0),(0,o.bF)(T,{class:"q-mb-md q-mt-sm"}),(0,o.Lk)("div",y,[(0,o.Lk)("div",q,(0,i.v_)(O.merchant_info.restaurant_name),1),(0,o.Lk)("div",null,[(0,o.bF)(P,{round:"",color:"amber-5",icon:"chat",size:"sm",unelevated:"",onClick:S.createChat,loading:O.loading_chat},null,8,["onClick","loading"])])]),(0,o.Lk)("p",F,(0,i.v_)(e.$t("Order"))+" #"+(0,i.v_)(O.order_info.order_id),1),(0,o.Lk)("p",x,(0,i.v_)(O.items_count)+" "+(0,i.v_)(e.$t("items")),1),(0,o.Lk)("p",A,(0,i.v_)(O.order_info.sub_total)+" "+(0,i.v_)(e.$t("Subtotal")),1),O.items.length>0?((0,o.uX)(!0),(0,o.CE)(o.FK,{key:4},(0,o.pI)(O.items,(e=>((0,o.uX)(),(0,o.CE)("p",{key:e.item_name,class:"font11 q-mb-xs"},[(0,o.eW)((0,i.v_)(e.qty)+"x "+(0,i.v_)(e.item_name)+" ",1),""!=e.size_name?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)(" ("+(0,i.v_)(e.size_name)+") ",1)],64)):(0,o.Q3)("",!0)])))),128)):(0,o.Q3)("",!0),"delivery"==O.order_info.order_type?((0,o.uX)(),(0,o.CE)("div",C,[(0,o.bF)(T,{class:"q-mb-md q-mt-md"}),(0,o.Lk)("h5",L,(0,i.v_)(e.$t("Delivery Address")),1),(0,o.Lk)("p",Q,(0,i.v_)(O.meta.formatted_address),1)])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",$,[(0,o.bF)(I,{ref:"maps",lat:O.merchant_info.latitude,lng:O.merchant_info.longitude,default_lat:O.merchant_info.latitude,default_lng:O.merchant_info.longitud,zoom:O.maps_config.zoom,keys:O.maps_config.key,class_map:"maps fit",provider:O.maps_config.provider,detect_location:!1,marker:O.marker,onAfterSelectmap:e.afterSelectmap,onDragMarker:e.dragMarker,onShowLoader:e.showLoader},null,8,["lat","lng","default_lat","default_lng","zoom","keys","provider","marker","onAfterSelectmap","onDragMarker","onShowLoader"]),(0,o.bF)(M,{showing:e.loading_map,color:"warning","label-class":"text-dark","label-style":"font-size: 11px"},null,8,["showing"])])])])),_:1}))])]),(0,o.bF)(G,{modelValue:O.modal_review,"onUpdate:modelValue":r[3]||(r[3]=e=>O.modal_review=e),persistent:"",position:this.$q.screen.lt.md?"bottom":"standard"},{default:(0,o.k6)((()=>[(0,o.bF)(B,{class:(0,i.C4)({"card-medium-width1":!this.$q.screen.lt.md})},{default:(0,o.k6)((()=>[(0,o.bF)(H,{class:"row items-center q-pb-none"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",E,(0,i.v_)(e.$t("Write A Review")),1),(0,o.bF)(N),(0,o.bo)((0,o.bF)(P,{icon:"close",flat:"",round:"",dense:""},null,512),[[Y]])])),_:1}),(0,o.bF)(j,{ref:"review",order_uuid:O.order_uuid,initital_rate:0,onAfterAddreview:S.afterAddreview},null,8,["order_uuid","onAfterAddreview"])])),_:1},8,["class"])])),_:1},8,["modelValue","position"]),(0,o.bF)(J,{ref:"realtime",getevent:"tracking",onAfterReceive:S.afterReceive},null,8,["onAfterReceive"])],64)}var O=t(2911),S=(t(7781),t(9526),t(8815)),R=t(546);const V={async createChatOrder(e,r,t,o){let i=new Promise((async function(i,n){try{const n={lastUpdated:(0,R.O5)(),dateCreated:(0,R.O5)(),orderID:e,orderUuid:r,participants:[t,o],isTyping:{[`${t}`]:!1,[`${o}`]:!1}};await(0,R.BN)((0,R.H9)(S.firebaseDb,S.firebaseCollectionEnum.chats,r),n),i(r)}catch(e){n(e)}}));return await i},async createChat(e,r){let t=new Promise((async function(t,o){try{const i=(0,R.rJ)(S.firebaseDb,S.firebaseCollectionEnum.chats),n=(0,R.P)(i,(0,R._M)("participants","array-contains",r),(0,R.My)("lastUpdated","desc"),(0,R.AB)(1));let s="";const a=await(0,R.GG)(n);if(a.forEach((r=>{let t=r.data(),o=t.participants||null;!0===o.includes(e)&&(s=r.id)})),O.A.empty(s)){const i=await(0,R.gS)((0,R.rJ)(S.firebaseDb,S.firebaseCollectionEnum.chats),{lastUpdated:(0,R.O5)()}),n=i.id,s=(0,R.H9)(S.firebaseDb,S.firebaseCollectionEnum.chats,n);let a={lastUpdated:(0,R.O5)(),dateCreated:(0,R.O5)(),participants:[r,e],isTyping:{[`${r}`]:!1,[`${e}`]:!1}};(0,R.BN)(s,a).then((()=>{t(n)})).catch((e=>{o(e)}))}else t(s)}catch(e){o(e)}}));return await t}},z=V;var W=t(9818);const K={name:"TrackOrder",components:{Maps:(0,o.$V)((()=>Promise.all([t.e(4121),t.e(459)]).then(t.bind(t,459)))),TrackOrderSkeleton:(0,o.$V)((()=>Promise.all([t.e(4121),t.e(5268)]).then(t.bind(t,5268)))),WriteReview:(0,o.$V)((()=>Promise.all([t.e(4121),t.e(996)]).then(t.bind(t,3185)))),ComponentsRealtime:(0,o.$V)((()=>Promise.all([t.e(4121),t.e(3592)]).then(t.bind(t,3592))))},data(){return{loading:!1,order_uuid:"",lat:"",lng:"",merchant_info:[],order_info:[],items:[],meta:[],items_count:0,order_progress:-1,order_status:"",order_status_details:"",instructions:[],maps_config:[],marker:[],modal_review:!1,loading_chat:!1,user_uuid:""}},mounted(){this.order_uuid=this.$route.query.order_uuid,this.getOrder();let e=W.A.getUser();this.user_uuid=e.client_uuid},methods:{getOrder(){this.loading=!0,O.A.getOrder(this.order_uuid).then((e=>{this.merchant_info=e.details.merchant_info,this.order_info=e.details.order_info,this.items=e.details.items,this.meta=e.details.meta,this.items_count=e.details.items_count,this.order_progress=e.details.progress.order_progress,this.order_status=e.details.progress.order_status,this.order_status_details=e.details.progress.order_status_details,this.instructions=e.details.instructions,this.maps_config=e.details.maps_config,"delivery"===this.order_info.order_type?this.marker=[{id:0,draggable:!1,icon:this.maps_config.icon_merchant,lat:this.merchant_info.latitude,lng:this.merchant_info.longitude},{id:1,draggable:!1,icon:this.maps_config.icon_destination,lat:this.meta.latitude,lng:this.meta.longitude}]:this.marker=[{id:0,draggable:!1,icon:this.maps_config.icon_merchant,lat:this.merchant_info.latitude,lng:this.merchant_info.longitude}]})).catch((e=>{O.A.notify("negative",e,"error_outline",this.$q)})).then((e=>{this.loading=!1}))},afterAddreview(){this.modal_review=!1},afterReceive(e){if(e.order_id!==this.order_info.order_id)return!1;0===e.order_progress?(this.order_progress=e.order_progress,this.order_status=e.order_status,this.order_status_details=e.order_status_details):-1===e.order_progress||(this.order_progress=e.order_progress,this.order_status=e.order_status,this.order_status_details=e.order_status_details)},async createChat(){this.loading_chat=!0,z.createChatOrder(this.order_info.order_id,this.order_uuid,this.merchant_info.merchant_uuid,this.user_uuid).then((e=>{this.$router.push({path:"/account/chat/conversation",query:{doc_id:e}})})).catch((e=>{O.A.notify("dark",e,"error",this.$q)})).then((e=>{this.loading_chat=!1}))}}};var U=t(2807),D=t(3316),P=t(5859),T=t(7222),I=t(8577),M=t(3952),B=t(2665),N=t(3954),H=t(6384),j=t(386),G=t(9035),J=t(2156),Y=t(4189),Z=t(3676),ee=t(8672),re=t(8582),te=t.n(re);const oe=(0,U.A)(K,[["render",X]]),ie=oe;te()(K,"components",{QCard:D.A,QLinearProgress:P.A,QStepper:T.A,QStep:I.A,QAvatar:M.A,QImg:B.A,QBadge:N.A,QBtn:H.A,QSeparator:j.A,QInnerLoading:G.A,QDialog:J.A,QCardSection:Y.A,QSpace:Z.A}),te()(K,"directives",{ClosePopup:ee.A})}}]);