"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[7111],{7111:(o,e,t)=>{t.r(e),t.d(e,{default:()=>D});var a=t(1758),l=t(8790);const r={class:"text-h5 text-weight-bold"},i={class:"row q-mt-sm q-col-gutter-md"},d={class:"col-8"},s={class:"col-4"};function n(o,e,t,n,c,m){const p=(0,a.g2)("q-space"),u=(0,a.g2)("q-btn"),_=(0,a.g2)("q-card-section"),h=(0,a.g2)("q-input"),g=(0,a.g2)("q-form"),y=(0,a.g2)("q-item-label"),b=(0,a.g2)("q-item-section"),f=(0,a.g2)("q-item"),k=(0,a.g2)("q-list"),v=(0,a.g2)("q-card"),A=(0,a.g2)("q-dialog"),P=(0,a.gN)("close-popup"),q=(0,a.gN)("ripple");return(0,a.uX)(),(0,a.Wv)(A,{modelValue:c.show_modal,"onUpdate:modelValue":e[1]||(e[1]=o=>c.show_modal=o),persistent:"",position:this.$q.screen.gt.sm?"standard":"bottom","full-width":!this.$q.screen.gt.sm},{default:(0,a.k6)((()=>[(0,a.bF)(v,{class:(0,l.C4)({"card-medium-width1":!this.$q.screen.lt.md})},{default:(0,a.k6)((()=>[(0,a.bF)(_,{class:"row items-center q-pb-none"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",r,(0,l.v_)(o.$t("Enter Promo Code")),1),(0,a.bF)(p),(0,a.bo)((0,a.bF)(u,{icon:"ion-close",flat:"",round:"",dense:""},null,512),[[P]])])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.bF)(g,{onSubmit:m.onApplyPromocode},{default:(0,a.k6)((()=>[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.bF)(h,{dense:"","bg-color":"mygrey",color:"warning",outlined:"",modelValue:c.promo_code,"onUpdate:modelValue":e[0]||(e[0]=o=>c.promo_code=o),rules:[e=>e&&e.length>0||o.$t("Please enter promo code")]},null,8,["modelValue","rules"])]),(0,a.Lk)("div",s,[(0,a.bF)(u,{type:"submit",unelevated:"",dense:"",rounded:"",color:"warning","text-color":"black","no-caps":"",class:"full-width",label:o.$t("Apply"),size:"17px",loading:c.loading_apply},null,8,["label","loading"])])])])),_:1},8,["onSubmit"])])),_:1}),(0,a.bF)(_,null,{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(c.data,(e=>((0,a.uX)(),(0,a.Wv)(k,{key:e.promo_id,class:"q-mb-sm",bordered:""},{default:(0,a.k6)((()=>[(0,a.bo)(((0,a.uX)(),(0,a.Wv)(f,{clickable:""},{default:(0,a.k6)((()=>[(0,a.bF)(b,null,{default:(0,a.k6)((()=>[(0,a.bF)(y,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(e.title),1)])),_:2},1024),(0,a.bF)(y,{caption:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(e.sub_title),1)])),_:2},1024),(0,a.bF)(y,{caption:""},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(e.valid_to),1)])),_:2},1024)])),_:2},1024),(0,a.bF)(b,{side:""},{default:(0,a.k6)((()=>[c.promo_selected.promo_id===e.promo_id?((0,a.uX)(),(0,a.Wv)(u,{key:0,flat:"",onClick:o=>m.removePromo(e),loading:c.loading,color:"negative","no-caps":""},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(o.$t("Remove")),1)])),_:2},1032,["onClick","loading"])):((0,a.uX)(),(0,a.Wv)(u,{key:1,flat:"",onClick:o=>m.usePromo(e),loading:c.loading,color:"warning","no-caps":""},{default:(0,a.k6)((()=>[(0,a.eW)((0,l.v_)(o.$t("Use now")),1)])),_:2},1032,["onClick","loading"]))])),_:2},1024)])),_:2},1024)),[[q]])])),_:2},1024)))),128))])),_:1})])),_:1},8,["class"])])),_:1},8,["modelValue","position","full-width"])}var c=t(2911),m=t(1464),p=t(4675);const u={name:"PromotionsModal",props:["cart_loaded","cart_updated"],data(){return{show_modal:!1,data:[],promo_selected:[],loading:!1,loading_apply:!1,promo_code:""}},setup(o){const e=(0,m.Q)(),t=(0,p.g)();return{DataStorePersisted:e,DeliveryschedStore:t}},watch:{cart_loaded(o,e){0==o&&this.loadPromo(!1)},cart_updated(o,e){0==o&&this.loadPromo(!0)}},methods:{loadPromo(o){this.$emit("beforeLoadpromo"),c.A.fetchDataPost("loadPromo","cart_uuid="+c.A.getStorage("cart_uuid")+"&currency_code="+this.DataStorePersisted.getUseCurrency()).then((o=>{this.data=o.details.data,this.promo_selected=o.details.promo_selected,this.$emit("aftergetPromo",{count:o.details.count,promo_selected:o.details.promo_selected})})).catch((o=>{this.$emit("clearPromo")})).then((o=>{this.$emit("afterLoadpromo")}))},usePromo(o){this.loading=!0;const e={cart_uuid:c.A.getStorage("cart_uuid"),promo_id:o.promo_id,promo_type:o.promo_type,currency_code:this.DataStorePersisted.getUseCurrency(),transaction_type:this.DeliveryschedStore.transaction_type};c.A.applyPromo(e).then((o=>{this.show_modal=!1,this.loadPromo(),this.$emit("afterApplypromo")})).catch((o=>{c.A.notify("negative",o,"error_outline",this.$q)})).then((o=>{this.loading=!1}))},removePromo(o){this.loading=!0;const e={cart_uuid:c.A.getStorage("cart_uuid"),promo_id:o.promo_id,promo_type:o.promo_type,transaction_type:this.DeliveryschedStore.transaction_type};c.A.removePromo(e).then((o=>{this.show_modal=!1,this.promo_selected=[],this.loadPromo(),this.$emit("afterRemovepromo")})).catch((o=>{c.A.notify("negative",o,"error_outline",this.$q)})).then((o=>{this.loading=!1}))},onApplyPromocode(){this.loading_apply=!0;const o={cart_uuid:c.A.getStorage("cart_uuid"),promo_code:this.promo_code,currency_code:this.DataStorePersisted.getUseCurrency(),transaction_type:this.DeliveryschedStore.transaction_type};c.A.applyPromoCode(o).then((o=>{this.show_modal=!1,this.promo_code="",this.loadPromo(),this.$emit("afterApplypromo")})).catch((o=>{c.A.notify("negative",o,"error_outline",this.$q)})).then((o=>{this.loading_apply=!1}))}}};var _=t(2807),h=t(2156),g=t(3316),y=t(4189),b=t(3676),f=t(6384),k=t(9200),v=t(9270),A=t(3999),P=t(124),q=t(5173),w=t(3796),$=t(8672),S=t(9626),C=t(8582),F=t.n(C);const Q=(0,_.A)(u,[["render",n]]),D=Q;F()(u,"components",{QDialog:h.A,QCard:g.A,QCardSection:y.A,QSpace:b.A,QBtn:f.A,QForm:k.A,QInput:v.A,QList:A.A,QItem:P.A,QItemSection:q.A,QItemLabel:w.A}),F()(u,"directives",{ClosePopup:$.A,Ripple:S.A})}}]);