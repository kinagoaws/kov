"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[9001],{9001:(e,a,l)=>{l.r(a),l.d(a,{default:()=>T});var t=l(1758),i=l(8790);const s={class:"row justify-center q-pa-md"},o={class:"col-md-9 col-12"},r={class:"row"},n={key:0,class:"col-md-4 col-sm-4 col-xs-12"},d={class:"col-md-8 col-sm-8 col-xs-12"},m={class:"absolute-bottom-right"},u={class:"text-weight-bold no-margin"};function c(e,a,l,c,h,_){const b=(0,t.g2)("StickyBack"),g=(0,t.g2)("LocationNav"),f=(0,t.g2)("AccountNav"),p=(0,t.g2)("q-img"),v=(0,t.g2)("q-avatar"),k=(0,t.g2)("q-btn"),A=(0,t.g2)("q-item-section"),q=(0,t.g2)("q-item-label"),y=(0,t.g2)("q-item"),$=(0,t.g2)("q-separator"),F=(0,t.g2)("q-space"),V=(0,t.g2)("q-uploader"),x=(0,t.g2)("q-input"),w=(0,t.g2)("q-form"),Q=(0,t.g2)("q-card"),P=(0,t.g2)("StepsVerification"),S=(0,t.g2)("q-page");return(0,t.uX)(),(0,t.Wv)(S,{padding:""},{default:(0,t.k6)((()=>[_.isMobile?((0,t.uX)(),(0,t.Wv)(b,{key:0,url:"/account/menu",label:"Back"})):((0,t.uX)(),(0,t.Wv)(g,{key:1})),(0,t.Lk)("div",s,[(0,t.Lk)("div",o,[(0,t.Lk)("div",r,[_.isMobile?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",n,[(0,t.bF)(f)])),(0,t.Lk)("div",d,[(0,t.bF)(Q,{flat:"",class:"fit"},{default:(0,t.k6)((()=>[(0,t.bF)(y,null,{default:(0,t.k6)((()=>[(0,t.bF)(A,{avatar:"",class:"relative-position"},{default:(0,t.k6)((()=>[(0,t.bF)(v,null,{default:(0,t.k6)((()=>[(0,t.bF)(p,{src:h.avatar,fit:"contain"},null,8,["src"])])),_:1}),(0,t.Lk)("div",m,[(0,t.bF)(k,{round:"",color:"primary",icon:"photo_camera",dense:"",size:"sm",unelevated:"",onClick:a[0]||(a[0]=e=>h.upload_enabled=!h.upload_enabled)})])])),_:1}),(0,t.bF)(A,{class:"q-pl-md"},{default:(0,t.k6)((()=>[(0,t.Lk)("h5",u,(0,i.v_)(e.$t("Profile")),1),(0,t.bF)(q,{caption:""},{default:(0,t.k6)((()=>[(0,t.eW)((0,i.v_)(h.first_name)+" "+(0,i.v_)(h.last_name),1)])),_:1})])),_:1})])),_:1}),(0,t.bF)($),(0,t.bF)(F,{class:"q-mt-lg"}),(0,t.bF)(w,{onSubmit:_.checkForm,class:"q-pa-md"},{default:(0,t.k6)((()=>[h.upload_enabled?((0,t.uX)(),(0,t.Wv)(V,{key:0,url:h.upload_api,label:e.$t("Upload files"),color:e.$q.dark.mode?"grey600":"warning","text-color":e.$q.dark.mode?"grey300":"white","no-thumbnails":"",class:"full-width q-mb-md",flat:"",accept:".jpg, image/*",bordered:"","max-files":1,"auto-upload":"","max-total-size":"1048576",onRejected:e.onRejectedFiles,headers:[{name:"Authorization",value:`token ${this.getToken()}`}],"field-name":"file",onUploaded:_.afterUploaded},null,8,["url","label","color","text-color","onRejected","headers","onUploaded"])):(0,t.Q3)("",!0),(0,t.bF)(x,{modelValue:h.first_name,"onUpdate:modelValue":a[1]||(a[1]=e=>h.first_name=e),"bg-color":"mygrey",color:"warning",outlined:"",label:e.$t("First name"),rules:[a=>a&&a.length>0||e.$t("This field is required")]},null,8,["modelValue","label","rules"]),(0,t.bF)(x,{modelValue:h.last_name,"onUpdate:modelValue":a[2]||(a[2]=e=>h.last_name=e),"bg-color":"mygrey",color:"warning",outlined:"",label:e.$t("Last name"),rules:[a=>a&&a.length>0||e.$t("This field is required")]},null,8,["modelValue","label","rules"]),(0,t.bF)(x,{modelValue:h.email_address,"onUpdate:modelValue":a[3]||(a[3]=e=>h.email_address=e),"bg-color":"mygrey",color:"warning",outlined:"",label:e.$t("Email"),rules:[a=>a&&a.length>0||e.$t("This field is required")]},null,8,["modelValue","label","rules"]),(0,t.bF)(x,{modelValue:h.mobile_number,"onUpdate:modelValue":a[4]||(a[4]=e=>h.mobile_number=e),prefix:h.prefix,mask:"##################","bg-color":"mygrey",color:"warning",outlined:"",label:e.$t("Mobile number"),rules:[a=>a&&a.length>0||e.$t("This field is required")]},null,8,["modelValue","prefix","label","rules"]),(0,t.bF)(k,{type:"submit",unelevated:"",rounded:"",color:"warning","text-color":"black","no-caps":"",class:"full-width",label:e.$t("Save"),size:"17px",dense:e.$q.screen.lt.sm,loading:h.loading},null,8,["label","dense","loading"])])),_:1},8,["onSubmit"])])),_:1})])])])]),(0,t.bF)(P,{ref:"steps_verification",sent_message:h.sent_message,onAfterVerifycode:_.afterVerifycode},null,8,["sent_message","onAfterVerifycode"])])),_:1})}var h=l(2911),_=l(9818),b=l(3414);const g={name:"Profile",components:{LocationNav:(0,t.$V)((()=>Promise.all([l.e(4121),l.e(996),l.e(7691)]).then(l.bind(l,5897)))),AccountNav:(0,t.$V)((()=>Promise.all([l.e(4121),l.e(996)]).then(l.bind(l,8275)))),StepsVerification:(0,t.$V)((()=>Promise.all([l.e(4121),l.e(996)]).then(l.bind(l,7180)))),StickyBack:(0,t.$V)((()=>Promise.all([l.e(4121),l.e(996)]).then(l.bind(l,7763))))},data(){return{loading:!1,first_name:"",last_name:"",email_address:"",mobile_number:"",prefix:"",avatar:"",original_email_address:"",original_mobile_number:"",sent_message:"",upload_enabled:!1,upload_api:b.A.api_base_url+"/partnerapi/updateAvatar",filename:"",upload_path:""}},mounted(){this.getCurrentProfile(),this.getProfile()},computed:{isMobile(){return!!this.$q.screen.lt.md}},methods:{getToken(){return _.A.getToken()},getCurrentProfile(){const e=_.A.getUser();e&&(this.original_email_address=e.email_address,this.original_mobile_number=e.contact_number)},getProfile(){this.loading=!0,h.A.getProfile().then((e=>{this.first_name=e.details.first_name,this.last_name=e.details.last_name,this.email_address=e.details.email_address,this.mobile_number=e.details.mobile_number,this.prefix=e.details.mobile_prefix,this.avatar=e.details.avatar})).catch((e=>{h.A.notify("negative",e,"error_outline",this.$q)})).then((e=>{this.loading=!1}))},checkForm(){let e=!1;this.email_address!==this.original_email_address&&(e=!0);const a=this.prefix+this.mobile_number;a!==this.original_mobile_number&&(e=!0),e?(this.loading=!0,h.A.RequestEmailCode().then((e=>{this.sent_message=e.msg,this.show_modal=!1,this.$refs.steps_verification.show_modal=!0})).catch((e=>{h.A.notify("negative",e,"error_outline",this.$q)})).then((e=>{this.loading=!1}))):this.onSubmit("")},onSubmit(e){this.loading=!0;const a={code:e,first_name:this.first_name,last_name:this.last_name,email_address:this.email_address,mobile_number:this.mobile_number,mobile_prefix:this.prefix,featured_filename:this.filename,upload_path:this.upload_path};h.A.saveProfile(a).then((e=>{this.$refs.steps_verification.show_modal=!1,_.A.setUser(e.details),h.A.notify("positive",e.msg,"check_circle",this.$q),this.getCurrentProfile()})).catch((e=>{h.A.notify("negative",e,"error_outline",this.$q)})).then((e=>{this.loading=!1}))},afterVerifycode(e){this.onSubmit(e)},afterUploaded(e){const a=JSON.parse(e.xhr.responseText);1===a.code?(this.avatar=a.details.url_image,this.filename=a.details.filename,this.upload_path=a.details.upload_path):(this.avatar="",this.filename="",this.upload_path="",h.A.notify("dark",a.msg,"error",this.$q))}}};var f=l(2807),p=l(7716),v=l(3316),k=l(124),A=l(5173),q=l(3952),y=l(2665),$=l(6384),F=l(3796),V=l(386),x=l(3676),w=l(9200),Q=l(2415),P=l(9270),S=l(8582),U=l.n(S);const L=(0,f.A)(g,[["render",c]]),T=L;U()(g,"components",{QPage:p.A,QCard:v.A,QItem:k.A,QItemSection:A.A,QAvatar:q.A,QImg:y.A,QBtn:$.A,QItemLabel:F.A,QSeparator:V.A,QSpace:x.A,QForm:w.A,QUploader:Q.A,QInput:P.A})}}]);