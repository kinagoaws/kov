"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[2657],{2657:(t,e,a)=>{a.r(e),a.d(e,{default:()=>V});var s=a(1758),l=a(8790);const n={class:"row justify-center q-pa-md"},i={class:"col-md-9 col-12"},o={class:"row"},r={key:0,class:"col-md-4 col-sm-4 col-xs-12"},c={class:"col-md-8 col-sm-8 col-xs-12"},d={class:"text-weight-bold"},g={key:1,class:"text-weight-bold text-warning"},u={class:"q-pa-md"},h={key:0,class:"default-height flex flex-center text-grey"},b={key:0,class:"q-pa-xl"},k={key:1,class:"row justify-center absolute-bottom"};function m(t,e,a,m,_,p){const f=(0,s.g2)("StickyBack"),v=(0,s.g2)("LocationNav"),y=(0,s.g2)("AccountNav"),F=(0,s.g2)("q-item-label"),q=(0,s.g2)("q-item-section"),A=(0,s.g2)("q-inner-loading"),$=(0,s.g2)("q-item"),Q=(0,s.g2)("q-separator"),w=(0,s.g2)("q-tab"),S=(0,s.g2)("q-tabs"),C=(0,s.g2)("q-img"),X=(0,s.g2)("q-avatar"),L=(0,s.g2)("q-badge"),x=(0,s.g2)("q-list"),P=(0,s.g2)("q-spinner-dots"),T=(0,s.g2)("q-infinite-scroll"),W=(0,s.g2)("q-card"),D=(0,s.g2)("q-page");return(0,s.uX)(),(0,s.Wv)(D,{padding:""},{default:(0,s.k6)((()=>[p.isMobile?((0,s.uX)(),(0,s.Wv)(f,{key:0,url:"/account/menu",label:"Back"})):((0,s.uX)(),(0,s.Wv)(v,{key:1})),(0,s.Lk)("div",n,[(0,s.Lk)("div",i,[(0,s.Lk)("div",o,[p.isMobile?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",r,[(0,s.bF)(y)])),(0,s.Lk)("div",c,[(0,s.bF)(W,{flat:"",class:"fit"},{default:(0,s.k6)((()=>[(0,s.bF)($,null,{default:(0,s.k6)((()=>[(0,s.bF)(q,null,{default:(0,s.k6)((()=>[(0,s.bF)(F,{class:"text-weight-bold"},{default:(0,s.k6)((()=>[(0,s.Lk)("h5",d,(0,l.v_)(t.$t("Total Bookings")),1)])),_:1}),(0,s.bF)(F,{caption:""},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(t.$t("Your bookings reservations")),1)])),_:1})])),_:1}),(0,s.bF)(q,{side:"",top:""},{default:(0,s.k6)((()=>[(0,s.bF)(F,null,{default:(0,s.k6)((()=>[_.loading_balance?((0,s.uX)(),(0,s.Wv)(A,{key:0,showing:!0,size:"md",color:"warning"})):((0,s.uX)(),(0,s.CE)("h4",g,(0,l.v_)(_.balance),1))])),_:1})])),_:1})])),_:1}),(0,s.bF)(Q),(0,s.Lk)("div",u,[(0,s.bF)(S,{modelValue:_.tab,"onUpdate:modelValue":[e[0]||(e[0]=t=>_.tab=t),p.tabChange],dense:"","active-color":"dark","indicator-color":"warning",align:"justify","narrow-indicator":"","no-caps":"",class:(0,l.C4)([{"text-grey300":t.$q.dark.mode,"text-dark":!t.$q.dark.mode},"bg-grey-2 rounded-borders"]),breakpoint:0},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.getTabList,((t,e)=>((0,s.uX)(),(0,s.Wv)(w,{key:t,name:e,label:t,"no-caps":"","content-class":"text-weight-500 "},null,8,["name","label"])))),128))])),_:1},8,["modelValue","class","onUpdate:modelValue"]),(0,s.bF)(T,{ref:"nscroll",onLoad:p.getTransaction,offset:350},{default:(0,s.k6)((()=>[p.hasData||_.loading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",h,(0,l.v_)(t.$t("No data available")),1)),(0,s.bF)(x,{class:"q-mt-md"},{default:(0,s.k6)((()=>[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(p.getData,(t=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t,(t=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t.reservation_id},[(0,s.bF)($,{clickable:"",to:{path:"/reservation/track",query:{id:t.reservation_uuid}}},{default:(0,s.k6)((()=>[_.merchant[t.merchant_id]?((0,s.uX)(),(0,s.Wv)(q,{key:0,avatar:""},{default:(0,s.k6)((()=>[(0,s.bF)(X,{size:"80px",square:""},{default:(0,s.k6)((()=>[(0,s.bF)(C,{fit:"contain",src:_.merchant[t.merchant_id].url_logo,loading:"lazy","spinner-color":"warning","spinner-size":"sm"},null,8,["src"])])),_:2},1024)])),_:2},1024)):(0,s.Q3)("",!0),(0,s.bF)(q,null,{default:(0,s.k6)((()=>[_.merchant[t.merchant_id]?((0,s.uX)(),(0,s.Wv)(F,{key:0},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(_.merchant[t.merchant_id].restaurant_name),1)])),_:2},1024)):(0,s.Q3)("",!0),(0,s.bF)(F,{caption:""},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(t.booking_id),1)])),_:2},1024),(0,s.bF)(F,{caption:"",class:"font11"},{default:(0,s.k6)((()=>[(0,s.eW)((0,l.v_)(t.reservation_date_raw),1)])),_:2},1024)])),_:2},1024),(0,s.bF)(q,{side:""},{default:(0,s.k6)((()=>[(0,s.bF)(L,{rounded:"",label:t.status,class:"q-pl-sm q-pr-sm",style:(0,l.Tr)({"background-color":`${t.status_color.background}`,color:`${t.status_color.color}`})},null,8,["label","style"])])),_:2},1024)])),_:2},1032,["to"]),(0,s.bF)(Q,{spaced:"",inset:""})],64)))),128))],64)))),128))])),_:1})])),loading:(0,s.k6)((()=>[_.page<=1?((0,s.uX)(),(0,s.CE)("div",b,[(0,s.bF)(A,{showing:!0,color:"warning",size:"md","label-class":"dark",class:"transparent"})])):_.page>2?((0,s.uX)(),(0,s.CE)("div",k,[(0,s.bF)(P,{color:"warning",size:"40px"})])):(0,s.Q3)("",!0)])),_:1},8,["onLoad"])])])),_:1})])])])])])),_:1})}var _=a(2911),p=a(1464),f=a(2302);const v={name:"BookingPage",components:{LocationNav:(0,s.$V)((()=>Promise.all([a.e(4121),a.e(996),a.e(7691)]).then(a.bind(a,5897)))),AccountNav:(0,s.$V)((()=>a.e(996).then(a.bind(a,8275)))),AddressesSkeleton:(0,s.$V)((()=>Promise.all([a.e(4121),a.e(996)]).then(a.bind(a,2171)))),StickyBack:(0,s.$V)((()=>Promise.all([a.e(4121),a.e(996)]).then(a.bind(a,7763))))},data(){return{data:[],merchant:[],loading:!1,tab:"all",page:0,is_refresh:void 0,balance:0,loading_balance:!0}},setup(t){const e=(0,p.Q)(),a=(0,f.C)();return{DataStorePersisted:e,SettingsStore:a}},async mounted(){Object.keys(this.SettingsStore.settings_data).length>0?this.SettingsStore.settings_data.booking_enabled?this.getAvailablePoints():this.$router.push("/home"):this.$watch((()=>this.SettingsStore.$state.settings_data),((t,e)=>{t.booking_enabled?this.getAvailablePoints():this.$router.push("/home")}))},computed:{hasData(){return this.data.length>0},getData(){return this.data},isMobile(){return!!this.$q.screen.lt.md},getTabList(){return Object.keys(this.DataStorePersisted.booking_status_list).length>0&&this.DataStorePersisted.booking_status_list}},methods:{getAvailablePoints(){this.loading_balance=!0,_.A.fetchDataPostTableToken("BookingSummary").then((t=>{1==t.code?this.balance=t.details.summary.total_reservation:this.balance=0})).catch((t=>{})).then((t=>{this.loading_balance=!1}))},getTransaction(t,e){this.loading=!0,this.page=t,_.A.fetchDataPostTableToken("BookingList","page="+t+"&status="+this.tab).then((t=>{1==t.code?(this.data.push(t.details.data),this.merchant=t.details.merchant,this.table_list=t.details.table_list):this.$refs.nscroll&&this.$refs.nscroll.stop()})).catch((t=>{this.$refs.nscroll&&this.$refs.nscroll.stop()})).then((t=>{this.loading=!1,e(),_.A.empty(this.is_refresh)||this.is_refresh()}))},tabChange(){this.resetPagination()},resetPagination(){this.page=0,this.data=[],this.merchant=[],this.table_list=[],this.$refs.nscroll.reset(),this.$refs.nscroll.resume(),this.$refs.nscroll.trigger()}}};var y=a(2807),F=a(7716),q=a(3316),A=a(124),$=a(5173),Q=a(3796),w=a(9035),S=a(386),C=a(2980),X=a(9761),L=a(8049),x=a(3999),P=a(3952),T=a(2665),W=a(3954),D=a(9198),E=a(8582),I=a.n(E);const B=(0,y.A)(v,[["render",m]]),V=B;I()(v,"components",{QPage:F.A,QCard:q.A,QItem:A.A,QItemSection:$.A,QItemLabel:Q.A,QInnerLoading:w.A,QSeparator:S.A,QTabs:C.A,QTab:X.A,QInfiniteScroll:L.A,QList:x.A,QAvatar:P.A,QImg:T.A,QBadge:W.A,QSpinnerDots:D.A})}}]);