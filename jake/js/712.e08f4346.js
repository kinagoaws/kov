"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[712],{712:(t,e,a)=>{a.r(e),a.d(e,{default:()=>B});var o=a(1758),s=a(8790),i=a(9104);const l={key:0,class:"row items-center"},n={class:"col"},d={key:0,class:"text-green text-caption"},c={key:1},r={key:0,class:"text-green text-caption"},u={key:2,class:"text-green text-caption font11"},p={class:"col-3 text-right"},h={class:"text-h5 text-weight-bold"},g={key:0,class:"text-center q-pa-sm"},_={class:"text-caption"},b={class:"text-subtitle2 q-mb-sm"},k={key:0,class:"absolute-full flex flex-center"},m={class:"text-white font12 text-weight-bold"},y={class:"q-mt-md"};function v(t,e,a,v,f,A){const C=(0,o.g2)("q-skeleton"),q=(0,o.g2)("q-btn"),x=(0,o.g2)("q-space"),w=(0,o.g2)("q-card-section"),X=(0,o.g2)("q-spinner"),P=(0,o.g2)("q-linear-progress"),E=(0,o.g2)("q-tab"),F=(0,o.g2)("q-tabs"),$=(0,o.g2)("q-input"),Q=(0,o.g2)("q-form"),D=(0,o.g2)("q-card"),S=(0,o.g2)("q-dialog"),V=(0,o.gN)("close-popup");return(0,o.uX)(),(0,o.CE)(o.FK,null,[f.loading?((0,o.uX)(),(0,o.Wv)(C,{key:0,type:"text",class:"w-50"})):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[A.getData?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",n,[a.use_thresholds?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[f.data.discount>0?((0,o.uX)(),(0,o.CE)("div",d,(0,s.v_)(f.data.discount_label),1)):((0,o.uX)(),(0,o.CE)("div",c,(0,s.v_)(t.$t("Add Points")),1))],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[f.data.discount>0?((0,o.uX)(),(0,o.CE)("div",r,(0,s.v_)(f.data.discount_label),1)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.eW)((0,s.v_)(f.data.redeem_discount),1)],64)),f.data.discount<=0?((0,o.uX)(),(0,o.CE)("div",u,(0,s.v_)(f.data.redeem_label),1)):(0,o.Q3)("",!0)],64))]),(0,o.Lk)("div",p,[f.data.discount>0?((0,o.uX)(),(0,o.Wv)(q,{key:0,onClick:(0,i.D$)(A.removePoints,["stop"]),flat:"",color:"warning","no-caps":""},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(t.$t("Remove")),1)])),_:1},8,["onClick"])):((0,o.uX)(),(0,o.Wv)(q,{key:1,onClick:(0,i.D$)(A.showDialog,["stop"]),flat:"",color:"warning","no-caps":""},{default:(0,o.k6)((()=>[(0,o.eW)((0,s.v_)(t.$t("Add")),1)])),_:1},8,["onClick"]))])])):(0,o.Q3)("",!0)],64)),(0,o.bF)(S,{modelValue:f.dialog,"onUpdate:modelValue":e[2]||(e[2]=t=>f.dialog=t),position:this.$q.screen.lt.md?"bottom":"standard",onBeforeShow:e[3]||(e[3]=t=>this.points=0)},{default:(0,o.k6)((()=>[(0,o.bF)(D,{class:(0,s.C4)({"card-medium-width":!this.$q.screen.lt.md})},{default:(0,o.k6)((()=>[(0,o.bF)(w,{class:"row items-center q-pb-none"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",h,(0,s.v_)(t.$t("Apply discount")),1),(0,o.bF)(x),(0,o.bo)((0,o.bF)(q,{icon:"close",flat:"",round:"",dense:""},null,512),[[V]])])),_:1}),(0,o.bF)(w,null,{default:(0,o.k6)((()=>[(0,o.bF)(Q,{onSubmit:A.applyPoints,class:"q-gutter-sm"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",null,[a.use_thresholds?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[f.loading_points?((0,o.uX)(),(0,o.CE)("div",g,[(0,o.bF)(X,{color:"primary",size:"2em"})])):((0,o.uX)(),(0,o.Wv)(F,{key:1,modelValue:f.points_tab,"onUpdate:modelValue":[e[0]||(e[0]=t=>f.points_tab=t),A.setPoints],class:"text-dark q-mb-lg","no-caps":"","active-color":"white","active-bg-color":"blue","indicator-color":"blue"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f.data_points,(e=>((0,o.uX)(),(0,o.Wv)(E,{key:e,name:e,disable:!(f.balance>e.points)},{default:(0,o.k6)((()=>[(0,o.Lk)("div",_,(0,s.v_)(e.label),1),(0,o.Lk)("div",b,(0,s.v_)(e.amount),1),(0,o.bF)(P,{size:"18px",value:f.balance/e.points,style:{"min-width":"70px"},class:"radius28",color:f.balance>=e.points?"yellow-9":"blue"},{default:(0,o.k6)((()=>[f.balance>=e.points?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("span",m,(0,s.v_)(t.$t("REDEEM")),1)])):(0,o.Q3)("",!0)])),_:2},1032,["value","color"])])),_:2},1032,["name","disable"])))),128))])),_:1},8,["modelValue","onUpdate:modelValue"]))],64)):((0,o.uX)(),(0,o.Wv)($,{key:1,modelValue:f.points,"onUpdate:modelValue":e[1]||(e[1]=t=>f.points=t),label:t.$t("Enter points to convert to discount"),outlined:"","lazy-rules":"","bg-color":t.$q.dark.mode?"grey600":"input","label-color":t.$q.dark.mode?"grey300":"grey",borderless:"",class:"input-borderless"},null,8,["modelValue","label","bg-color","label-color"]))]),(0,o.Lk)("div",y,[(0,o.bF)(q,{loading:f.loading_apply,disable:!(f.points>0),type:"submit",unelevated:"",color:"warning","text-color":"dark","no-caps":"",class:"full-width",label:t.$t("Apply"),size:"17px",rounded:""},null,8,["loading","disable","label"])])])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["class"])])),_:1},8,["modelValue","position"])],64)}var f=a(2911);const A={props:["currency_code","use_thresholds","cart_loaded","cart_updated"],name:"PointsCart",data(){return{loading:!0,loading_apply:!1,loading_remove:!1,data:[],dialog:!1,points:0,loading_points:!1,points_tab:0,data_points:[],balance:0,points_id:0}},watch:{cart_loaded(t,e){0==t&&this.getCartpoints()},cart_updated(t,e){0==t&&this.getCartpoints()}},computed:{getData(){return Object.keys(this.data).length>0&&this.data}},methods:{showDialog(){this.use_thresholds&&this.getPointsthresholds(),this.dialog=!this.dialog},getCartpoints(t){t||(this.loading=!0),f.A.fetchDataByTokenPost("getCartpoints","cart_uuid="+f.A.getStorage("cart_uuid")+"&currency_code="+this.currency_code).then((t=>{this.data=t.details})).catch((t=>{this.data=[]})).then((t=>{this.loading=!1}))},applyPoints(){this.loading_apply=!0,f.A.fetchDataByTokenPost("applyPoints","cart_uuid="+f.A.getStorage("cart_uuid")+"&currency_code="+this.currency_code+"&points="+this.points+"&points_id="+this.points_id).then((t=>{this.dialog=!1,this.$emit("afterApplypoints"),this.getCartpoints()})).catch((t=>{f.A.notify("negative",t,"error_outline",this.$q)})).then((t=>{this.loading_apply=!1}))},removePoints(){this.loading_remove=!0,f.A.fetchDataByTokenPost("removePoints","cart_uuid="+f.A.getStorage("cart_uuid")).then((t=>{this.$emit("afterApplypoints"),this.getCartpoints()})).catch((t=>{f.A.notify("negative",t,"error_outline",this.$q)})).then((t=>{this.loading_remove=!1}))},getPointsthresholds(){this.loading_points=!0,f.A.fetchDataByTokenPost("getPointsthresholds","cart_uuid="+f.A.getStorage("cart_uuid")+"&currency_code="+this.currency_code).then((t=>{this.data_points=t.details.data,this.balance=t.details.balance})).catch((t=>{f.A.notify("negative",t,"error_outline",this.$q)})).then((t=>{this.loading_points=!1}))},setPoints(){this.points=this.points_tab.points,this.points_id=this.points_tab.id}}};var C=a(2807),q=a(3820),x=a(6384),w=a(2156),X=a(3316),P=a(4189),E=a(3676),F=a(9200),$=a(8210),Q=a(2980),D=a(9761),S=a(5859),V=a(9270),L=a(8672),W=a(8582),T=a.n(W);const K=(0,C.A)(A,[["render",v]]),B=K;T()(A,"components",{QSkeleton:q.Ay,QBtn:x.A,QDialog:w.A,QCard:X.A,QCardSection:P.A,QSpace:E.A,QForm:F.A,QSpinner:$.A,QTabs:Q.A,QTab:D.A,QLinearProgress:S.A,QInput:V.A}),T()(A,"directives",{ClosePopup:L.A})}}]);