"use strict";(globalThis["webpackChunkcom_kinago_single"]=globalThis["webpackChunkcom_kinago_single"]||[]).push([[540],{540:(t,e,a)=>{a.r(e),a.d(e,{default:()=>U});var s=a(1758),l=a(8790);const i={class:"row full-width"},o={class:"col"},d={class:"text-h6 line-normal"},n={class:"text-caption"},r={class:"col-4 text-right"},c={class:"text-weight-bold no-margin q-pl-md q-pb-sm"},h={class:"text-weight-bold no-margin q-pl-md q-pb-sm"},m={class:"text-weight-bold no-margin q-pl-md q-pb-sm"},_={class:"scroll bg-grey-2"},u={class:"text-h5 text-weight-bold"};function g(t,e,a,g,p,b){const f=(0,s.g2)("Maps"),v=(0,s.g2)("q-inner-loading"),w=(0,s.g2)("q-btn"),k=(0,s.g2)("q-space"),y=(0,s.g2)("q-input"),q=(0,s.g2)("q-select"),S=(0,s.g2)("q-btn-toggle"),A=(0,s.g2)("q-card-section"),V=(0,s.g2)("q-card-actions"),F=(0,s.g2)("q-card"),$=(0,s.g2)("NewAddress"),C=(0,s.g2)("q-dialog"),L=(0,s.gN)("close-popup");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(F,{flat:""},{default:(0,s.k6)((()=>[(0,s.Lk)("div",{class:(0,l.C4)(["bg-grey-1 relative-position",p.class_map]),style:{overflow:"hidden"}},[(0,s.bF)(f,{ref:"maps",lat:a.maps_config.default_lat,lng:a.maps_config.default_lng,keys:a.maps_config.key,zoom:15,class_map:p.class_map,provider:a.maps_config.provider,detect_location:!1,marker:p.marker,onAfterSelectmap:b.afterSelectmap,onDragMarker:t.dragMarker,onShowLoader:t.showLoader},null,8,["lat","lng","keys","class_map","provider","marker","onAfterSelectmap","onDragMarker","onShowLoader"]),(0,s.bF)(v,{showing:t.loading_map,label:t.$t("Please wait..."),"label-class":"text-dark","label-style":"font-size: 11px"},null,8,["showing","label"])],2),(0,s.bF)(A,{class:"q-pa-none q-pt-md"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",i,[(0,s.Lk)("div",o,[(0,s.Lk)("div",d,(0,l.v_)(p.formatted_address),1),(0,s.Lk)("div",n,(0,l.v_)(p.address1),1)]),(0,s.Lk)("div",r,[(0,s.bF)(w,{color:"warning",flat:"",unelevated:"",label:t.$t("Edit"),"no-caps":"",onClick:e[0]||(e[0]=t=>p.dialog=!p.dialog)},null,8,["label"])])]),(0,s.bF)(k,{class:"q-pa-sm"}),(0,s.bF)(y,{modelValue:p.address1,"onUpdate:modelValue":e[1]||(e[1]=t=>p.address1=t),autogrow:"",outlined:"",class:"q-mb-md full-width",color:"warning",label:t.$t("Street name"),dense:""},null,8,["modelValue","label"]),(0,s.bF)(y,{modelValue:p.formatted_address,"onUpdate:modelValue":e[2]||(e[2]=t=>p.formatted_address=t),autogrow:"",outlined:"",class:"q-mb-md full-width",color:"warning",label:t.$t("Street number"),dense:""},null,8,["modelValue","label"]),(0,s.bF)(y,{modelValue:p.location_name,"onUpdate:modelValue":e[3]||(e[3]=t=>p.location_name=t),autogrow:"",outlined:"",class:"q-mb-md full-width",color:"warning",label:t.$t("Aparment, suite or floor"),dense:""},null,8,["modelValue","label"]),(0,s.Lk)("h6",c,(0,l.v_)(t.$t("Delivery options")),1),(0,s.bF)(q,{outlined:"",dense:"",modelValue:p.delivery_options,"onUpdate:modelValue":e[4]||(e[4]=t=>p.delivery_options=t),options:p.delivery_options_data,color:"warning",class:"q-mb-md","transition-show":"scale","transition-hide":"scale","emit-value":""},null,8,["modelValue","options"]),(0,s.Lk)("h6",h,(0,l.v_)(t.$t("Add delivery instructions")),1),(0,s.bF)(y,{modelValue:p.delivery_instructions,"onUpdate:modelValue":e[5]||(e[5]=t=>p.delivery_instructions=t),autogrow:"",outlined:"",class:"q-mb-md full-width",color:"warning",label:t.$t("eg. ring the bell after dropoff, leave next to the porch, call upon arrival, etc")},null,8,["modelValue","label"]),(0,s.Lk)("h6",m,(0,l.v_)(t.$t("Address label")),1),(0,s.Lk)("div",_,[(0,s.bF)(S,{class:"q-mb-md q-ml-sm rounded-group no-margin",modelValue:p.address_label,"onUpdate:modelValue":e[6]||(e[6]=t=>p.address_label=t),"toggle-color":"warning","no-caps":"",unelevated:"",options:p.address_label_data,"emit-value":"",size:"md"},null,8,["modelValue","options"])])])),_:1}),(0,s.bF)(V,{class:"q-pl-none q-pr-none q-mt-sm"},{default:(0,s.k6)((()=>[(0,s.bF)(w,{unelevated:"",color:"warning","text-color":"black","no-caps":"",class:"full-width q-mb-md",label:t.$t("Save"),size:"17px",onClick:b.submit,loading:p.loading},null,8,["label","onClick","loading"])])),_:1})])),_:1}),(0,s.bF)(C,{modelValue:p.dialog,"onUpdate:modelValue":e[7]||(e[7]=t=>p.dialog=t),persistent:"","transition-show":"scale","transition-hide":"scale",position:this.$q.screen.gt.sm?"standard":"bottom"},{default:(0,s.k6)((()=>[(0,s.bF)(F,{class:(0,l.C4)({"card-medium-width1":!this.$q.screen.lt.md})},{default:(0,s.k6)((()=>[(0,s.bF)(A,{class:"row items-center q-pb-none"},{default:(0,s.k6)((()=>[(0,s.Lk)("div",u,(0,l.v_)(t.$t("What's your exact location?")),1),(0,s.bF)(k),(0,s.bo)((0,s.bF)(w,{icon:"close",flat:"",round:"",dense:""},null,512),[[L]])])),_:1}),(0,s.bF)(k,{class:"q-pa-sm"}),(0,s.bF)($,{ref:"new_address",show_cancel:!1,label_id:2,onAfterConfirmlocation:b.afterConfirmlocation,onAfterSelectaddress:t.afterSelectaddress},null,8,["onAfterConfirmlocation","onAfterSelectaddress"])])),_:1},8,["class"])])),_:1},8,["modelValue","position"])],64)}var p=a(2911),b=a(1464),f=a(2302);const v={name:"AddressInline",props:["locationdata","maps_config"],components:{Maps:(0,s.$V)((()=>Promise.all([a.e(4121),a.e(459)]).then(a.bind(a,459)))),NewAddress:(0,s.$V)((()=>a.e(996).then(a.bind(a,1566))))},data(){return{loading:!1,dialog:!1,location_data:this.locationdata,formatted_address:"",address1:"",location_name:"",delivery_options:"Leave it at my door",delivery_instructions:"",address_label:"Home",attributes:[],formatted_address:"",class_map:"maps small",marker:[],validat_coord:!1,new_lat:"",new_lng:"",latitude:"",longitude:"",place_id:"",delivery_options_data:[],address_label_data:[]}},setup(){const t=(0,b.Q)(),e=(0,f.C)();return{DataStorePersisted:t,SettingsStore:e}},mounted(){this.beforeShow(),Object.keys(this.locationdata).length>0&&(this.formatted_address=this.locationdata.address.formatted_address,this.address1=this.locationdata.address.address1,this.latitude=this.locationdata.latitude,this.longitude=this.locationdata.longitude,this.place_id=this.locationdata.place_id),Object.keys(this.SettingsStore.settings_data).length>0?(console.log("here"),this.getSettings()):this.$watch((()=>this.SettingsStore.$state.settings_data),((t,e)=>{console.log("newData",t),this.getSettings()}))},watch:{locationdata(t,e){this.location_data=this.locationdata},location_data(t,e){this.formatted_address=t.address.formatted_address,this.address1=t.address.address1,this.latitude=t.latitude,this.longitude=t.longitude,this.place_id=t.place_id,p.A.empty(t.attributes)||(this.location_name=t.attributes.location_name,this.delivery_options=t.attributes.delivery_options,this.delivery_instructions=t.attributes.delivery_instructions,this.address_label=t.attributes.address_label)},adjust_pin(t,e){t?(this.class_map="maps",this.marker=[{id:1,draggable:!0,icon:this.maps_config.icon,lat:this.location_data.latitude,lng:this.location_data.longitude}]):(this.$refs.maps.mapBoxResize(),this.class_map="maps small",this.marker=[{id:1,draggable:!1,icon:this.maps_config.icon,lat:this.location_data.latitude,lng:this.location_data.longitude}])}},methods:{async getSettings(){const t=await this.SettingsStore.getAsyncSettings();Object.keys(t).length>0&&(this.delivery_options_data=t.addresss_delivery_option,this.address_label_data=t.address_label)},beforeShow(){this.marker=[{id:1,draggable:!1,icon:this.maps_config.icon,lat:this.locationdata.latitude,lng:this.locationdata.longitude}]},clearData(){this.location_name="",this.delivery_options="",this.delivery_instructions=""},afterConfirmlocation(t){this.location_data=t,this.dialog=!1},submit(){this.loading=!0;let t="formatted_address="+this.formatted_address;t+="&address1="+this.address1,t+="&location_name="+this.location_name,t+="&delivery_options="+this.delivery_options,t+="&delivery_instructions="+this.delivery_instructions,t+="&address_label="+this.address_label,t+="&latitude="+this.latitude,t+="&longitude="+this.longitude,t+="&place_id="+this.place_id,p.A.fetchDataByTokenPost("saveClientAddress",t).then((t=>{this.DataStorePersisted.local_id=t.details.place_id,this.DataStorePersisted.location_data={address:{address1:this.address1,formatted_address:this.formatted_address},latitude:this.latitude,longitude:this.longitude,place_id:this.place_id,attributes:{location_name:this.location_name,delivery_options:this.delivery_options,delivery_instructions:this.delivery_instructions,address_label:this.address_label}},this.$emit("afterSaveaddress")})).catch((t=>{p.A.notify("negative",t,"error_outline",this.$q)})).then((t=>{this.loading=!1}))},afterSelectmap(t,e){this.new_lat=t,this.new_lng=e,this.validat_coord=!0},validateCoordinates(){const t={lat:this.latitude,lng:this.longitude,new_lat:this.new_lat,new_lng:this.new_lng};p.A.validateCoordinates(t).then((t=>{this.adjust_pin=!1,this.latitude=this.new_lat,this.longitude=this.longitude})).catch((t=>{p.A.notify("negative",t,"error_outline",this.$q)})).then((t=>{}))}}};var w=a(2807),k=a(3316),y=a(9035),q=a(4189),S=a(6384),A=a(3676),V=a(9270),F=a(2606),$=a(8975),C=a(2669),L=a(2156),x=a(8672),Q=a(8582),D=a.n(Q);const P=(0,w.A)(v,[["render",g]]),U=P;D()(v,"components",{QCard:k.A,QInnerLoading:y.A,QCardSection:q.A,QBtn:S.A,QSpace:A.A,QInput:V.A,QSelect:F.A,QBtnToggle:$.A,QCardActions:C.A,QDialog:L.A}),D()(v,"directives",{ClosePopup:x.A})}}]);